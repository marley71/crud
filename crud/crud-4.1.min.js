function Log(e,t){this.mobile=t,this.enable=function(){this.mobile?(Log.prototype.info=window.console.log.bind(window.console),Log.prototype.debug=window.console.log.bind(window.console),Log.prototype.warn=window.console.log.bind(window.console),Log.prototype.error=window.console.error.bind(window.console)):(Log.prototype.info=window.console.info.bind(window.console),Log.prototype.debug=window.console.debug.bind(window.console),Log.prototype.warn=window.console.warn.bind(window.console),Log.prototype.error=window.console.error.bind(window.console))},this.disable=function(){Log.prototype.info=function(){},Log.prototype.debug=function(){},Log.prototype.warn=function(){},Log.prototype.error=function(){}},e?this.enable():this.disable()}function GMapMarker(){this.id=null,this.address="",this.txt="",this.lat=null,this.lng=null,this.title="",this.icon=null,this.labelClass=null,this.labelAnchor=null,this.labelContent=null,this.googlem=null,this.draggable=!1,this.click_callback=null,this.mouseover_callback=null,this.mouseout_callback=null,this.data=null,this.infoWindow=null,this.route_address=""}function GMap(objName,mapOptions){var self=this;this.markerLabel=!1,this.markerLabelScript="",this.gmap=null,this.geocoder=null,this.centerAddress=null,this.lat=42,this.lng=13,this.zoom=6,this.elementId="map_canvas",this.objName=objName,this.markers=[],this.areas=[],this.current=0,this.delay=1e3,this.infowindowprec=null,this.mapTypeId="ROADMAP",this.directionsService=null,this.directionsDisplay=null,this.directionsPanelId=null,this.language="it",this.queuedMarker=[],this.mapOptions=mapOptions?mapOptions:{},this.apiKey=null,this.version=null,this.showQueued=function(e,t){e=e?e:function(){},t=t?t:function(){};var a=this,r=function u(){if(a.app.log.info("_showQueued "+a.queuedMarker.length),a.queuedMarker.length>0){var t=a.queuedMarker.pop();a.geocoder.geocode({address:t.address},function(e,r){if(e){var n=!1;if(jQuery.each(e,function(e,i){if(r==google.maps.GeocoderStatus.OK){var o=new google.maps.LatLng(i.geometry.location.lat(),i.geometry.location.lng());t.lat=i.geometry.location.lat(),t.lng=i.geometry.location.lng(),a.showAddressByPoint(o,t),n=!0}}),!n){var i=new google.maps.LatLng(t.lat,t.lng);a.showAddressByPoint(i,t)}}else{var i=new google.maps.LatLng(t.lat,t.lng);a.showAddressByPoint(i,t)}setTimeout(function(){u()},a.delay)})}else e()};this.app.log.info("GMap.showQueued ",a.markers);for(var n in a.markers){var i=a.markers[n];if(null==i.googlem)if(i.lat&&i.lng){var o=new google.maps.LatLng(i.lat,i.lng);a.showAddressByPoint(o,i)}else if(""!=i.address)a.queuedMarker.push(i);else{var o=new google.maps.LatLng(a.lat,a.lng);a.showAddressByPoint(o,i)}}return 0==a.queuedMarker.length?e():void r()},this.updateMarkerAddress=function(e,t,a){a=a?a:function(){},self.geocoder.geocode({address:t},function(t,r){if(r==google.maps.GeocoderStatus.ZERO_RESULTS)return a({msg:"Zero risulati",error:1});if(t){var n=0;jQuery.each(t,function(t,a){if(r==google.maps.GeocoderStatus.OK&&!n){n=1;var i=new google.maps.LatLng(a.geometry.location.lat(),a.geometry.location.lng());self.markers[e].lat=a.geometry.location.lat(),self.markers[e].lng=a.geometry.location.lng(),self.markers[e].googlem.setPosition(i),self.updateArea(e)}}),a(n?{msg:"",error:0,pos:self.markers[e].googlem.getPosition()}:{msg:"Error not found ",error:1,pos:{}})}else a({msg:"errore generale",error:1,pos:{},status:r,result:result})})},this._initialize=function(){try{var e=new google.maps.LatLng(self.lat,self.lng),t={zoom:self.zoom,center:e,mapTypeId:google.maps.MapTypeId.ROADMAP};for(var a in self.mapOptions)t[a]=self.mapOptions[a];self.gmap=new google.maps.Map(document.getElementById(self.elementId),t),setTimeout(function(){self.geocoder=new google.maps.Geocoder,self.centerAddress&&self.geocoder.geocode({address:self.centerAddress},function(e,t){e&&jQuery.each(e,function(e,a){if(t==google.maps.GeocoderStatus.OK){var r=new google.maps.LatLng(a.geometry.location.lat(),a.geometry.location.lng());self.gmap.setCenter(r)}})});var e={map:self.gmap,suppressMarkers:!0,preserveViewport:!0};self.directionsDisplay=new google.maps.DirectionsRenderer(e),self.directionsPanelId&&self.directionsDisplay.setPanel(document.getElementById(self.directionsPanelId)),google.maps.event.addListener(self.gmap,"zoom_changed",function(){self.zoom_changed()}),google.maps.event.addListener(self.gmap,"bounds_changed",function(e){self.bounds_changed(e)}),self.afterInitialize()},500)}catch(r){this.app.log.error(r)}},this.initialize=function(){self.markerLabel?self.loadMarkerWithLabelScript(function(){self._initialize()}):self._initialize()},this.geocodingResults=function(address,callback){self.geocoder.geocode({address:address},function(results,status){eval(callback+"(results)")})},this.getGeocodingResults=function(e,t){self.geocoder.geocode({address:e},function(e,a){t(e,a)})},this.showAddress=function(e,t){self.geocoder.geocode({address:e},function(e,a){jQuery.each(e,function(e,r){if(a==google.maps.GeocoderStatus.OK){var n=new google.maps.LatLng(r.geometry.location.lat(),r.geometry.location.lng());self.showAddressByPoint(n,t)}})})},this.showAddressByPoint=function(e,t){var a=self.getIndexById(t.id);if(a<0)return void alert("errore");var r={map:self.gmap,draggable:t.draggable,animation:google.maps.Animation.DROP,position:e,icon:t.icon,title:t.title,optimized:!1};if(t.icon&&(r.icon=t.icon),null===t.googlem){var n=null;self.markerLabel?(r.icon=" ",r.labelClass=t.labelClass?t.labelClass:"",r.labelAnchor=t.labelAnchor?t.labelAnchor:new google.maps.Point(25,25),r.labelContent=t.labelContent,n=new MarkerWithLabel(r)):n=new google.maps.Marker(r),self.markers[a].googlem=n}else self.markers[a].googlem.setPosition(e),self.markers[a].googlem.setMap(self.gmap);if(self.markers[a].lat=e.lat(),self.markers[a].lng=e.lng(),t.draggable){var i=self.markers[a];google.maps.event.addListener(i.googlem,"dragend",function(){var e=i.googlem.getPosition();i.lat=e.lat(),i.lng=e.lng(),self.updateArea(a),self.markerDragend(e,i)})}if(t.click_callback)google.maps.event.addListener(self.markers[a].googlem,"click",function(){t.click_callback()});else if(""!=t.txt){var o=new google.maps.InfoWindow({content:t.txt,maxWidth:250});t.infoWindow=o,google.maps.event.addListener(self.markers[a].googlem,"click",function(){self.infowindowprec&&self.infowindowprec.close(),o.open(self.gmap,self.markers[a].googlem),self.infowindowprec=o})}t.mouseover_callback&&google.maps.event.addListener(self.markers[a].googlem,"mouseover",function(){t.mouseover_callback()}),t.mouseout_callback&&google.maps.event.addListener(self.markers[a].googlem,"mouseout",function(){t.mouseout_callback()}),self.markerPositionUpdated(t)},this.loadScript=function(){var e=this,t=document.createElement("script");t.type="text/javascript";var a="http://maps.googleapis.com/maps/api/js?key="+e.apiKey;e.version&&(a+="&v="+e.version),a+="&callback="+e.objName+".initialize&language="+e.language,t.src=a,t.onload=e.afterLoadScript(),t.onerror=function(e){},document.body.appendChild(t)},this.addMarker=function(e){return e.id||(e.id=self.markers.length),self.markers.push(e),self.markers.length},this.afterInitialize=function(){},this.afterLoadScript=function(){},this.deleteMarker=function(e){return self.markers[e]?(null!==self.markers[e].googlem&&(google.maps.event.clearListeners(self.markers[e].googlem,"click"),self.markers[e].googlem.setMap(null)),self.markers.splice(e,1),!0):(this.app.log.warn("indice non trovato "+e),!1)},this.hideMarker=function(e){self.markers[e]&&null!==self.markers[e].googlem&&self.markers[e].googlem.setMap(null)},this.showMarker=function(e){if(self.markers[e]&&null!==self.markers[e].googlem){var t=self.markers[e].googlem;t.setMap(self.gmap),t.setTitle(self.markers[e].title),t.setPosition(new google.maps.LatLng(self.markers[e].lat,self.markers[e].lng)),self.markers[e].infoWindow&&self.markers[e].infoWindow.setContent(self.markers[e].txt)}},this.deleteAllMarkers=function(){for(var e=this,t=0;t<e.markers.length;t++)google.maps.event.clearListeners(e.markers[t].googlem,"click"),e.markers[t].googlem.setMap(null);e.current=0,e.markers=[]},this.updateMarker=function(e,t){if(self.markers[e]&&null!==self.markers[e].googlem)if(t.address)self.current=e,self.showAddress(t.address,self.markers[e]);else{var a=self.markers[e].googlem,r=new google.maps.LatLng(t.lat,t.lng);a.setPosition(r)}},this.hidePath=function(){self.directionsDisplay.setMap(null)},this._showPath=function(e,t,a,r,n){try{r||(r=google.maps.TravelMode.DRIVING),self.directionsService||(self.directionsService=new google.maps.DirectionsService),self.directionsPanelId&&self.directionsDisplay.setPanel(document.getElementById(self.directionsPanelId)),self.hidePath();var i=self.markers[e].googlem.position,o=self.markers[t].googlem.position,u=[];for(var l in a)u.push({location:a[l],stopover:!0});var d={origin:i,destination:o,travelMode:r,waypoints:u};self.directionsService.route(d,function(e,t){switch(self.app.log("DIRECTIONSERVICE",e,t),t){case google.maps.DirectionsStatus.OK:self.directionsDisplay.setMap(self.gmap),self.directionsDisplay.setDirections(e);var a=e.routes[0].legs.length;for(var r in e.routes[0].legs)self.markers[r].route_address=e.routes[0].legs[r].start_address;self.markers[a].route_address=e.routes[0].legs[a-1].end_address;break;default:jQuery(self.directionsDisplay.getPanel()).html(jQuery.translate("percorso_non_trovato"));for(var r in self.markers)self.markers[r].route_address=null}n({msg:"",error:0,response:e})})}catch(s){this.app.log.error(s.message),n({msg:s.message,error:1,response:[]})}},this.showPath=function(e,t,a,r){self._showPath(e,t,[],a,function(e){r&&r(e)})},this.showPaths=function(e,t,a,r,n){self._showPath(e,t,a,r,function(e){n&&n(e)})},this.showArea=function(e){var t=this;t.hideArea();for(var a=0;a<t.markers.length;a++){var r=new google.maps.Circle({strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35,map:t.gmap,center:{lat:t.markers[a].lat,lng:t.markers[a].lng},radius:e.raggio});t.areas.push(r)}},this.hideArea=function(){for(var e=this,t=0;t<e.areas.length;t++)e.areas[t].setMap(null);e.areas=[]},this.updateArea=function(e){var t=this;e<t.areas.length&&t.areas[e].setCenter({lat:t.markers[e].lat,lng:t.markers[e].lng})},this.getMarker=function(e){return e<self.markers.length?self.markers[e]:null},this.getIndexById=function(e){for(var t=0;t<self.markers.length;t++)if(self.markers[t].id==e)return t;return-1},this.getMarkerById=function(e){var t=self.getIndexById(e);return self.getMarker(t)},this.markerToCenter=function(e){if(e>=self.markers.length)return void log.warn("index:"+e+" out of range, size:"+self.markers.length);if(self.markers[e].googlem)var t=self.markers[e].googlem.position;else var t=new google.maps.LatLng(self.markers[e].lat,self.markers[e].lng);self.gmap.setCenter(t)},this.setCenter=function(e,t){var a=new google.maps.LatLng(e,t);self.gmap.setCenter(a)},this.setCenterToMarkers=function(e){for(var t=new google.maps.LatLngBounds,a=!1,r=0;r<self.markers.length;r++)null!==self.markers[r].googlem?self.markers[r].googlem.getMap()&&(t.extend(self.markers[r].googlem.getPosition()),a=!0):log.warn("google pointer null with index:"+r);a&&(zoomChangeBoundsListener=google.maps.event.addListener(self.gmap,"bounds_changed",function(t){e&&self.gmap.getZoom()>e&&self.gmap.setZoom(e),google.maps.event.removeListener(zoomChangeBoundsListener)}),self.gmap.fitBounds(t))},this.loadMarkerWithLabelScript=function(e){var t=document.createElement("script");t.src=self.markerLabelScript,t.async=!0,t.onreadystatechange=t.onload=function(){t.readyState;e()},document.getElementsByTagName("head")[0].appendChild(t)},this.zoom_changed=function(){},this.showMarkersEnd=function(){},this.markerDragend=function(e,t){},this.markerPositionUpdated=function(e){},this.bounds_changed=function(e){}}function Conf(){}function App(){var e="it",t={},a={},r=0,n={},i={},o=0,u={},l={},d=null,s=!1;App.resources=[],App.pluginsPath="/crud/plugins/",App.log=null,App.show_log=!1,App.mobile=!1,App.getResources=function(){return t},App.init=function(t,a){var r=this,n=t?t:{};for(var i in n)r[i]=n[i];d=new Log(this.showLog,this.mobile),this.showLog&&d.enable(),this.locale&&(e=this.locale),s=n.autoparse,this.log=d,Component.prototype.app=this,Route.prototype.app=this,Render.prototype.app=this,View.prototype.app=this,Dashboard.prototype.app=this,Action.prototype.app=this,Template.prototype.app=this,Modal.prototype.app=this,Conf.prototype.app=this,jQuery.app=this,Utility.app=this,s&&(jQuery("body").bind("DOMNodeInserted",function(e){e.target.hasAttribute&&e.target.hasAttribute("crud-parse")&&(e.target.removeAttribute("crud-parse"),r.parse(jQuery(e.target)))}),window.onload=function(){jQuery("body").find("[crud-parse]").each(function(){jQuery(this).removeAttr("crud-parse"),r.parse(jQuery(this))})}),EventManager.on("loadResource",function(e){e.preventDefault(),r.loadResource(e.params.resource,e.callback)}),EventManager.on("loadResources",function(e){e.preventDefault(),r.loadResources(e.params.resources,e.callback)}),j();var o=a?a:function(){};App.loadResources(App.resources,o)},App.loadResource=function(e,t){var a=this,r=t?t:function(){};if(!e)return a.log.warn("App.loadResorce fileName non definito!"),void r();var n=/(?:\.([^.]+))?$/,i=n.exec(e)[1],o="/"==e.charAt(0)?e:a.pluginsPath+e;if("js"==i)y(o,r);else{if("css"!=i)throw"invalid extension "+i+" del filename "+e;_(o,r)}},App.loadResources=function(e,t){var a=this,r=t?t:function(){};if(!e||0==e.length)return void r();var n=function i(t){a.loadResource(e[t],function(){return t<e.length-1?void i(t+1):void r()})};n(0)},App.addDashboard=function(e){var t=this,a=e.dashboardClass?e.dashboardClass:"Dashboard",r=new window[a](e),n="d"+o;return r.setId(n),e.id&&(u[e.id]=n),t.log.debug("add dashboard",a,e,n),l[n]=r,o++,r.draw(),r},App.getDashboard=function(e){return l[e]},App.getDashboardById=function(e){return this.getDashboard(u[e])},App.addView=function(e){var t=this;if(t.log.debug("App.addView",e),!window[e.viewClass])throw"View Class name "+e.viewClass+" not definited!";var a=View.factory(e.viewClass,e);t.log.debug("App.addView type",a.type);var o="v"+r;return a.setId(o),t.log.debug("constraint ",e.constraint),n[o]=a,e.id&&(i[e.id]=o),t.log.debug("addView "+o,n[o]),r++,e.autorender&&t.renderView(o),o},App.renderViews=function(){var e=this;for(var t in n)e.renderView(t)},App.renderView=function(e,t){var a=t?t:function(){};n[e].draw(a)},App.getView=function(e){return n[e]},App.getViews=function(){return n},App.getKeyFromId=function(e){return i[e]},App.removeViewById=function(e){return this.removeView(this.getKeyFromId(e))},App.removeAllViews=function(){var e=this;for(var t in n)e.removeView(t);n={},r=0},App.removeView=function(e){var t=this;for(var a in i)if(e==i[a]){delete i[a];break}var r=n[e];return r?(jQuery(r.container).html(""),r["delete"](),void delete n[e]):void t.log.warn("App.removeView con key "+e+" non trovata!")},App.renderViewById=function(e,t){this.renderView(this.getKeyFromId(e),t)},App.getViewById=function(e){return this.getView(this.getKeyFromId(e))},App.getHtmlConf=function(e){var t=this,a=(e.attr("crud-view"),{});return $.each(e[0].attributes,function(){this.specified&&(a[Utility.camelCase(this.name)]=this.value)}),"false"===Utility.lowerCase(a.autorender)?a.autorender=!1:a.autorender=!0,a.container=e,t.log.debug("Htlm param",a),a},App.parse=function(e){var t=this,a=e?e:"body";t.log.debug("App.parse "+a,jQuery(a).length);var r=[],n=[];return TraitTranslate.app=t,TraitTranslate.TraitTranslate(jQuery(a)),jQuery.each(jQuery(a).find("[crud-view]").addBack("[crud-view]"),function(){var e=t.getHtmlConf(jQuery(this));if(e.viewClass=jQuery(this).attr("crud-view"),e.conf){if(!window[e.conf])throw"impossibile trovare la definizione della configurazione "+e.conf;e=Conf.extend(window[e.conf],e)}else if(e.modelName){var a=window[e.viewClass].prototype.type;t.log.debug("Check conf Model_"+e.modelName+"."+a);var i=t.getConf(e.modelName,a);i||(i=t.getDefaultConf(a)),e=Conf.extend(i,e)}t.log.debug("Created view options ",e);var o=t.addView(e);n.push(o),r.push(jQuery(this).attr("crud-view")+" "+jQuery(this).attr("model_name"))}),t.log.debug("founds ",r),jQuery.each(jQuery(a).find("[crud-dashboard]").addBack("[crud-dashboard]"),function(){var e=jQuery(this).attr("crud-dashboard");t.log.debug("found dashboard",e);var a=t.getHtmlConf(jQuery(this));jQuery(this).removeAttr("crud-dashboard"),a.container=jQuery(this),a.dashboardClass=e,t.addDashboard(a)}),n},App.viewModal=function(e,t,a){var r=this,n=a?a:function(){},i=r.customDialog(null);t.autorender=!0,t.container=jQuery(i.id).find(".modal-body"),i.setTitle(e);var o=app.addView(t);return jQuery(i.id).on("hidden.bs.modal",function(){app.removeView(o),n()}),o},App.closeViewModal=function(){v.hide()},App.dashboardModal=function(e,t,a){var r=this,n=a?a:function(){},i=r.customDialog(null);i.setTitle(e),t.container=jQuery(i.id).find(".modal-body"),t.draw(),jQuery(i.id).on("hidden.bs.modal",function(){n()})},App.getConf=function(e,t,a){var r=this,n="Model_"+Utility.pascalCase(e);if(a&&!g(e,t,a))throw"Model_"+Utility.pascalCase(e)+Utility.pascalCase(a)+" Class not found!";return r.role&&g(e,t,r.role)&&(n+=r.role?Utility.pascalCase(r.role):""),window[n]&&window[n][t]?(r.log.debug("create configuration class "+n+"."+t),Conf.extend(window[n][t],{})):"insert"==t&&window[n]&&window[n].edit?(r.log.debug("create configuration class "+n+".edit for action "+t),Conf.extend(window[n].edit,{routeName:"insert"})):null},App.getDefaultConf=function(e){var t=this,a="Conf"+Utility.upperCaseFirst(e);return t.log.debug("create configuration Default ConfClass"+a),Conf.extend(window[a])},App.translate=function(e,t,a){return b(e,t,a)},App.translateIfExist=function(e,t,a){return jQuery.langDefs[e]?this.translate(e,t,a):""},App.getLocale=function(){return e},App.setLocale=function(t){e=t},App.waitStart=function(e,t){return t?void jQuery(t).fadeTo(250,.3).css("cursor","wait").css("pointer-events","none"):(e&&jQuery("#wait").find("[crud-msg]").html(e),jQuery("#wait").removeClass("hide"),void jQuery("#wait").css("cursor","wait"))},App.waitEnd=function(e){return e?void jQuery(e).fadeTo(250,1).css("cursor","auto").css("pointer-events","auto"):(jQuery("#wait").addClass("hide"),jQuery("#wait").css("cursor","default"),void jQuery("#wait").find("[crud-msg]").html(""))};var c=null;App.messageDialog=function(e,t){return c||(c=new MessageModal({labels:jQuery.langDefs})),c.show(e,t),c},App.messageDialogOld=function(e,t){return c||(c=new MessageModal({labels:jQuery.langDefs})),c.show(e,t),c};var p=null;App.errorDialog=function(e,t){return p||(p=new ErrorModal({labels:jQuery.langDefs})),p.show(e,t),p};var m=null;App.confirmDialog=function(e,t){return m||(m=new ConfirmModal({labels:jQuery.langDefs})),m.show(e,t),m};var f=null;App.warningDialog=function(e,t){return f||(f=new WarningModal({labels:jQuery.langDefs})),f.show(e,t),f};var v=null;App.customDialog=function(e,t){return v||(v=new CustomModal({labels:jQuery.langDefs})),v.show(e,t),v};var h=null;App.progressDialog=function(e,t){return h||(h=new ProgressModal({labels:jQuery.langDefs})),h.show(e,t),h};var g=function(e,t,a){var r="Model_"+Utility.pascalCase(e)+Utility.pascalCase(a);return!(!window[r]||!window[r][t])||!("insert"!=t||!window[r]||!window[r].edit)},y=function(e,r){var n=App,i=function(){t[e]=!0,a[e]=!0,r&&r()};if(!t[e]){var o=document.getElementsByTagName("body")[0],u=document.createElement("script");return u.type="text/javascript",u.src=e,u.onload=i,u.onerror=function(){n.log.error("cannot load script "+e)},void o.appendChild(u)}r()},_=function(e,r){var n=function(){t[e]=!0,a[e]=!0,r&&r()};if(t[e])return r();var i=document.getElementsByTagName("body")[0],o=document.createElement("link");return o.type="text/css",o.rel="stylesheet",o.href=e,o.onload=n,void i.appendChild(o)},b=function(e,t,a){var r=jQuery.langDefs[e];if(!r)return e;var n=r;if(n.indexOf("|")>=0)if(t>0){var i=n.split("|");n=i.length>t?i[t]:i[0]}else n=n.substr(0,n.indexOf("|"));if(a instanceof Array)for(var o=0;o<a.length;o++)n=n.replace("("+o+")",a[o]);return n},j=function(){jQuery("body").append('<div id="wait" class="overlay hide"><span crud-msg style="position:absolute;width:100%;top:50%;text-align:center;color:white"></span></div>')};return App}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){var e=!1,t=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(a){function r(){!e&&this.init&&this.init.apply(this,arguments)}var n=this.prototype;e=!0;var i=new this;e=!1;for(var o in a)i[o]="function"==typeof a[o]&&"function"==typeof n[o]&&t.test(a[o])?function(e,t){return function(){var a=this._super;this._super=n[e];var r=t.apply(this,arguments);return this._super=a,r}}(o,a[o]):a[o];return r.prototype=i,r.prototype.constructor=r,r.extend=arguments.callee,r}}();var TraitTranslate={labels:{},labelsContext:null,setLabel:function(e,t){return this.labels[e]=t,this},setLabels:function(e){return this.labels=e,this},getLabelKeys:function(e){var t=[];return jQuery(e).find("[crud-label]").each(function(e){t.push(jQuery(this).attr("crud-label"))}),t},TraitTranslate:function(e){var t=this,a=t.getLabelKeys(e);for(var r in a){var n=a[r],i=t.labelsContext?t.labelsContext+"."+n:n;t.labels[i]?jQuery(e).find('[crud-label="'+n+'"]').html(t.labels[i]):t.labels[n]?jQuery(e).find('[crud-label="'+n+'"]').html(t.labels[n]):t.app.translateIfExist(i)?jQuery(e).find('[crud-label="'+n+'"]').html(t.app.translateIfExist(i)):t.app.translateIfExist(n)&&jQuery(e).find('[crud-label="'+n+'"]').html(t.app.translateIfExist(n))}}};TraitPlaceholder={placeholders:{},placeholdersContext:null,setPlaceholder:function(e,t){return this.placeholders[e]=t,this},setPlaceholders:function(e){return this.placeholders=e,this},getPlaceholderKeys:function(e){var t=[];return jQuery(e).find("[crud-placeholder]").each(function(e){t.push(jQuery(this).attr("crud-placeholder"))}),t},TraitPlaceholder:function(e){var t=this,a=t.getPlaceholderKeys(e);for(var r in a){var n=a[r],i=t.placeholdersContext?t.placeholdersContext+"."+n:n;t.placeholders[i]?jQuery(e).find('[crud-placeholder="'+n+'"]').html(t.placeholders[i]):t.placeholders[n]?jQuery(e).find('[crud-placeholder="'+n+'"]').html(t.placeholders[n]):t.app.translateIfExist(i)?jQuery(e).find('[crud-placeholder="'+n+'"]').html(t.app.translateIfExist(i)):t.app.translateIfExist(n)&&jQuery(e).find('[crud-placeholder="'+n+'"]').html(t.app.translateIfExist(n))}}},TraitTemplate={templates:{},setTemplate:function(e,t){return this.templates[e]=t,this},setTemplates:function(e){return this.templates=e,this},getTemplateKeys:function(e){var t=[];return jQuery(e).find("[crud-template]").each(function(e){t.push(jQuery(this).attr("crud-template"))}),t},TraitTemplate:function(e){var t=this,a=t.getTemplateKeys(e);for(var r in a){var n=a[r],i=n+"Template";try{jQuery(e).find('[crud-template="'+n+'"]').html(t[i]())}catch(o){t.app.log.debug(t.className),t.app.log.error(t,"error run "+i+" "+o)}}}};var Component=Class.extend({className:"Component",defaultTraitsTemplate:["TraitTemplate","TraitTranslate","TraitPlaceholder"],traitsTemplate:[],traits:[],container:null,templateFile:null,init:function(e){var t=this;e&&(e.traits&&(t.traits=e.traits),e.defaultTraitsTemplate&&(t.defaultTraitsTemplate=e.defaultTraitsTemplate),e.traitsTemplate&&(t.traitsTemplate=e.traitsTemplate));var a=t.defaultTraitsTemplate.concat(t.traitsTemplate,t.traits);for(var r in a){var n=a[r];if(window[n])for(var i in window[n])this[i]=window[n][i];else t.app.log.warning("Trait "+n+" non trovato")}this.attrs(e),this.uid=Component.newID()},attrs:function(e){var t=this;if(e){for(var a in e)t[a]=e[a];return t}},template:function(){return""},getTemplate:function(){var e=this;if(null===e.template)return null;var t="";return t=_.isFunction(e.template)?e.template():1==jQuery(e.template).length?jQuery(e.template).html():e.template,Component.parseHtml(t)},html:function(){return this.container?jQuery(this.container).html():this.getTemplate().html()},draw:function(e){var t=this,a=e?e:function(){};t._loadExternalResources(function(){t.beforeRender(function(){t._prepareContainer(function(){t._executeTraitsTemplate(),t.render(function(){t.afterRender(function(){t.beforeFinalize(function(){t.finalize(function(){t.afterFinalize(function(){return a()})})})})})})})})},jQe:function(e){return e?jQuery(this.container).find(e).addBack(e):jQuery(this.container)},jQeHasAttr:function(e){var t=this,a=jQuery(t.container).attr(e);return"undefined"!==("undefined"==typeof a?"undefined":_typeof(a))&&a!==!1},beforeRender:function(e){return e()},render:function(e){return e()},afterRender:function(e){return e()},beforeFinalize:function(e){return e()},finalize:function(e){return e()},afterFinalize:function(e){return e()},_prepareContainer:function(e){var t=this,a=function(e){t.container?(jQuery(t.container).html(e.html()),e.remove()):t.container=e};if(t.templateFile)Server.get(t.templateFile,{},function(n){var i=t.templateFile.split("#");2==i.length?(t.app.log.debug("html file loaded, find #"+i[1]),r=Component.parseHtml(n).find("#"+i[1])):r=Component.parseHtml(n),a(r),e()});else{var r=t.getTemplate();if(null===r){if(!t.container)throw"Container e template nulli";t.container=jQuery(t.container),e()}else a(r),e()}},_executeTraitsTemplate:function(e){var t=this,a=t.defaultTraitsTemplate.concat(t.traitsTemplate);for(var r in a){var n=a[r];if(t[n]){var i=e?e:t.container;t[n](i)}}},_loadExternalResources:function(e){var t=this;return t.resources&&0!=t.resources.length?void t.app.loadResources(t.resources,e):e()}});Component.parseHtml=function(e,t){var a=document.createElement("div");return jQuery(a).html(jQuery.parseHTML(e)),t?jQuery(jQuery.getTemplate(jQuery(a),t)):jQuery(a)},Component.uid=0,Component.newID=function(){return"c"+Component.uid++},jQuery.queryStringToArray=function(e){var t=new Object;if(!e)return t;for(var a=e.split(/[;&]/),r=0;r<a.length;r++){var n=a[r].split("=");if(n&&2==n.length){var i=unescape(n[0]),o=unescape(n[1]);o=o.replace(/\+/g," "),t[i]=o}}return t},jQuery.fn.serializeAssoc=function(){var e=this.serializeArray(),t={};for(var a in e){var r=e[a].name,n=e[a].value;r.indexOf("[")>=0?(t[r]||(t[r]=[]),t[r].push(n)):t[r]=n}return t;var t};var Utility={_scripts:[],hasAttr:function(e,t){var a=e.attr(t);return"undefined"!==("undefined"==typeof a?"undefined":_typeof(a))&&a!==!1},getFormData:function(e){var t=this;if(0===e.length)return t.app.log.error("form not found!"),{};"undefined"!=typeof tinyMCE&&tinyMCE.triggerSave();var a=e.serializeAssoc(),r={};for(var n in a)if(a[n].constructor===Array){var i=/(.+)(\[\d+\])(.*)$/g,o=i.exec(n);if(o&&4==o.length){var u=o[1]+"[]"+o[3];r[u]||(r[u]=[]),r[u].push(a[n]),delete a[n]}else r[n]=a[n]}else r[n]=a[n];return r},initDate:function(e,t,a){var r="",n=jQuery('input[name="'+e+'"]').val(),i="",o="",u="";""!=n&&(i=n.substring(0,4),o=n.substring(5,7),u=n.substring(8,10));for(var l="",d=jQuery('[crud-year="'+e+'"]'),s=jQuery('[crud-month="'+e+'"]'),c=jQuery('[crud-day="'+e+'"]'),p=1;p<32;p++){var m=Utility.padDate(p,2);u==m&&(l=' selected="selected" '),r+='<option value="'+m+'"'+l+">"+m+"</option>",l=""}c.empty(),c.append(r),l="",r="";var f=["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"];for(p=1;p<13;p++)m=Utility.padDate(p,2),o==m&&(l=' selected="selected" '),r+='<option value="'+m+'"'+l+">"+f[p-1]+"</option>",l="";s.empty(),s.append(r),r="",l="";var v=t,h=a;for(v&&!isNaN(v)||(v=1901),isNaN(h)&&(h=(new Date).getFullYear()),p=v;p<=h;p++)i==p&&(l=' selected="selected" '),r+='<option value="'+p+'"'+l+">"+p+"</option>",l="";d.empty(),d.append(r)},changeDate:function(e){var t="",a=jQuery('[crud-year="'+e+'"]'),r=jQuery('[crud-month="'+e+'"]'),n=jQuery('[crud-day="'+e+'"]'),i="",o=28;"04"==r.val()||"06"==r.val()||"09"==r.val()||"11"==r.val()?o=30:"02"!=r.val()?o=31:a.val()%4!=0&&a.val()%100!=0||(o=29);for(var u=1;u<=o;u++){var l=Utility.padDate(u,2);n.val()==l&&(i=' selected="selected" '),t+='<option value="'+l+'"'+i+">"+l+"</option>",i=""}var d=n.val();n.empty(),n.append(t),d<=o&&n.val(d);var s=jQuery('input[name="'+e+'"]'),c=s.val().split(" "),p="";c.length>1&&(p=c[1]);var m="";if(""==a.val()||""==r.val()||""==n.val())m="";else var m=a.val()+"-"+r.val()+"-"+n.val();""!=p&&(m+=" "+p),s.val(m)},padDate:function(e,t,a){return e=e.toString(),a||(a="0"),e.length<t?Utility.padDate(a+""+e,t,a):e},toggleCheck:function(e){e.prop("checked",!e.prop("checked"))},isInt:function(e){return!isNaN(e)&&function(e){return(0|e)===e}(parseFloat(e))},dbDate:function(e){var t=e.getFullYear(),a=e.getMonth()+1;return t+="-"+(a>9?a:"0"+a),t+="-"+(e.getDate()>9?e.getDate():"0"+e.getDate()),t+=" "+(e.getHours()>9?e.getHours():"0"+e.getHours()),t+=":"+(e.getMinutes()>9?e.getMinutes():"0"+e.getMinutes()),t+=":"+(e.getSeconds()>9?e.getSeconds():"0"+e.getSeconds())},jsDate:function(e){var t=e.split("-"),a=new Date(t[0],t[1]-1,t[2].substr(0,2));return a},formatDate:function(e,t){var a=new Date(Date.parse(e));return isNaN(a.getTime())?"":a.toLocaleDateString(jQuery.locale,jQuery.cupparisDateFormat(t))},getURLParameter:function(e){return Utility.getURLParameterFromString(location.search,e)},getURLParameterFromString:function(e,t){return decodeURIComponent((new RegExp("[?|&]"+t+"=([^&;]+?)(&|#|;|$)").exec(e)||[,""])[1].replace(/\+/g,"%20"))||null},getURLParameterRegexp:function(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null},getAllUrlParams:function(){var e={},t=location.search.split("?");if(2!=t.length)return e;var a=t[1].split("&");for(var r in a){var t=a[r].split("=");if(2==t.length){var n=t[0],i=t[1];n.indexOf("[]")>=0?(e[n]||(e[n]=[]),e[n].push(decodeURIComponent(i))):e[n]=decodeURIComponent(i)}}return e},cloneObj:function(e){return JSON.parse(JSON.stringify(e))},nl2br:function(e){return e.replace(/(?:\r\n|\r|\n)/g,"<br />")},loadScript:function(e,t){var a=this;if(a._scripts[e])t&&t();else{a._scripts[e]=!0;var r=document.getElementsByTagName("body")[0],n=document.createElement("script");n.type="text/javascript",n.src=e,n.onload=t,r.appendChild(n)}},NON_WORD_REGEXP:/[^\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC\u0030-\u0039\u00B2\u00B3\u00B9\u00BC-\u00BE\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u09F4-\u09F9\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0B72-\u0B77\u0BE6-\u0BF2\u0C66-\u0C6F\u0C78-\u0C7E\u0CE6-\u0CEF\u0D66-\u0D75\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F33\u1040-\u1049\u1090-\u1099\u1369-\u137C\u16EE-\u16F0\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1946-\u194F\u19D0-\u19DA\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\u2070\u2074-\u2079\u2080-\u2089\u2150-\u2182\u2185-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2CFD\u3007\u3021-\u3029\u3038-\u303A\u3192-\u3195\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\uA620-\uA629\uA6E6-\uA6EF\uA830-\uA835\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19]+/g,
CAMEL_CASE_REGEXP:/([\u0061-\u007A\u00B5\u00DF-\u00F6\u00F8-\u00FF\u0101\u0103\u0105\u0107\u0109\u010B\u010D\u010F\u0111\u0113\u0115\u0117\u0119\u011B\u011D\u011F\u0121\u0123\u0125\u0127\u0129\u012B\u012D\u012F\u0131\u0133\u0135\u0137\u0138\u013A\u013C\u013E\u0140\u0142\u0144\u0146\u0148\u0149\u014B\u014D\u014F\u0151\u0153\u0155\u0157\u0159\u015B\u015D\u015F\u0161\u0163\u0165\u0167\u0169\u016B\u016D\u016F\u0171\u0173\u0175\u0177\u017A\u017C\u017E-\u0180\u0183\u0185\u0188\u018C\u018D\u0192\u0195\u0199-\u019B\u019E\u01A1\u01A3\u01A5\u01A8\u01AA\u01AB\u01AD\u01B0\u01B4\u01B6\u01B9\u01BA\u01BD-\u01BF\u01C6\u01C9\u01CC\u01CE\u01D0\u01D2\u01D4\u01D6\u01D8\u01DA\u01DC\u01DD\u01DF\u01E1\u01E3\u01E5\u01E7\u01E9\u01EB\u01ED\u01EF\u01F0\u01F3\u01F5\u01F9\u01FB\u01FD\u01FF\u0201\u0203\u0205\u0207\u0209\u020B\u020D\u020F\u0211\u0213\u0215\u0217\u0219\u021B\u021D\u021F\u0221\u0223\u0225\u0227\u0229\u022B\u022D\u022F\u0231\u0233-\u0239\u023C\u023F\u0240\u0242\u0247\u0249\u024B\u024D\u024F-\u0293\u0295-\u02AF\u0371\u0373\u0377\u037B-\u037D\u0390\u03AC-\u03CE\u03D0\u03D1\u03D5-\u03D7\u03D9\u03DB\u03DD\u03DF\u03E1\u03E3\u03E5\u03E7\u03E9\u03EB\u03ED\u03EF-\u03F3\u03F5\u03F8\u03FB\u03FC\u0430-\u045F\u0461\u0463\u0465\u0467\u0469\u046B\u046D\u046F\u0471\u0473\u0475\u0477\u0479\u047B\u047D\u047F\u0481\u048B\u048D\u048F\u0491\u0493\u0495\u0497\u0499\u049B\u049D\u049F\u04A1\u04A3\u04A5\u04A7\u04A9\u04AB\u04AD\u04AF\u04B1\u04B3\u04B5\u04B7\u04B9\u04BB\u04BD\u04BF\u04C2\u04C4\u04C6\u04C8\u04CA\u04CC\u04CE\u04CF\u04D1\u04D3\u04D5\u04D7\u04D9\u04DB\u04DD\u04DF\u04E1\u04E3\u04E5\u04E7\u04E9\u04EB\u04ED\u04EF\u04F1\u04F3\u04F5\u04F7\u04F9\u04FB\u04FD\u04FF\u0501\u0503\u0505\u0507\u0509\u050B\u050D\u050F\u0511\u0513\u0515\u0517\u0519\u051B\u051D\u051F\u0521\u0523\u0525\u0527\u0561-\u0587\u1D00-\u1D2B\u1D6B-\u1D77\u1D79-\u1D9A\u1E01\u1E03\u1E05\u1E07\u1E09\u1E0B\u1E0D\u1E0F\u1E11\u1E13\u1E15\u1E17\u1E19\u1E1B\u1E1D\u1E1F\u1E21\u1E23\u1E25\u1E27\u1E29\u1E2B\u1E2D\u1E2F\u1E31\u1E33\u1E35\u1E37\u1E39\u1E3B\u1E3D\u1E3F\u1E41\u1E43\u1E45\u1E47\u1E49\u1E4B\u1E4D\u1E4F\u1E51\u1E53\u1E55\u1E57\u1E59\u1E5B\u1E5D\u1E5F\u1E61\u1E63\u1E65\u1E67\u1E69\u1E6B\u1E6D\u1E6F\u1E71\u1E73\u1E75\u1E77\u1E79\u1E7B\u1E7D\u1E7F\u1E81\u1E83\u1E85\u1E87\u1E89\u1E8B\u1E8D\u1E8F\u1E91\u1E93\u1E95-\u1E9D\u1E9F\u1EA1\u1EA3\u1EA5\u1EA7\u1EA9\u1EAB\u1EAD\u1EAF\u1EB1\u1EB3\u1EB5\u1EB7\u1EB9\u1EBB\u1EBD\u1EBF\u1EC1\u1EC3\u1EC5\u1EC7\u1EC9\u1ECB\u1ECD\u1ECF\u1ED1\u1ED3\u1ED5\u1ED7\u1ED9\u1EDB\u1EDD\u1EDF\u1EE1\u1EE3\u1EE5\u1EE7\u1EE9\u1EEB\u1EED\u1EEF\u1EF1\u1EF3\u1EF5\u1EF7\u1EF9\u1EFB\u1EFD\u1EFF-\u1F07\u1F10-\u1F15\u1F20-\u1F27\u1F30-\u1F37\u1F40-\u1F45\u1F50-\u1F57\u1F60-\u1F67\u1F70-\u1F7D\u1F80-\u1F87\u1F90-\u1F97\u1FA0-\u1FA7\u1FB0-\u1FB4\u1FB6\u1FB7\u1FBE\u1FC2-\u1FC4\u1FC6\u1FC7\u1FD0-\u1FD3\u1FD6\u1FD7\u1FE0-\u1FE7\u1FF2-\u1FF4\u1FF6\u1FF7\u210A\u210E\u210F\u2113\u212F\u2134\u2139\u213C\u213D\u2146-\u2149\u214E\u2184\u2C30-\u2C5E\u2C61\u2C65\u2C66\u2C68\u2C6A\u2C6C\u2C71\u2C73\u2C74\u2C76-\u2C7B\u2C81\u2C83\u2C85\u2C87\u2C89\u2C8B\u2C8D\u2C8F\u2C91\u2C93\u2C95\u2C97\u2C99\u2C9B\u2C9D\u2C9F\u2CA1\u2CA3\u2CA5\u2CA7\u2CA9\u2CAB\u2CAD\u2CAF\u2CB1\u2CB3\u2CB5\u2CB7\u2CB9\u2CBB\u2CBD\u2CBF\u2CC1\u2CC3\u2CC5\u2CC7\u2CC9\u2CCB\u2CCD\u2CCF\u2CD1\u2CD3\u2CD5\u2CD7\u2CD9\u2CDB\u2CDD\u2CDF\u2CE1\u2CE3\u2CE4\u2CEC\u2CEE\u2CF3\u2D00-\u2D25\u2D27\u2D2D\uA641\uA643\uA645\uA647\uA649\uA64B\uA64D\uA64F\uA651\uA653\uA655\uA657\uA659\uA65B\uA65D\uA65F\uA661\uA663\uA665\uA667\uA669\uA66B\uA66D\uA681\uA683\uA685\uA687\uA689\uA68B\uA68D\uA68F\uA691\uA693\uA695\uA697\uA723\uA725\uA727\uA729\uA72B\uA72D\uA72F-\uA731\uA733\uA735\uA737\uA739\uA73B\uA73D\uA73F\uA741\uA743\uA745\uA747\uA749\uA74B\uA74D\uA74F\uA751\uA753\uA755\uA757\uA759\uA75B\uA75D\uA75F\uA761\uA763\uA765\uA767\uA769\uA76B\uA76D\uA76F\uA771-\uA778\uA77A\uA77C\uA77F\uA781\uA783\uA785\uA787\uA78C\uA78E\uA791\uA793\uA7A1\uA7A3\uA7A5\uA7A7\uA7A9\uA7FA\uFB00-\uFB06\uFB13-\uFB17\uFF41-\uFF5A])([\u0041-\u005A\u00C0-\u00D6\u00D8-\u00DE\u0100\u0102\u0104\u0106\u0108\u010A\u010C\u010E\u0110\u0112\u0114\u0116\u0118\u011A\u011C\u011E\u0120\u0122\u0124\u0126\u0128\u012A\u012C\u012E\u0130\u0132\u0134\u0136\u0139\u013B\u013D\u013F\u0141\u0143\u0145\u0147\u014A\u014C\u014E\u0150\u0152\u0154\u0156\u0158\u015A\u015C\u015E\u0160\u0162\u0164\u0166\u0168\u016A\u016C\u016E\u0170\u0172\u0174\u0176\u0178\u0179\u017B\u017D\u0181\u0182\u0184\u0186\u0187\u0189-\u018B\u018E-\u0191\u0193\u0194\u0196-\u0198\u019C\u019D\u019F\u01A0\u01A2\u01A4\u01A6\u01A7\u01A9\u01AC\u01AE\u01AF\u01B1-\u01B3\u01B5\u01B7\u01B8\u01BC\u01C4\u01C7\u01CA\u01CD\u01CF\u01D1\u01D3\u01D5\u01D7\u01D9\u01DB\u01DE\u01E0\u01E2\u01E4\u01E6\u01E8\u01EA\u01EC\u01EE\u01F1\u01F4\u01F6-\u01F8\u01FA\u01FC\u01FE\u0200\u0202\u0204\u0206\u0208\u020A\u020C\u020E\u0210\u0212\u0214\u0216\u0218\u021A\u021C\u021E\u0220\u0222\u0224\u0226\u0228\u022A\u022C\u022E\u0230\u0232\u023A\u023B\u023D\u023E\u0241\u0243-\u0246\u0248\u024A\u024C\u024E\u0370\u0372\u0376\u0386\u0388-\u038A\u038C\u038E\u038F\u0391-\u03A1\u03A3-\u03AB\u03CF\u03D2-\u03D4\u03D8\u03DA\u03DC\u03DE\u03E0\u03E2\u03E4\u03E6\u03E8\u03EA\u03EC\u03EE\u03F4\u03F7\u03F9\u03FA\u03FD-\u042F\u0460\u0462\u0464\u0466\u0468\u046A\u046C\u046E\u0470\u0472\u0474\u0476\u0478\u047A\u047C\u047E\u0480\u048A\u048C\u048E\u0490\u0492\u0494\u0496\u0498\u049A\u049C\u049E\u04A0\u04A2\u04A4\u04A6\u04A8\u04AA\u04AC\u04AE\u04B0\u04B2\u04B4\u04B6\u04B8\u04BA\u04BC\u04BE\u04C0\u04C1\u04C3\u04C5\u04C7\u04C9\u04CB\u04CD\u04D0\u04D2\u04D4\u04D6\u04D8\u04DA\u04DC\u04DE\u04E0\u04E2\u04E4\u04E6\u04E8\u04EA\u04EC\u04EE\u04F0\u04F2\u04F4\u04F6\u04F8\u04FA\u04FC\u04FE\u0500\u0502\u0504\u0506\u0508\u050A\u050C\u050E\u0510\u0512\u0514\u0516\u0518\u051A\u051C\u051E\u0520\u0522\u0524\u0526\u0531-\u0556\u10A0-\u10C5\u10C7\u10CD\u1E00\u1E02\u1E04\u1E06\u1E08\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1E1E\u1E20\u1E22\u1E24\u1E26\u1E28\u1E2A\u1E2C\u1E2E\u1E30\u1E32\u1E34\u1E36\u1E38\u1E3A\u1E3C\u1E3E\u1E40\u1E42\u1E44\u1E46\u1E48\u1E4A\u1E4C\u1E4E\u1E50\u1E52\u1E54\u1E56\u1E58\u1E5A\u1E5C\u1E5E\u1E60\u1E62\u1E64\u1E66\u1E68\u1E6A\u1E6C\u1E6E\u1E70\u1E72\u1E74\u1E76\u1E78\u1E7A\u1E7C\u1E7E\u1E80\u1E82\u1E84\u1E86\u1E88\u1E8A\u1E8C\u1E8E\u1E90\u1E92\u1E94\u1E9E\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u1EC8\u1ECA\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u1EF2\u1EF4\u1EF6\u1EF8\u1EFA\u1EFC\u1EFE\u1F08-\u1F0F\u1F18-\u1F1D\u1F28-\u1F2F\u1F38-\u1F3F\u1F48-\u1F4D\u1F59\u1F5B\u1F5D\u1F5F\u1F68-\u1F6F\u1FB8-\u1FBB\u1FC8-\u1FCB\u1FD8-\u1FDB\u1FE8-\u1FEC\u1FF8-\u1FFB\u2102\u2107\u210B-\u210D\u2110-\u2112\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u2130-\u2133\u213E\u213F\u2145\u2183\u2C00-\u2C2E\u2C60\u2C62-\u2C64\u2C67\u2C69\u2C6B\u2C6D-\u2C70\u2C72\u2C75\u2C7E-\u2C80\u2C82\u2C84\u2C86\u2C88\u2C8A\u2C8C\u2C8E\u2C90\u2C92\u2C94\u2C96\u2C98\u2C9A\u2C9C\u2C9E\u2CA0\u2CA2\u2CA4\u2CA6\u2CA8\u2CAA\u2CAC\u2CAE\u2CB0\u2CB2\u2CB4\u2CB6\u2CB8\u2CBA\u2CBC\u2CBE\u2CC0\u2CC2\u2CC4\u2CC6\u2CC8\u2CCA\u2CCC\u2CCE\u2CD0\u2CD2\u2CD4\u2CD6\u2CD8\u2CDA\u2CDC\u2CDE\u2CE0\u2CE2\u2CEB\u2CED\u2CF2\uA640\uA642\uA644\uA646\uA648\uA64A\uA64C\uA64E\uA650\uA652\uA654\uA656\uA658\uA65A\uA65C\uA65E\uA660\uA662\uA664\uA666\uA668\uA66A\uA66C\uA680\uA682\uA684\uA686\uA688\uA68A\uA68C\uA68E\uA690\uA692\uA694\uA696\uA722\uA724\uA726\uA728\uA72A\uA72C\uA72E\uA732\uA734\uA736\uA738\uA73A\uA73C\uA73E\uA740\uA742\uA744\uA746\uA748\uA74A\uA74C\uA74E\uA750\uA752\uA754\uA756\uA758\uA75A\uA75C\uA75E\uA760\uA762\uA764\uA766\uA768\uA76A\uA76C\uA76E\uA779\uA77B\uA77D\uA77E\uA780\uA782\uA784\uA786\uA78B\uA78D\uA790\uA792\uA7A0\uA7A2\uA7A4\uA7A6\uA7A8\uA7AA\uFF21-\uFF3A\u0030-\u0039\u00B2\u00B3\u00B9\u00BC-\u00BE\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u09F4-\u09F9\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0B72-\u0B77\u0BE6-\u0BF2\u0C66-\u0C6F\u0C78-\u0C7E\u0CE6-\u0CEF\u0D66-\u0D75\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F33\u1040-\u1049\u1090-\u1099\u1369-\u137C\u16EE-\u16F0\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1946-\u194F\u19D0-\u19DA\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\u2070\u2074-\u2079\u2080-\u2089\u2150-\u2182\u2185-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2CFD\u3007\u3021-\u3029\u3038-\u303A\u3192-\u3195\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\uA620-\uA629\uA6E6-\uA6EF\uA830-\uA835\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19])/g,TRAILING_DIGIT_REGEXP:/([\u0030-\u0039\u00B2\u00B3\u00B9\u00BC-\u00BE\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u09F4-\u09F9\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0B72-\u0B77\u0BE6-\u0BF2\u0C66-\u0C6F\u0C78-\u0C7E\u0CE6-\u0CEF\u0D66-\u0D75\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F33\u1040-\u1049\u1090-\u1099\u1369-\u137C\u16EE-\u16F0\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1946-\u194F\u19D0-\u19DA\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\u2070\u2074-\u2079\u2080-\u2089\u2150-\u2182\u2185-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2CFD\u3007\u3021-\u3029\u3038-\u303A\u3192-\u3195\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\uA620-\uA629\uA6E6-\uA6EF\uA830-\uA835\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19])([^\u0030-\u0039\u00B2\u00B3\u00B9\u00BC-\u00BE\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u09F4-\u09F9\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0B72-\u0B77\u0BE6-\u0BF2\u0C66-\u0C6F\u0C78-\u0C7E\u0CE6-\u0CEF\u0D66-\u0D75\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F33\u1040-\u1049\u1090-\u1099\u1369-\u137C\u16EE-\u16F0\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1946-\u194F\u19D0-\u19DA\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\u2070\u2074-\u2079\u2080-\u2089\u2150-\u2182\u2185-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2CFD\u3007\u3021-\u3029\u3038-\u303A\u3192-\u3195\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\uA620-\uA629\uA6E6-\uA6EF\uA830-\uA835\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19])/g,sentenceCase:function(e){return null==e?"":String(e).replace(Utility.CAMEL_CASE_REGEXP,"$1 $2").replace(Utility.TRAILING_DIGIT_REGEXP,"$1 $2").replace(Utility.NON_WORD_REGEXP," ").replace(/^ | $/g,"").toLowerCase()},camelCase:function(e){return Utility.sentenceCase(e).replace(/(\d) (?=\d)/g,"$1_").replace(/ (\w)/g,function(e,t){return t.toUpperCase()})},costantCase:function(e){return Utility.snakeCase(e).toUpperCase()},dotCase:function(e){return Utility.sentenceCase(e).replace(/ /g,".")},isLowerCase:function(e){return Utility.lowerCase(e)===e},isUpperCase:function(e){return Utility.upperCase(e)===e},lowerCase:function(e){var t=String.prototype.toLowerCase;return null==e?"":t.call(e)},paramCase:function(e){return Utility.sentenceCase(e).replace(/ /g,"-")},pascalCase:function(e){return Utility.upperCaseFirst(Utility.camelCase(e))},pathCase:function(e){return Utility.sentenceCase(e).replace(/ /g,"/")},snakeCase:function(e){return Utility.sentenceCase(e).replace(/ /g,"_")},swapCase:function(e){if(null==e)return"";for(var t="",a=0;a<e.length;a++){var r=e[a],n=r.toUpperCase();t+=n===r?r.toLowerCase():n}return t},titleCase:function(e){return Utility.sentenceCase(e).replace(/^\w| \w/g,Utility.upperCase)},upperCase:function e(t){var e=String.prototype.toUpperCase;return null==t?"":e.call(t)},upperCaseFirst:function(e){return null==e?"":(e=String(e),e.charAt(0).toUpperCase()+e.substr(1))},getMimetypeIcon:function(e){var t={"default":"fa fa-3x fa-file-o",xls:"fa fa-3x fa-file-excel-o",zip:"fa fa-3x fa-file-archive-o",mp3:"fa fa-3x fa-audio-o",jpg:"fa fa-3x fa-image-o",pdf:"fa fa-3x fa-file-pdf-o"};if(!e)return t["default"];var a=e.split(".").pop();return t[a]?t[a]:t["default"]},test:function(){log.info("test"===Utility.camelCase("test")),log.info("test"===Utility.camelCase("TEST")),log.info("testString"===Utility.camelCase("test string")),log.info("testString"===Utility.camelCase("Test String")),log.info("dotCase"===Utility.camelCase("dot.case")),log.info("pathCase"===Utility.camelCase("path/case")),log.info("version1_2_10"===Utility.camelCase("version 1.2.10")),log.info("version1_21_0"===Utility.camelCase("version 1.21.0")),log.info("testString"===Utility.camelCase("TestString")),log.info("TEST"===Utility.constantCase("test")),log.info("TEST"===Utility.constantCase("TEST")),log.info("TEST_STRING"===Utility.constantCase("test string")),log.info("TEST_STRING"===Utility.constantCase("Test String")),log.info("DOT_CASE"===Utility.constantCase("dot.case")),log.info("PATH_CASE"===Utility.constantCase("path/case")),log.info("TEST_STRING"===Utility.constantCase("TestString"))}};jQuery.locale="it",jQuery.langDefs={},jQuery.createDynamicContainer=function(e){var t="dy_"+(new Date).getTime()+"_"+Math.floor(1e4*Math.random());return jQuery("<div/>",{id:t,"class":"hide"}).appendTo("body"),e?jQuery("#"+t).html(jQuery.getDomTemplate(e).html()):jQuery("#"+t).html(" "),jQuery("#"+t)},jQuery.generalContainer=function(){return jQuery("#general_container")},jQuery.generalContainer.selector=function(){return"#general_container"},jQuery.getDomTemplate=function(e){if("SCRIPT"!=jQuery(e).prop("tagName"))return jQuery(e);var t=jQuery("<div/>");return jQuery(e).children().length?t.html(jQuery(e).children()[0].outerHTML):1==jQuery(e).length?t.html(jQuery(e).html()):jQuery.app.log.error("template not found with id "+e),t},jQuery.cupparisDateFormat=function(e){var t={numeric:{year:"numeric",month:"2-digit",day:"2-digit"},"numeric-time":{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"},"short":{year:"numeric",month:"short",day:"2-digit"},"short-2":{month:"short",day:"2-digit"},medium:{year:"numeric",month:"long",day:"2-digit"},"long":{year:"numeric",month:"long",day:"2-digit",weekday:"long"},"short-time":{hour:"2-digit",minute:"2-digit"},"long-time":{year:"numeric",month:"long",day:"2-digit",weekday:"long",hour:"2-digit",minute:"2-digit",second:"2-digit"},time:{hour:"2-digit",minute:"2-digit",second:"2-digit"},year:{year:"numeric"},"year-month":{year:"numeric",month:"long"}};return t[e]?t[e]:""},jQuery.renderTimeAmount=0,jQuery.renderJson=function(sourceContainer,destContainer,data,father){var getByDotKey=function(e,t){var a=t.split("."),r=e;for(var n in a)r=r[a[n]];return r},renderJsonElement=function renderJsonElement(jQelement,data,counter,length){jQelement.attr("crud-debug")&&jQuery.app.log.debug("renderJson DEBUG:","crud-attrs",jQelement.data(),"crud-param",data,"counter",counter,"length",length);var attrField=jQelement.attr("crud-field");try{if("undefined"!==("undefined"==typeof attrField?"undefined":_typeof(attrField))&&attrField!==!1)if(jQelement.attr("crud-template")||jQelement.attr("crud-self")){var tplId=jQelement.attr("crud-template")?jQelement.attr("crud-template"):jQelement.attr("crud-self"),istanceData=data[jQelement.attr("crud-field")];istanceData||(istanceData=data),istanceData instanceof Array?istanceData.length>0&&jQuery.renderJson(tplId,jQelement,istanceData,data):(jQelement.removeAttr("crud-template").removeAttr("crud-self"),jQuery.renderJson(tplId,jQelement,istanceData,data))}else{var fieldValue=null;if(fieldValue=jQelement.attr("crud-totranslate")?data[jQelement.attr("crud-field")+"_"+jQuery.locale]:"value"!=jQelement.attr("crud-field")||_.isObject(data)&&jQelement.attr("crud-field")in data?getByDotKey(data,jQelement.attr("crud-field")):data,parseInt(jQelement.attr("crud-trim"))>0){var chars=parseInt(jQelement.attr("crud-trim"));fieldValue=jQuery.trim(fieldValue),fieldValue.length>chars&&(fieldValue=fieldValue.substring(0,chars)+"...")}if(jQelement.attr("crud-date_format")){if(!moment)throw"moment undefined";var m=moment(fieldValue);fieldValue=m.format(jQelement.attr("crud-date_format"))}if(jQelement.is("input"))jQelement.attr("value",fieldValue);else if(jQelement.is("select"))if(jQelement.attr("crud-source"))try{var source=getByDotKey(data,jQelement.attr("crud-source")),source_order=[];source_order=jQelement.attr("crud-sourceorder")?getByDotKey(data,jQelement.attr("crud-sourceorder")):_.sortBy(_.keys(source),function(e){return e}),jQelement.html("");for(var i=0;i<source_order.length;i++){var v=source_order[i],selected=!1;v==fieldValue&&(selected=!0);var opt=jQuery("<option>").attr({value:v});selected&&opt.attr("selected","selected"),opt.html(source[v]),jQelement.append(opt)}}catch(e){jQuery.app.log.error(e)}else jQelement.find('option[value="'+fieldValue+'"]').attr("selected","selected");else jQelement.is("img")?jQelement.attr("src",fieldValue):jQelement.attr("crud-append")?jQelement.append(fieldValue):jQelement.attr("crud-prepend")?jQelement.prepend(fieldValue):jQelement.html(fieldValue)}if(jQelement.attr("crud-onclick")&&jQelement.attr("onclick",jQelement.attr("crud-onclick")),jQelement.attr("crud-href")){var b=eval("with (data) { "+jQelement.attr("crud-href")+" }");jQelement.attr("href",b)}if(jQelement.attr("crud-id")){var b=eval("with (data) { "+jQelement.attr("crud-id")+" }");jQelement.attr("id",b)}if(jQelement.attr("crud-remove")){var b=eval("with (data) { Boolean("+jQelement.attr("crud-remove")+") }");b&&jQelement.remove()}if(jQelement.attr("crud-class")){var b=eval("with (data) { "+jQelement.attr("crud-class")+" }");jQelement.attr("class",b)}if(jQelement.attr("crud-addclass")){var b=eval("with (data) { "+jQelement.attr("crud-addclass")+" }");jQelement.addClass(b)}if(jQelement.attr("crud-visible")){var b=eval("with (data) { Boolean("+jQelement.attr("crud-visible")+") }");b?jQelement.removeClass("hide"):jQelement.addClass("hide")}if(jQelement.attr("crud-attrs")){var s=jQelement.attr("crud-attrs"),b=eval("with (data) { var myattrs="+jQelement.attr("crud-attrs")+" }");for(var attr in myattrs)attr.indexOf("crud-")>=0&&(jQuery.isArray(myattrs[attr])||jQuery.isPlainObject(myattrs[attr]))?jQelement.attr(attr,JSON.stringify(myattrs[attr])):jQelement.attr(attr,myattrs[attr])}if(jQelement.attr("crud-html")){var b=eval("with (data) { "+jQelement.attr("crud-html")+" }");jQelement.html(b)}if(jQelement.attr("crud-source")&&!jQelement.attr("crud-field"))try{var source=getByDotKey(data,jQelement.attr("crud-source")),source_order=[];source_order=jQelement.attr("crud-sourceorder")?getByDotKey(data,jQelement.attr("crud-sourceorder")):_.sortBy(_.keys(source),function(e){return e}),jQelement.html("");for(var i=0;i<source_order.length;i++){var v=source_order[i],selected=!1;v==fieldValue&&(selected=!0);var opt=$("<option>").attr({value:v});selected&&opt.attr("selected","selected"),opt.html(source[v]),jQelement.append(opt)}}catch(e){jQuery.app.log.error(e)}if(jQelement.attr("crud-video_icon")){var values=data[jQelement.attr("crud-video_icon")];"string"==typeof values&&(values=JSON.parse(values));var thumb="";thumb=values.kind&&values.kind.indexOf("youtube")>=0?values.items[0].snippet.thumbnails["default"].url:values[0].thumbnail_small,jQelement.attr("src",thumb)}if(jQelement.attr("crud-video_player")){var values=data[jQelement.attr("crud-video_player")],mode=jQelement.attr("crud-video_mode");"string"==typeof values&&(values=JSON.parse(values));var video_info=null,provider=null;if(values.kind&&values.kind.indexOf("youtube")>=0?(video_info=values.items[0],provider="youtube"):(video_info=json[0],provider="vimeo"),"dialog"==mode){if("youtube"!=provider)return void alert("non implementato");var dialog_data={video_id:video_info.id,provider:"youtube"};jQuery(jQelement).attr("crud-video_dialog_data",JSON.stringify(dialog_data))}else if("youtube"==provider){var url="https://www.youtube.com/v/"+video_info.id,id="dy_"+(new Date).getTime()+"_"+Math.floor(1e4*Math.random());jQuery("<div/>",{id:id,"class":"hide"}).appendTo(jQelement),swfobject.embedSWF(url,id,"100%","100%","9.0.0")}}}catch(e){jQuery.app.log.warn(sourceContainer,destContainer,data,father,jQelement.prop("tagName")),jQuery.app.log.error(e)}},bindEvents=function(e){var t='[crud-video_mode="dialog"]';jQuery.each(jQuery(e).find(t),function(){jQuery(this).attr("video_mode")&&(jQuery(this).unbind("click"),jQuery(this).click(function(){var e=jQuery(this).attr("video_dialog_data"),t="dy_"+(new Date).getTime()+"_"+Math.floor(1e4*Math.random());if(jQuery("<div/>",{id:t,"class":"hide"}).appendTo("#generalDialog .modal-body"),"youtube"==e.provider){var a="https://www.youtube.com/v/"+e.video_id,r="300px",n="200px",i="9.0.0";swfobject.embedSWF(a,t,r,n,i),jQuery("#generalDialog").modal("show").ok(function(){jQuery("#generalDialog .modal-body").html(""),jQuery("#"+t).remove()}).cancel(function(){jQuery("#generalDialog .modal-body").html(""),jQuery("#"+t).remove()})}}))})},sourceHtml=jQuery.getDomTemplate(sourceContainer).html();jQuery(destContainer).html("");var selectors="[crud-field],[crud-href],[crud-id],[crud-visible],[crud-attrs],[crud-class],[crud-self],[crud-addclass],";if(selectors+="[crud-trim],[crud-html],[crud-remove],[crud-source],[crud-video_icon],[crud-video_player]",data instanceof Array){var startTime=new Date,tmpDiv=jQuery.createDynamicContainer();for(var k in data)tmpDiv.html(sourceHtml),jQuery.each(tmpDiv.find(selectors).addBack(selectors),function(){renderJsonElement(jQuery(this),data[k],k,data.length)}),jQuery(destContainer).append(tmpDiv.html());bindEvents(destContainer);var endTime=new Date,timeDiff=endTime-startTime;jQuery.renderTimeAmount+=timeDiff/=1e3}else{var startTime=new Date;jQuery(destContainer).append(sourceHtml),jQuery.each(jQuery(destContainer).find(selectors).addBack(selectors),function(){renderJsonElement(jQuery(this),data,0,0)}),bindEvents(destContainer);var endTime=new Date,timeDiff=endTime-startTime;jQuery.renderTimeAmount+=timeDiff/=1e3}},jQuery.normalizeTemplate=function(e){var t=[],a=function(e){jQuery("<div/>",{id:"self_"+t.length,"class":"hide"}).appendTo("body");var a=jQuery("#self_"+t.length);return a.html(e),t.push("#"+a.attr("id")),a},r=function n(e){if(0==e.find("[crud-self]").length){var t=a(e.html());return e.html(""),e.attr("crud-self","#"+t.attr("id")),1}return jQuery.each(e.find("[crud-self]"),function(){var e=n(jQuery(this));if(!e){var t=a(jQuery(this).html());jQuery(this).html(""),jQuery(this).attr("crud-self","#"+t.attr("id"))}}),0};return 0==jQuery(e).find("[crud-self]").length?t:(r(jQuery(e)),t)},jQuery.renderTemplate=function(e,t,a){var r=jQuery.createDynamicContainer(e),n=jQuery.normalizeTemplate("#"+r.attr("id"));jQuery.renderJson("#"+r.attr("id"),t,a);for(var i in n)jQuery(n[i]).remove();r.remove()},jQuery.getTemplate=function(e,t){var a=jQuery.createDynamicContainer();jQuery.renderTemplate(e,"#"+a.attr("id"),t);var r=a.html();return a.remove(),r},jQuery.parseTemplate=function(e,t){var a=this;a._replaceAll=function(e,t,a){if(!e)return"Invalid template source";null===a&&(a="");for(var r=e,n=r.indexOf(t);n!=-1;)r=r.replace(t,a),n=r.indexOf(t);return r};try{jQuery.each(t,function(t,r){e=a._replaceAll(e,"["+t+"]",r)});var r={tagjs:"<script>","/tagjs":"</script>"};jQuery.each(r,function(t,r){e=a._replaceAll(e,"["+t+"]",r)})}catch(n){alert(n.message)}return e},jQuery.fn.autoUpload=function(e){jQuery(this).change(e)},jQuery._msgToString=function(e){var t="No message";return e&&("string"==jQuery.type(e)?t=e:"array"==jQuery.type(e)&&(t=e.join("<br>"))),t},jQuery.getFailMessage=function(e){try{if(jQuery.isProduction)return e.status+" "+e.statusText;var t=e.status+" "+e.statusText+"<br>";return e.responseJSON&&(t+=e.responseJSON.error.message+"<br>",t+="line :"+e.responseJSON.error.line+"<br>",t+=e.responseJSON.error.file),t}catch(a){return""+a}};var EventManager=Class.extend({});EventManager.trigger=function(e,t,a){var r=a?a:function(){};jQuery.event.trigger({type:e,params:t,callback:r})},EventManager.on=function(e,t){jQuery(document).on(e,function(e){e.preventDefault(),t(e)})},EventManager.off=function(e){jQuery(document).off(e)};var Server={};Server.getUrl=function(e){return Server.subdomain?Server.subdomain+e:e},Server.post=function(e,t,a){var r=Server.getUrl(e);jQuery.post(r,t,function(e){a(e)}).fail(function(e){a({error:1,msg:jQuery.getFailMessage(e)})})},Server.get=function(e,t,a){var r=Server.getUrl(e);jQuery.get(r,t,function(e){a(e)}).fail(function(e){a({error:1,msg:jQuery.getFailMessage(e)})})},Server.route=function(e,t){var a=t?t:function(t){log.debug(e.className,t)},r=Server.getUrl(e.getUrl()),n=e.getParams();Server[e.method](r,n,function(e){a(e)})},Server.subdomain=null,Template=Component.extend({html:function(){var e=this;return e.container=jQuery("<div></div>"),e.draw(),e.jQe().html()}}),Template.factory=function(e,t){var a=e?e:"",r="Template"+Utility.pascalCase(a);if(!window[r])throw"Impossibile trovare la definizione del template "+r;var n=t?t:{};return n.className=r,new window[r](n)},Template.getRenderContainer=function(e){var t=e.find("[crud-render]");return 0==t.length?e:t},TemplateLeft=Template.extend({template:function(){return'<div class="view-field clearfix">                    <div class="col col-sm-12 view-msg" crud-label="msg">                    </div>                    <div class="col col-sm-4">                        <div class="col col-sm-10">                            <label crud-html_label crud-label="label"></label>                        </div>                    </div>                    <div class="col col-sm-8" crud-render>                    </div>                    <div class="col col-sm-12">                        <small crud-label="addedLabel" class="view-addedLabel"></small>                    </div>                    <div class="col col-sm-12 view-field-error text-danger" crud-label="error">                    </div>                </div>'}}),TemplateTop=Template.extend({template:function(){return'<div class="view-field clearfix">                    <div class="col col-sm-12">                        <label crud-label="label">                        </label>                    </div>                    <div class="col col-sm-12 view-msg" crud-label="msg">                    </div>                    <div class="col col-sm-12" crud-render>                    </div>                    <div class="col col-sm-12 view-field-error" crud-label="error">                    </div>                </div>'}}),TemplateNo=Template.extend({template:function(){return'<div class="col col-xs-12" crud-render></div>'}}),TemplateSimple=Template.extend({template:function(){return"<div crud-render></div>"}}),Modal=Component.extend({container:"body",id:"#coreDialog",body_selector:"[crud-body]",title:"",content:function(){return""},init:function(e){var t=this;this._super(e),t._createDialog(),t.setTitle(t.title)},setTitle:function(e){var t=this;t.jQe().find("[crud-title]").html(e)},_createDialog:function(){var e=this,t=e.getTemplate();e.container?(jQuery(e.container).append(t.html()),t.remove()):e.container=t},render:function(e){var t=this;jQuery(t.id).find(t.body_selector).html(Component.parseHtml(t.content()).html());for(var a in t.labels)t.jQe().find('[crud-label="'+a+'"]').html(t.labels[a]);return e()},show:function(e,t){var a=this;if(e)if(e instanceof Object)for(var r in e)a[r]=e[r];else a.content=function(){return e};a.beforeRender(function(){a.render(function(){a.afterRender(function(){a.beforeFinalize(function(){a._loadExternalResources(function(){a.finalize(function(){a.afterFinalize(function(){var e=jQuery(a.id),r=t?t:{};a._executeTraitsTemplate(e),e.find("[crud-button]").unbind("click"),e.find("[crud-button]").click(function(){var e=jQuery(this).attr("crud-button");r[e]&&r[e](a)}),e.modal("show")})})})})})})})},hide:function(){var e=this;e.jQe().modal("hide")},jQe:function(e){return e?jQuery(this.id).find(e):jQuery(this.id)}}),MessageModal=Modal.extend({id:"#messageDialog",body_selector:"[crud-message]",template:function(){return'<div id="messageDialog" class="modal fade" role="dialog">                    <div class="modal-dialog">        \t            <div class="modal-content">        \t                <div class="modal-header">        \t                <button crud-button="ok" type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>        \t                    <h4 crud-title class="modal-title" crud-label="titolo">Informazione</h4>        \t                </div>                            <div class="modal-body">                                <div class="alert alert-info">                                    <span crud-message class="msg">message</span>                                </div>                            </div>                            <div class="modal-footer">                                <button type="button" crud-button="ok" class="btn btn-primary" data-dismiss="modal">Chiudi</button>                            </div>                        </div><!-- /.modal-content -->                    </div><!-- /.modal-dialog -->                </div><!-- /.modal -->'}}),ErrorModal=Modal.extend({id:"#errorDialog",body_selector:"[crud-message]",template:function(){return'<div id="errorDialog" class="modal fade">                    <div class="modal-dialog">                        <div class="modal-content ">                            <div class="modal-header">                                <button crud-button="ok" type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>                                <h4 crud-title class="modal-title">Messaggio Errore</h4>                            </div>                            <div class="modal-body">                                <div class="alert alert-danger">                                    <span crud-message class="msg">Error</span>                                </div>                            </div>                            <div class="modal-footer">                                <button crud-button="ok" type="button" class="btn btn-primary btok" data-dismiss="modal">Chiudi</button>                            </div>                        </div><!-- /.modal-content -->                    </div><!-- /.modal-dialog -->                </div><!-- /.modal -->'}}),WarningModal=Modal.extend({id:"#warningDialog",body_selector:"[crud-message]",template:function(){return'<div id="warningDialog" class="modal fade">                    <div class="modal-dialog">                        <div class="modal-content ">                            <div class="modal-header">                                <button crud-button="ok" type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>                                <h4 crud-title class="modal-title">Messaggio di warning</h4>                            </div>                            <div class="modal-body">                                <div class="alert alert-warning">                                    <span crud-message class="msg">Warning</span>                                </div>                            </div>                            <div class="modal-footer">                                <button crud-button="ok" type="button" class="btn btn-primary btok" data-dismiss="modal">Chiudi</button>                            </div>                        </div><!-- /.modal-content -->                    </div><!-- /.modal-dialog -->                </div><!-- /.modal -->'}}),ConfirmModal=Modal.extend({id:"#confirmDialog",body_selector:"[crud-message]",template:function(){return'<div id="confirmDialog" class="modal fade">                    <div class="modal-dialog">                        <div class="modal-content">                            <div class="modal-header">                                <button crud-button="cancel" type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>                                <h4 crud-title class="modal-title">Richiesta di Conferma</h4>                            </div>                            <div class="modal-body">                                <span crud-message class="msg">Sei Sicuro?</span>                            </div>                            <div class="modal-footer">                                <button crud-button="ok" type="button" class="btn btn-primary" data-dismiss="modal">Si</button>                                <button crud-button="cancel" type="button" class="btn btn-primary" data-dismiss="modal">No</button>                            </div>                        </div><!-- /.modal-content -->                    </div><!-- /.modal-dialog -->                </div><!-- /.modal -->';
}}),ProgressModal=Modal.extend({id:"#progressDialog",body_selector:"[crud-message]",progress_selector:"[crud-progress_bar]",setProgress:function(e){var t=this;t.jQe().find(" .progress").css("width",e+"%"),t.jQe().find(".progress-bar ").text(e+"%")},template:function(){return'<div id="progressDialog" class="modal fade">                    <div class="modal-dialog">                        <div class="modal-content">                            <div class="modal-header">                                <button crud-button="cancel" type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>                                <h4 crud-title class="modal-title">Stato richiesta</h4>                            </div>                            <div class="modal-body">                                <div crud-message class="msg">Attendi...</div>                                <div class="progress progress-striped active">                                        <div class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="" aria-valuemin="0" aria-valuemax="100" style="width: 100%">                                                                    </div>                                </div>                            </div>                            <div class="modal-footer">                                <button crud-button="ok" type="button" class="btn btn-primary" data-dismiss="modal">Si</button>                                <button crud-button="cancel" type="button" class="btn btn-primary" data-dismiss="modal">No</button>                            </div>                        </div><!-- /.modal-content -->                    </div><!-- /.modal-dialog -->                </div><!-- /.modal -->'}}),CustomModal=Modal.extend({id:"#customDialog",body_selector:"[crud-content]",className:"CustomModal",content:function(){return'<div class="modal-header">                    <button crud-button="ca\ncel" type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>                    <h4 crud-title class="modal-title">&nbsp;</h4>                </div>                <div class="modal-body" crud-body>                   &nbsp;                </div>                <div class="modal-footer">                    &nbsp;                </div>'},template:function(){return'<div id="customDialog" class="modal fade">                  <div class="modal-dialog">                    <div class="modal-content" crud-content>                    </div><!-- /.modal-content -->                  </div><!-- /.modal-dialog -->                </div><!-- /.modal -->'}});var Render=Component.extend({key:null,className:"Render",element_selector:"[crud-render_element]",control_selector:"[crud-render_control]",operator_selector:"[crud-render_operator]",operator:null,value:null,container:null,app:null,resources:[],metadata:{},htmlAttributes:{},init:function(e,t){this.key=e,this.metadata=JSON.parse(JSON.stringify(this.metadata)),this.resources=JSON.parse(JSON.stringify(this.resources)),this._super(t)},_setHtmlAttributes:function(e){var t=this;for(var a in t.htmlAttributes)e.attr(a,t.htmlAttributes[a])},change:function(){},clear:function(){throw this.className+": <clear> method must be overloaded "},setValue:function(){throw this.className+": <setValue> method must be overloaded "},getValue:function(){throw this.className+": <getValue> method must be overloaded "},setMetadata:function(e){this.metadata=e},_getControlSelector:function(){var e=this;return 0==e.jQe(e.control_selector).length?e.jQe():e.jQe(e.control_selector)}});Render.VIEW="view",Render.EDIT="edit",Render.SEARCH="search",Render.factory=function(e,t){var a=t?t:{};a.type||(a.type="input"),a.mode||(a.mode="edit");var r=null,n="Render"+Utility.pascalCase(a.type)+Utility.pascalCase(a.mode);if(!window[n])throw"Impossibile trovare la definizione "+n;try{var i={},o={};for(var u in a)_.isFunction(a[u])?i[u]=a[u]:o[u]=a[u];var l=window[n].extend(i);r=new l(e,o),r.className=n}catch(d){throw app.log.error(n,e,a,d),d}return r},Render.mymap=null;var BaseInput=Render.extend({currentValue:null,inputType:"text",type:"input",htmlAttributes:{},setValue:function(e){var t=this;this.value=e,t._getControlSelector().attr("value",e).val(e)},getValue:function(){var e=this;return e._getControlSelector().val()},_attachEvents:function(){var e=this;jQuery(e.container).find(e.control_selector).change(function(){e.currentValue=jQuery(this).val(),e.change()})},clear:function(){var e=this;e._getControlSelector().val("")}}),RenderInputSearch=BaseInput.extend({render:function(){var e=this,t=jQuery(e.container).find(e.control_selector);e._setHtmlAttributes(t),t.attr("type",e.inputType),t.attr("name","s_"+e.key+"[]"),t.attr("value",e.value).attr("placeholder",""),t=jQuery(e.container).find(e.operator_selector),t.attr("name","s_"+e.key+"_operator"),t.attr("value",e.operator)},finalize:function(){var e=this;e._attachEvents()},template:function(){return'<input crud-render_control type="text" class="form-control" crud-placeholder="">                <input crud-render_operator type="hidden" >'}}),RenderInputEdit=BaseInput.extend({render:function(e){var t=this,a=jQuery(t.container).find(t.control_selector);return a.attr("value",t.value).val(t.value).attr("type",t.inputType).attr("name",t.key).attr("placeholder",""),t._setHtmlAttributes(a),e()},finalize:function(e){var t=this;return t._attachEvents(),e()},template:function(){return'<input crud-render_control type="text" class="form-control" crud-placeholder="">'}}),RenderInputView=BaseInput.extend({render:function(e){var t=this;return t.jQe(t.control_selector).html(t.value),e()},template:function(){return"<span crud-render_control></span>"},setValue:function(e){this.value=e,this._getControlSelector().html(e)}}),RenderHiddenSearch=RenderInputSearch.extend({inputType:"hidden"}),RenderHiddenEdit=RenderInputEdit.extend({inputType:"hidden"}),RenderHiddenView=RenderInputView.extend({inputType:"hidden",template:function(){return'<span crud-render_control class="hide"></span>'}}),RenderPasswordEdit=RenderInputEdit.extend({inputType:"password",template:function(){return'<input autocomplete="off" crud-render_control type="text" class="form-control" crud-placeholder="">'}}),BaseText=Render.extend({setValue:function(e){var t=this;this.value=e,jQuery(t.container).find(t.control_selector).html(e)},getValue:function(){var e=this;return jQuery(e.container).find(e.control_selector).html()}}),RenderTextEdit=BaseText.extend({render:function(e){var t=this;return t.jQe().find(t.control_selector).html(t.value),e()},template:function(){return"<span crud-render_control></span>"}}),RenderTextSearch=RenderTextEdit.extend({}),RenderTextView=RenderTextEdit.extend({}),BaseTextarea=Render.extend({getValue:function(){var e=this;return jQuery(e.container).find(e.control_selector).val()}}),RenderTextareaEdit=BaseTextarea.extend({render:function(e){var t=this,a=t.jQe().find(t.control_selector);return a.attr("name",t.key),a.html(t.value),t._setHtmlAttributes(a),e()},template:function(){return'<textarea crud-render_element crud-render_control class="form-control" name="" value=""></textarea>'}}),RenderTextareaSearch=RenderTextareaEdit.extend({render:function(e){var t=this,a=t.jQe().find(t.control_selector);return a.attr("name","s_"+t.key+"[]"),a.html(t.value),t._setHtmlAttributes(a),a=t.jQe().find(t.operator_selector),a.attr("name","s_"+t.key+"_operator"),a.attr("value",t.operator),e()},template:function(){return'<textarea crud-render_element crud-render_control class="form-control" name="" value=""></textarea>                <input crud-render_operator type="hidden" >'}}),RenderTextareaView=BaseTextarea.extend({template:function(){return"<span crud-render_control></span>"},render:function(e){var t=this;return t.jQe().find(t.control_selector).html(t.value),e()},getValue:function(){var e=this;return jQuery(e.container).find(e.control_selector).html()}}),BaseSelect=Render.extend({multiple:!1,metadata:{domainValuesOrder:null,domainValues:{}},_setData:function(){var e=this,t=e.jQe().find(e.control_selector);e.multiple&&t.attr("multiple","multiple");var a=[];a=e.metadata.domainValuesOrder?e.metadata.domainValuesOrder:_.sortBy(_.keys(e.metadata.domainValues),function(e){return e}),t.html("");for(var r=0;r<a.length;r++){var n=a[r],i=!1;e.multiple?jQuery.inArray(n,e.value)>=0&&(i=!0):n==e.value&&(i=!0);var o=jQuery("<option>").attr({value:n});i&&o.attr("selected","selected"),o.html(e.metadata.domainValues[n]),t.append(o)}t.attr("value",e.value)},setValue:function(e){var t=this;t.jQe(t.control_selector).val(e).change()},clear:function(){var e=this;e.jQe(e.control_selector).prop("selectedIndex",0)}}),RenderSelectEdit=BaseSelect.extend({getValue:function(){var e=this;return e.jQe(e.control_selector).val()},render:function(e){var t=this;t._setData();var a=t.jQe().find(t.control_selector),r=t.key,n=t.key.indexOf("[]")>0?t.key.slice(0,-2)+"_exists[]":t.key+"_exists";t.multiple&&(r+="[]"),a.attr("name",r),jQuery("<input>").attr({type:"hidden",name:n,value:1}).appendTo(t.jQe()),e()},finalize:function(e){var t=this;jQuery(t.container).find(t.control_selector).change(function(){t.change(jQuery(this).val())}),e()},template:function(){return'<select crud-render_control class="form-control" ></select>'}}),RenderSelectSearch=RenderSelectEdit.extend({operator:null,render:function(e){var t=this;t._setData();var a=t.jQe().find(t.control_selector);return a.attr("name","s_"+t.key+"[]"),a=t.jQe().find(t.operator_selector),a.attr("name","s_"+t.key+"_operator"),a.attr("value",t.operator),e()},template:function(){return'<select crud-render_control class="form-control" ></select>                <input crud-render_operator type="hidden" >'}}),RenderSelectView=RenderSelectEdit.extend({getValue:function(){var e=this;return e.value},render:function(e){var t=this;return t._setData(),e()},finalize:function(e){var t=this;return jQuery(t.container).find(t.control_selector).prop("disabled","disabled"),e()}}),BaseRadio=Render.extend({caption_selector:"[crud-render_caption]",metadata:{domainValues:{0:"No",1:"Si"},domainValuesOrder:null},getValue:function(){var e=this;return jQuery(e.container).find('[type="radio"]:checked').val()},clear:function(){var e=this;jQuery(e.container).find("input:checked").prop("checked",!1)},_setData:function(e){var t=this,a=t.jQe().find(t.element_selector),r=t._orderValues();if(0!=r.length){for(var n=0;n<r.length-1;n++)a.parent().append(a.clone());for(var i=t.value?t.value:null==t.value&&"checkbox"==t.choiceType?[]:t.value,n=0;n<r.length;n++){var o=""+r[n],u=!1;o==i&&(u=!0);var l=jQuery(t.jQe().find(t.element_selector).get(n));l.find(t.control_selector).attr("name",e).attr("value",o),l.find(t.caption_selector).html(t.app.translate(t.metadata.domainValues[o])),l.addClass(t.choiceType),u?l.find(t.control_selector).attr("checked","checked"):l.find(t.control_selector).removeAttr("checked")}}},_orderValues:function(){var e=this,t=[];return t=e.metadata.domainValuesOrder?e.metadata.domainValuesOrder:_.sortBy(_.keys(e.metadata.domainValues),function(e){return e}),t.map(String)}}),RenderRadioEdit=BaseRadio.extend({exists_selector:"[crud-render_exists]",render:function(e){var t=this,a=t.key,r=t.key.indexOf("[]")>0?t.key.slice(0,-2)+"_exists[]":t.key+"_exists";return t.multiple&&(a+="[]"),t._setData(a),t.jQe(t.exists_selector).attr(a,r),e()},template:function(){return'<label crud-render_element class="radio-inline">                  <input crud-render_control  type="radio" value=""> <span crud-render_caption></span>                </label>                <input crud-render_exists type="hidden" >'}}),RenderRadioSearch=RenderRadioEdit.extend({render:function(e){var t=this;t._setData("s_"+t.key+"[]");var a=t.jQe().find(t.operator_selector);return a.attr("name","s_"+t.key+"_operator"),a.attr("value",t.operator),e()},template:function(){return'<label crud-render_element class="radio-inline">                  <input crud-render_control  type="radio" value=""> <span crud-render_caption></span>                </label>                <input crud-render_operator type="hidden" >'}}),RenderRadioView=BaseRadio.extend({render:function(e){var t=this,a=t.jQe().find(t.element_selector),r=t._orderValues(),n=[];for(var i in r){var o=r[i],u="fa fa-circle-o";o==t.value&&(u="fa fa-circle"),n.push({icon_class:u,text:t.metadata.domainValues[o]})}var l=jQuery.getTemplate(a,n);return a.append(l),e()},template:function(){return'<div crud-render_element class="checkbox-inline">                    <i crud-class="icon_class" ></i> <span crud-field="text"> </span>                </div>'},getValue:function(){var e=this;return e.value}}),BaseCheckbox=Render.extend({caption_selector:"[crud-render_caption]",operator:null,metadata:{domainValuesOrder:null,domainValues:null},getValue:function(){var e=this,t=[];return jQuery(e.container).find('[type="checkbox"]:checked').each(function(){t.push($(this).val())}),t},clear:function(){var e=this;jQuery(e.container).find("input:checked").prop("checked",!1)},_setData:function(e){var t=this,a=t.jQe().find(t.element_selector),r=t._orderValues();if(0!=r.length){for(var n=0;n<r.length-1;n++)a.parent().append(a.clone());for(var i=t.value?t.value:[],n=0;n<r.length;n++){var o=""+r[n],u=!1;jQuery.inArray(o,i.map(String))>=0&&(u=!0);var l=jQuery(t.jQe().find(t.element_selector).get(n));l.find(t.control_selector).attr("name",e).attr("value",o),l.find(t.caption_selector).html(t.metadata.domainValues[o]),l.addClass(t.choiceType),u?l.find(t.control_selector).attr("checked","checked"):l.find(t.control_selector).removeAttr("checked")}}},_orderValues:function(){var e=this,t=[];return t=e.metadata.domainValuesOrder?e.metadata.domainValuesOrder:_.sortBy(_.keys(e.metadata.domainValues),function(e){return e}),t.map(String)}}),RenderCheckboxEdit=BaseCheckbox.extend({exists_selector:"[crud-render_exists]",render:function(e){var t=this,a=t.key+"[]",r=t.key.indexOf("[]")>0?t.key.slice(0,-2)+"_exists[]":t.key+"_exists";return t._setData(a),t.jQe(t.exists_selector).attr("name",r),e()},template:function(){return'<label crud-render_element class="checkbox-inline">                    <input crud-render_control type="checkbox" value="">  <span crud-render_caption> </span>                </label>                <input crud-render_exists type="hidden" >'}}),RenderCheckboxSearch=RenderCheckboxEdit.extend({render:function(e){var t=this;t._setData("s_"+t.key+"[]");var a=t.jQe().find(t.operator_selector);return a.attr("name","s_"+t.key+"_operator"),a.attr("value",t.operator),e()},template:function(){return'<label crud-render_element class="checkbox-inline">                    <input crud-render_control type="checkbox" value="">  <span crud-render_caption> </span>                </label>                <input crud-render_operator type="hidden" >'}}),RenderCheckboxView=BaseCheckbox.extend({getValue:function(){return this.value},render:function(e){var t=this,a=t.jQe().find(t.element_selector),r=t._orderValues(),n=[];for(var i in r){var o=r[i],u="fa fa-square-o";_.isArray(t.value)?jQuery.inArray(o,new String(t.value))>=0&&(u="fa fa-square"):o==t.value&&(u="fa fa-square"),n.push({icon_class:u,text:t.metadata.domainValues[o]})}var l=jQuery.getTemplate(a,n);return a.append(l),e()},template:function(){return'<div crud-render_element class="checkbox-inline">                    <i crud-class="icon_class" ></i> <span crud-field="text"> </span>                </div>'}}),RenderImageView=Render.extend({imageTemplate:null,getValue:function(){return jQuery(this.container).find(this.control_selector).attr("src")},render:function(e){var t=this,a=t.value;return t.imageTemplate&&("/"!=a[a.length-1]&&(a+="/"),a+=t.imageTemplate),t.jQe().find(t.control_selector).attr("src",a),e()},template:function(){return"<img crud-render_control>"}}),CommonRenderTime=Component.extend({hour_selector:"[crud-render_hour]",minute_selector:"[crud-render_minute]",second_selector:"[crud-render_second]",_setData:function(){for(var e=this,t=e.jQe(e.hour_selector),a=0;a<24;a++){var r=a>=10?a:"0"+a,n=jQuery("<option>").attr({value:r});n.html(r),t.append(n)}for(var i=e.jQe(e.minute_selector),o=e.jQe(e.second_selector),a=0;a<60;a++){var r=a>=10?a:"0"+a,u=jQuery("<option>").attr({value:r}),l=jQuery("<option>").attr({value:r});u.html(r),l.html(r),i.append(u),o.append(l)}},getValue:function(){return jQuery(this.container).find(this.control_selector).val()}}),RenderTimeEdit=CommonRenderTime.extend({render:function(e){var t=this,a=t.jQe().find(t.element_selector);a.find(t.control_selector).attr("name",t.key),a.find(t.control_selector).attr("value",t.value),t._setData(),e()},finalize:function(e){var t=this;jQuery(t.container).find(t.hour_selector+","+t.minute_selector+","+t.second_selector).change(function(){var e=jQuery(t.container).find(t.hour_selector).val()+":"+jQuery(t.container).find(t.minute_selector).val()+":"+jQuery(t.container).find(t.second_selector).val();jQuery(t.container).find(t.control_selector).val(e)});try{var a=jQuery(t.container).find(t.control_selector).val().split(":");jQuery('[crud-render_hour="'+t.key+'"]').val(a[0]),jQuery('[crud-render_minute="'+t.key+'"]').val(a[1]),jQuery('[crud-render_second="'+t.key+'"]').val(a[2])}catch(r){log.error(r)}e()}}),RenderTimeSearch=RenderTimeEdit.extend({render:function(e){var t=this,a=t.jQe().find(t.control_selector);a.attr("name","s_"+t.key+"[]").attr("value",t.value),jQuery("<input>").attr({type:"hidden",name:"s_"+t.key+"_operator","crud-render_operator":t.key,value:t.operator}).appendTo(t.jQe()),t._setData(),e()}}),RenderTimeView=CommonRenderTime.extend({}),BaseSwap=Render.extend({icon_selector:"[crud-icon]",iconClass:{0:"fa fa-circle text-danger",1:"fa fa-circle text-success"},metadata:{domainValues:{0:"disattivo",1:"attivo"}},_setHtmlData:function(){var e=this,t=e.jQe(e.element_selector),a=e.metadata.domainValues,r=e.value?e.value:0;t.attr("title",e.app.translate(a[r])),e.jQe(e.icon_selector).removeClass(),e.jQe(e.icon_selector).addClass(e.iconClass[r])},getValue:function(){return this.value},_swap:function(){var e=this,t=Route.factory("set");t.values={modelName:e.modelName,field:e.key,value:e.value},e.app.waitStart(),t.params={id:e.modelData.id},Server.route(t,function(t){e.app.waitEnd(),e._callback(t)})},_callback:function(e){var t=this;return e.error?void t.app.errorDialog(e.msg):void(t.view&&t.app.renderView(t.view.keyId))}}),RenderSwapEdit=BaseSwap.extend({render:function(e){return this._setHtmlData(),e()},finalize:function(e){var t=this,a=t.jQe().find(t.element_selector);return a.click(function(){var e=t.value?t.value:0,a=Object.keys(t.metadata.domainValues).map(String),r=a.indexOf(""+e);r=(r+1)%2,t.value=a[r],t._setHtmlData(),t._swap()}),e()},template:function(){return'<button type="button" class="btn btn-default btn-xs" crud-render_element title="">                    <i crud-icon class=""></i>                </button>'}}),RenderSwapSearch=BaseSwap.extend({setValue:function(e){var t=this;t.jQe(t.control_selector).attr("value",e),t.value=e},render:function(e){var t=this;t._setHtmlData();var a=t.jQe().find(t.control_selector);a.attr("name","s_"+t.key+"[]"),a.attr("value",t.value);var a=t.jQe().find(t.operator_selector);return a.attr("name","s_"+t.key+"_operator"),a.attr("value",t.operator),e()},finalize:function(e){var t=this,a=t.jQe().find(t.element_selector);return a.click(function(){var e=t.value?t.value:0,a=Object.keys(t.metadata.domainValues).map(String),r=a.indexOf(""+e);r=(r+1)%2,t.setValue(a[r]),t._setHtmlData(),t.change()}),e()},template:function(){return'<input crud-render_control type="hidden" class="form-control" name="" value="">                <input crud-render_operator type="hidden" >                <button type="button" class="btn btn-default btn-xs" crud-render_element title="">                    <i crud-icon class=""></i>                </button>'}}),RenderSwapView=BaseSwap.extend({render:function(e){return this._setHtmlData(),e()},template:function(){return'<i crud-icon crud-render_element class=""></i>'}}),BaseCustom=Render.extend({render:function(e){var t=this;t.jQe(t.element_selector).html(t.value),e()},getValue:function(){return jQuery(this.container).html()},setValue:function(e){jQuery(this.container).html(e)}}),RenderCustomEdit=BaseCustom.extend({template:function(){return"<div crud-render_element crud-render_control></div>"}}),RenderCustomSearch=RenderCustomEdit.extend({}),RenderCustomView=RenderCustomEdit.extend({}),BaseDecimal=Render.extend({int_selector:"[crud-render_control_int]",dec_selector:"[crud-render_control_dec]",symbol_selector:"[crud-render_symbol]",digits:2,symbol:null,symbol_position:"left",separator:",",getValue:function(){var e=this;return"view"==e.mode?e.value:jQuery(e.container).find(e.control_selector).val()},_splitNumber:function(e){var t=this,a=e?parseFloat(e):parseFloat(t.value);if(isNaN(a))return t.value=0,["0",Array(t.digits).join("0")];var r=(a+"").split(".");return 2==r.length?(r[1]=a.toFixed(t.digits).split(".")[1],r[1].length>=t.digits?r[1]=r[1].substr(0,t.digits):r[1]=""+r[1]+Array(t.digits-r[1].length+1).join("0")):r=[a,Array(t.digits+1).join("0")],r},_showSymbol:function(){var e=this;e.symbol&&(e.jQe().find("[crud-render_symbol]").html(e.symbol),"left"===e.symbol_position?e.jQe().find(".symbol_left").removeClass("hide"):e.jQe().find(".symbol_right").removeClass("hide"))},setValue:function(e){var t=this,a=(t._splitNumber(),new String(e).split(".")),r=a[0],n=0;(a.length=2)&&(n=a[1]),t.jQe().find(t.int_selector).val(r),t.jQe().find(t.dec_selector).val(n)}}),RenderDecimalEdit=BaseDecimal.extend({render:function(e){var t=this,a=t._splitNumber();return t.jQe(t.control_selector).attr("name",t.key).attr("value",t.value),t.jQe(t.int_selector).attr("value",a[0]),t.jQe(t.dec_selector).attr("value",a[1]),t._showSymbol(),e()},finalize:function(e){var t=this;return t.jQe(t.int_selector+","+t.dec_selector).change(function(){var e=t.jQe(t.int_selector).val(),a=t.jQe(t.dec_selector).val();t.jQe(t.control_selector).attr("value",e+"."+a),t.change()}),e()},template:function(){return'<div class="input-group" crud-render_element>                    <span class="input-group-addon hide symbol_left" crud-render_symbol></span>                    <input class="form-control text-right" type="text" crud-render_control_int>                    <span class="input-group-addon">,</span>                    <input class="form-control text-right" type="text" crud-render_control_dec>                    <input type="hidden" crud-render_control="">                    <span class="input-group-addon hide symbol_right" crud-render_symbol></span>                </div>'}}),RenderDecimalSearch=RenderDecimalEdit.extend({render:function(e){var t=this,a=t._splitNumber();return t.jQe(t.control_selector).attr("name",t.key).attr("value",t.value),t.jQe(t.int_selector).attr("value",a[0]),t.jQe(t.dec_selector).attr("value",a[1]),el=t.jQe().find(t.operator_selector),el.attr("name","s_"+t.key+"_operator"),el.attr("value",t.operator),t._showSymbol(),e()},template:function(){return'<div class="input-group" crud-render_element>                    <span class="input-group-addon hide symbol_left" crud-render_symbol></span>                    <input class="form-control text-right" type="text" crud-render_control_int>                    <span class="input-group-addon">,</span>                    <input class="form-control text-right" type="text" crud-render_control_dec>                    <input type="hidden" crud-render_control="">                    <span class="input-group-addon hide symbol_right" crud-render_symbol></span>                    <input crud-render_operator type="hidden" >                </div>'}}),RenderDecimalView=BaseDecimal.extend({render:function(e){var t=this,a=t._splitNumber();return t.jQe().find(t.int_selector).html(a[0]+t.separator+a[1]),t._showSymbol(),e()},template:function(){return'<div crud-render_element class="text-right">                    <span class="hide symbol_left" crud-render_symbol></span>                    <span class="text-right" crud-render_control_int></span>                    <span class="hide symbol_right text-left" crud-render_symbol></span>                </div>'}}),BaseTexthtml=Render.extend({getValue:function(){var e=this;return jQuery(e.container).find(e.control_selector).val()}}),RenderTexthtmlEdit=BaseTexthtml.extend({height:200,pluginOptions:{},_pluginObject:null,resources:["editor.summernote/summernote.css","editor.summernote/summernote.js","editor.summernote/plugin/image-attribute/summernote-image-attributes.js","editor.summernote/plugin/specialchars/summernote-ext-specialchars.js","editor.summernote/plugin/cleaner/summernote-cleaner.js","jquery.validate/jquery.validate.js"],_createPluginObject:function(e){var t=this,a=jQuery(t.container).find("textarea.summernote");a.each(function(){var a=jQuery(this).attr("crud-summernote-lang")||"en-US",r=jQuery(this);t._pluginObject=r;var n={height:r.attr("crud-height")||t.height,lang:r.attr("crud-summernote-lang")||"en-US",toolbar:[["cleaner",["cleaner"]],["style",["style"]],["fontsize",["fontsize"]],["style",["bold","italic","underline","strikethrough","clear"]],["color",["color"]],["para",["ul","ol","paragraph","height"]],["table",["table"]],["media",["link","picture","video"]],["misc",["codeview","fullscreen","help","undo","redo","specialCharacter"]]],popover:{image:[["imagesize",["imageSize100","imageSize50","imageSize25"]],["float",["floatLeft","floatRight","floatNone"]],["custom",["imageAttributes","imageShape"]],["remove",["removeMedia"]]]},cleaner:{el:"textarea.summernote",notTime:2400,successClass:"alert alert-success",action:"button",icon:'<i class="fa fa-file-word-o"></i>'}},i=_.extend(n,t.pluginOptions),o=function(){r.summernote(i),e()};return"en-US"!=a?void EventManager.trigger("loadResource",{resource:"editor.summernote/lang/summernote-"+a+".js"},o):void o()})},getPluginObject:function(){return this._pluginObject},clear:function(){var e=this;e.getPluginObject().summernote("code","")},render:function(e){var t=this,a=t.jQe().find(t.control_selector);return a.attr("name",t.key),a.html(t.value),t._setHtmlAttributes(a),e()},finalize:function(e){var t=this;return t._createPluginObject(function(){jQuery.validator.setDefaults({ignore:":hidden:not(.summernote)"}),jQuery(t.container).find("textarea").on("summernote.change",function(e,a,r){jQuery(t.container).find("textarea").html(a)})}),e()},template:function(){return'<textarea crud-render_element crud-render_control class="summernote form-control" crud-summernote-lang="it-IT"></textarea>'},getValue:function(){var e=this;return e.jQe(e.control_selector).val()}}),RenderTexthtmlView=BaseTexthtml.extend({render:function(e){var t=this,a=t.jQe().find(t.element_selector);return a.html(t.value),e()},getValue:function(){var e=this;return e.value},template:function(){return"<div crud-render_element crud-render_control ></div>"}});DateSelectCommon=Render.extend({year_selector:"[crud-render_year]",month_selector:"[crud-render_month]",day_selector:"[crud-render_day]",picker_selector:"[crud-render_picker]",h24:!0,operator:null,time:!1,dateFormat:"YYYY-MM-DD",timeFormat:"H:i:s",resources:["moment-with-locales.min.js"],selectProps:{active:["day","month","year"],startYear:(new Date).getFullYear()-3,endYear:(new Date).getFullYear()+3},getFormat:function(){var e=this;return e.dateFormat+(e.time?" "+e.timeFormat:"")},getDisplayFormat:function(){var e=this;return e.displayDateFormat+(e.time?" "+e.displayTimeFormat:"")},_setDateControls:function(){var e=this,t=e.selectProps.active?e.selectProps.active:[],a=(parseInt((new Date).getFullYear()),e.selectProps.startYear),r=e.selectProps.endYear,n=e.jQe().find(e.day_selector),i=jQuery("<option>").attr({value:""});i.html(e.app.translate("app.giorno")),n.append(i);for(var o=1;o<=31;o++){o=Utility.padDate(o,2);var i=jQuery("<option>").attr({value:o});i.html(o),n.append(i)}jQuery.inArray("day",t)<0&&(e.jQe().find("[crud-render_day_container]").addClass("hide"),n.addClass("hide"));var u=e.jQe().find(e.month_selector),i=jQuery("<option>").attr({value:""});i.html(e.app.translate("app.mese")),u.append(i);for(var o=1;o<=12;o++){o=Utility.padDate(o,2);var i=jQuery("<option>").attr({value:o});i.html(o),u.append(i)}jQuery.inArray("month",t)<0&&(e.jQe().find("[crud-render_month_container]").addClass("hide"),n.addClass("hide"));var l=e.jQe().find(e.year_selector),i=jQuery("<option>").attr({value:""});i.html(e.app.translate("app.anno")),l.append(i);for(var o=r;o>a;o--){var i=jQuery("<option>").attr({value:o});i.html(o),l.append(i)}jQuery.inArray("year",t)<0&&(e.jQe().find("[crud-render_year_container]").addClass("hide"),n.addClass("hide"))},_changeDate:function(){var e=this,t=e.active?e.active:["day","month","year"],a="",r=jQuery(e.container).find(e.year_selector),n=jQuery(e.container).find(e.month_selector),i=jQuery(e.container).find(e.day_selector),o="",u=28;"04"==n.val()||"06"==n.val()||"09"==n.val()||"11"==n.val()?u=30:"02"!=n.val()?u=31:r.val()%4!=0&&r.val()%100!=0||(u=29);for(var l=1;l<=u;l++){var d=Utility.padDate(l,2);i.val()==d&&(o=' selected="selected" '),a+='<option value="'+d+'"'+o+">"+d+"</option>",o=""}var s=i.val();i.empty(),i.append(a),s<=u&&i.val(s);var c=jQuery(e.container).find(e.control_selector),p=c.val().split(" "),m="";p.length>1&&(m=p[1]);var f="",v=jQuery.inArray("year",t)<0?"0000":r.val(),h=jQuery.inArray("month",t)<0?"00":n.val(),g=jQuery.inArray("day",t)<0?"00":i.val();f=""==v||""==h||""==g?"":v+"-"+h+"-"+g,""!=m&&(f+=" "+m),c.attr("value",f).val(f),e.change()},setValue:function(e){var t=this;if(!e)return t.jQe(t.control_selector).val(""),t.jQe(t.year_selector).val(""),t.jQe(t.month_selector).val(""),void t.jQe(t.day_selector).val("");var a=e;e instanceof moment||(a=new moment(e)),t.jQe(t.control_selector).val(a.format(t.dateFormat)),t.jQe(t.year_selector).val(a.format("YYYY")).attr("selected","selected"),t.jQe(t.month_selector).val(a.format("MM")).attr("selected","selected"),t.jQe(t.day_selector).val(a.format("DD")).attr("selected","selected")},getValue:function(){var e=this;return jQuery(e.container).find(e.control_selector).val()},clear:function(){this.setValue("")}}),RenderDateSelectEdit=DateSelectCommon.extend({render:function(e){var t=this,a=t.jQe().find(t.control_selector);return a.attr("name",t.key).attr("value",t.value),t._setDateControls(),e()},finalize:function(e){var t=this;return t.jQe().find(t.year_selector+","+t.month_selector+","+t.day_selector).change(function(){t._changeDate();jQuery(t.year_selector).val()+"-"+jQuery(t.month_selector).val()+"-"+jQuery(t.day_selector).val()}),t.setValue(t.value),e()},template:function(){return'<div crud-render_element  class="input-group">                    <input crud-render_control="" type="hidden" />                    <div class="input-group-btn" crud-render_day_container>                        <select class="form-control" crud-render_day>                                                </select>                    </div>                    <div class="input-group-btn" crud-render_month_container>                        <select class="form-control" crud-render_month>                                                </select>                    </div>                    <div class="input-group-btn" crud-render_year_container>                        <select class="form-control" crud-render_year>                                                </select>                    </div>                </div>'}}),RenderDateSelectSearch=RenderDateSelectEdit.extend({render:function(e){var t=this,a=t.jQe().find(t.control_selector);return a.attr("name","s_"+t.key+"[]").attr("value",t.value),a=t.jQe().find(t.operator_selector),a.attr("name","s_"+t.key+"_operator"),a.attr("value",t.operator),t._setDateControls(),e()},template:function(){return'<div crud-render_element  class="input-group">                    <input crud-render_control="" type="hidden" />                    <div class="input-group-btn" crud-render_day_container>                        <select class="form-control" crud-render_day>                                                </select>                    </div>                    <div class="input-group-btn" crud-render_month_container>                        <select class="form-control" crud-render_month>                                                </select>                    </div>                    <div class="input-group-btn" crud-render_year_container>                        <select class="form-control" crud-render_year>                                                </select>                    </div>                    <input crud-render_operator type="hidden" >                </div>';
}}),RenderDateSelectView=DateSelectCommon.extend({dateFormat:"YYYY-MM-DD",displayDateFormat:"DD/MM/YYYY",timeFormat:"HH:mm:ss",displayTimeFormat:"HH:mm:ss",invalidDateString:"",time:!1,finalize:function(e){var t=this;return t.setValue(t.value),e()},_toDate:function(e){var t=this,a=moment(e,t.getFormat());return a.locale(t.app.getLocale()),a.isValid()?a:(this.app.log.warn("["+e+"] Data non valida "),null)},getValue:function(){var e=this;return e.value},setValue:function(e){var t=this,a=t._toDate(e),r=t.jQe().find(t.element_selector);a?r.html(a.format(t.getDisplayFormat())):r.html(t.invalidDateString),t.value=e},template:function(){return"<span crud-render_element></span>"}});var TraitDatePicker={picker_selector:"[crud-render_picker]",h24:!0,type:"date",operator:null,time:!1,dateFormat:"YYYY-MM-DD",displayDateFormat:"DD/MM/YYYY",timeFormat:"HH:mm:ss",displayTimeFormat:"HH:mm:ss",setValue:function(e){var t=this,a=t.jQe().find(t.picker_selector).data("daterangepicker");if(!e)return t.jQe().find(t.picker_selector).val(""),void t.jQe().find(t.control_selector).val("");var r=moment(e,t.getFormat());return r.isValid()?(t.jQe().find(t.control_selector).val(r.format(t.getFormat())),t.jQe().find(t.picker_selector).val(r.format(t.getDisplayFormat())),a.startDate=r,a.endDate=r,a.startDate.format(t.getDisplayFormat()),void a.endDate.format(t.getDisplayFormat())):(t.app.log.warn("["+e+"] Data non valida "),t.jQe().find(t.control_selector).val(""),void t.jQe().find(t.picker_selector).val(""))},getValue:function(){var e=this;return"view"==e.mode?e.value:jQuery(e.container).find(e.control_selector).val()},getFormat:function(){var e=this;return e.dateFormat+(e.time?" "+e.timeFormat:"")},getDisplayFormat:function(){var e=this;return e.displayDateFormat+(e.time?" "+e.displayTimeFormat:"")},clear:function(){this.setValue(null)},_createPluginObject:function(e){var t=this,a=new moment(t.value);return a.isValid()||(a=new moment),jQuery(t.container).find(t.picker_selector).daterangepicker({singleDatePicker:!0,showDropdowns:!0,timePicker:t.time,timePicker24Hour:t.h24,startDate:a,locale:{format:t.getFormat(),displayFormat:t.getDisplayFormat()},autoUpdateInput:!0,cancelClass:"hide",autoclose:!0},function(e,t,a){moment().diff(e,"years")}),t.jQe().find(t.picker_selector).on("apply.daterangepicker",function(e,a){t.app.log.debug("apply.daterangepicker",e,a),t.jQe().find(t.control_selector).val(a.startDate.format(t.getFormat()));var r=t.jQe().find(t.picker_selector);r.val(a.startDate.format(t.getDisplayFormat()))}),t.jQe().find(t.picker_selector).on("hide.daterangepicker",function(e,a){t.jQe().find(t.picker_selector).val(a.startDate.format(t.getDisplayFormat()))}),e()}};RenderDatePickerEdit=Render.extend(TraitDatePicker),RenderDatePickerEdit=RenderDatePickerEdit.extend({resources:["bootstrap-daterangepicker/daterangepicker.css","moment-with-locales.min.js","bootstrap-daterangepicker/daterangepicker.js"],render:function(e){var t=this,a=t.jQe().find(t.control_selector);return a.attr("name",t.key).attr("value",t.value),e()},finalize:function(e){var t=this;t._createPluginObject(function(){var a=t.value?new moment(t.value):new moment;t.app.log.debug("currentDate",a),t.jQe().find("[crud-clear]").click(function(){t.setValue(null)}),t.setValue(t.value),e()})},getDaterangepicker:function(){var e=this;return e.jQe().find(e.picker_selector).data("daterangepicker")},template:function(){return'<div crud-render_element>                <input crud-render_control="" type="hidden" />                <div class="input-group">                    <input crud-render_picker class="form-control text-right" autocomplete="off" />                    <a crud-clear class="input-group-addon" href="javascript:void(0)"><span ><i class="fa fa-times"></i></span></a>                </div>            </div>'}}),RenderDatePickerSearch=RenderDatePickerEdit.extend({render:function(e){var t=this,a=t.jQe().find(t.control_selector);a.attr("name","s_"+t.key+"[]").attr("value",t.value),a=t.jQe().find(t.operator_selector),a.attr("name","s_"+t.key+"_operator"),a.attr("value",t.operator),e()},template:function(){return'<div crud-render_element>                <input crud-render_control="" type="hidden" />                <input crud-render_operator type="hidden" >                <div class="input-group">                    <input crud-render_picker class="form-control text-right" autocomplete="off" />                    <a crud-clear class="input-group-addon" href="javascript:void(0)"><span ><i class="fa fa-times"></i></span></a>                </div>            </div>'}}),RenderDatePickerView=Render.extend(TraitDatePicker),RenderDatePickerView=RenderDatePickerView.extend({invalidDateString:"",resources:["moment-with-locales.min.js"],finalize:function(e){var t=this;return t.setValue(t.value),e()},_toDate:function(e){var t=this,a=moment(e,t.getFormat());return a.isValid()?a:(this.app.log.warn("["+e+"] Data non valida "),null)},getValue:function(){var e=this;return e.value},setValue:function(e){var t=this,a=t._toDate(e),r=t.jQe().find(t.element_selector);a?r.html(a.format(t.getDisplayFormat())):r.html(t.invalidDateString),t.value=e},template:function(){return"<span crud-render_element></span>"}});var TraitDateFormatted={h24:!0,type:"date",operator:null,time:!1,dateFormat:"YYYY-MM-DD",timeFormat:"hh:mm:ss",date_selector:"[crud-date_formatted]",time_selector:"[crud-time_formatted]",_setDateControls:function(){var e=this;e.setValue(e.value)},getFormat:function(){var e=this;return e.dateFormat},getTimeFormat:function(){var e=this;return e.timeFormat},setValue:function(e){var t=this;if(!e)return t.jQe().find(t.control_selector).val(""),t.jQe().find(t.date_selector).val(""),void t.jQe().find(t.time_selector).val("");var a=new moment(e,t.getFormat());if(!a.isValid())throw"["+e+"] Data non valida ";t.time?t.jQe().find(t.control_selector).val(a.format(t.getFormat()+" "+t.getTimeFormat())):t.jQe().find(t.control_selector).val(a.format(t.getFormat())),t.jQe().find(t.date_selector).val(a.format(t.getFormat())),t.time&&t.jQe().find(t.time_selector).val(a.format(t.getTimeFormat()))},getValue:function(){var e=this;return jQuery(e.container).find(e.control_selector).val()},clear:function(){this.setValue("")}},RenderDateFormattedEdit=Render.extend(TraitDateFormatted),RenderDateFormattedEdit=RenderDateFormattedEdit.extend({resources:["moment-with-locales.min.js"],render:function(e){var t=this,a=t.jQe().find(t.control_selector);a.attr("name",t.key).attr("value",t.value),t.time&&jQuery(t.container).find(t.time_selector).attr("type","time").removeClass("hide"),e()},finalize:function(e){var t=this;jQuery(t.container).find(t.date_selector+","+t.time_selector).change(function(){var e=jQuery(t.container).find(t.date_selector).val()+" "+jQuery(t.container).find(t.time_selector).val();t.jQe(t.control_selector).val(e)}),t._setDateControls(),e()},template:function(){return'<div class="clearfix" crud-render_element>                    <input crud-render_control="" type="hidden" />                    <div class="col col-xs-6">                        <input crud-date_formatted class="form-control" type="date" />                    </div>                    <div class="col col-xs-6">                        <input crud-time_formatted class="form-control hide" type="time"/>                    </div>                </div>'}}),RenderDateFormattedSearch=RenderDateFormattedEdit.extend({render:function(e){var t=this,a=jQuery(t.container).find(t.control_selector);a.attr("name","s_"+t.key+"[]").attr("value",t.value),a=t.jQe().find(t.operator_selector),a.attr("name","s_"+t.key+"_operator"),a.attr("value",t.operator),t.time&&t.jQe().find(t.time_selector).attr("type","time").removeClass("hide"),e()},template:function(){return'<div class="clearfix" crud-render_element>                <input crud-render_control="" type="hidden" />                <div class="col col-xs-6">                    <input crud-date_formatted class="form-control" type="date" />                </div>                <div class="col col-xs-6">                    <input crud-time_formatted class="form-control hide" type="time"/>                </div>                <input crud-render_operator type="hidden" >            </div>'}}),RenderDateFormattedView=RenderDateSelectView.extend({}),TraitBetweenDateSelect={rStart:null,rEnd:null,endKey:null,endValue:null,init:function(e,t){this._super(e,t),this.endKey||(this.endKey="end_"+this.key)},checkDate:function(e){var t=this,a=new moment(t.rStart.getValue()),r=new moment(t.rEnd.getValue());"end"==e&&a.diff(r)>0&&t.rEnd.setValue(a),"start"==e&&r.diff(a)<0&&t.rStart.setValue(r)},setValue:function(e,t){var a=this,r=jQuery(a.container),n=r.find('input[name="'+a.key+'_picker"]');n.datepicker("setDate",e),n=r.find('input[name="'+a.endKey+'_picker"]'),n.datepicker("setDate",t)},getValue:function(){var e=this,t=jQuery(e.container).find(e.control_selector).val(),a=jQuery(e.container).find(e.control_end_selector).val();return[t,a]},_createRenders:function(e){var t=this;t.rStart=Render.factory(t.key,{mode:e,type:"date_select",value:t.value,container:t.jQe("[crud-render_start]"),change:function(){t.checkDate("start")}}),t.rEnd=Render.factory(t.endKey,{mode:e,type:"date_select",value:t.endValue,container:t.jQe("[crud-render_end]"),change:function(){t.checkDate("end")}})}},RenderBetweenDateSelectEdit=Render.extend(TraitBetweenDateSelect);RenderBetweenDateSelectEdit=RenderBetweenDateSelectEdit.extend({render:function(e){var t=this;return t._createRenders("edit"),e()},finalize:function(e){var t=this;return t.rStart.draw(),t.rEnd.draw(),e()},template:function(){return'<div>                    <div class="col col-xs-6">                        <div crud-label="app.dal"></div>                        <div crud-render_start></div>                    </div>                    <div class="col col-xs-6" >                        <div crud-label="app.al"></div>                        <div crud-render_end></div>                    </div>                </div>'}});var RenderBetweenDateSelectSearch=RenderBetweenDateSelectEdit.extend({render:function(e){var t=this;return t._createRenders("search"),t.rStart.operator=t.operator,e()},finalize:function(e){var t=this;return t.rStart.draw(),t.rEnd.draw(function(){t.rEnd.jQe(t.rEnd.operator_selector).remove()}),e()}}),RenderBetweenDateSelectView=RenderBetweenDateSelectEdit.extend({render:function(e){this._createRenders("view"),e()},template:function(){return'<div>                    <div class="col col-xs-6">                        <span crud-label="app.dal">Dal</span>                        <span crud-render_start></span>                    </div>                    <div class="col col-xs-6" >                        <span crud-label="app.al">Al</span>                        <span crud-render_end></span>                    </div>                </div>'}}),RenderBetweenDatePicker=Render.extend({resources:["bootstrap-daterangepicker/daterangepicker.css","moment-with-locales.min.js","bootstrap-daterangepicker/daterangepicker.js"],picker_selector:"[crud-render_picker]",picker_end_selector:"[crud-render_picker_end]",control_selector:"[crud-render_control]",control_end_selector:"[crud-render_control_end]",control_operator:"[crud-render_operator]",type:"between_date_picker",classData:"between_date_picker",classTemplate:"between_date_picker",end_key:null,end_value:null,init:function(e,t){this._super(e,t),this.end_key||(this.end_key="end_"+this.key)},_validateEdit:function(){var e=this;if(!e.end_key)throw"end_key not definited!"},_renderSearch:function(){var e=this,t=jQuery(e.container).find(e.control_selector);t.attr("name","s_"+e.key+"[]").attr("value",e.value),t=jQuery(e.container).find(e.control_end_selector),t.attr("name","s_"+e.end_key+"[]").attr("value",e.end_value),t=jQuery(e.container).find(e.operator_selector),t.attr("name","s_"+e.key+"_operator"),t.attr("value",e.operator)},setValue:function(e,t){var a=this,r=jQuery(a.container),n=r.find('input[name="'+a.key+'_picker"]');n.datepicker("setDate",e);var n=r.find('input[name="'+a.end_key+'_picker"]');n.datepicker("setDate",t)},getValue:function(){var e=this,t=jQuery(e.container).find(e.control_selector).val(),a=jQuery(e.container).find(e.control_end_selector).val();return[t,a]},_createPluginObject:function(e){var t=this;jQuery(t.container).find(t.picker_selector).daterangepicker({showDropdowns:!0,timePicker:t.time,locale:{format:"DD/MM/YYYY"+(t.time?" HH:mm:ss":"")}},function(e,t,a){START=e;moment().diff(e,"years")}),e()}}),RenderBetweenDatePickerEdit=RenderBetweenDatePicker.extend({render:function(e){var t=this,a=jQuery(t.container).find(t.control_selector);return a.attr("name",t.key).attr("value",t.value),a=jQuery(t.container).find(t.control_end_selector),a.attr("name",t.end_key).attr("value",t.end_value),e()},finalize:function(e){var t=this;t._createPluginObject(function(){var a=new Date;return t.value&&(a=Utility.jsDate(t.value)),t.app.log.debug("currentDate",a),jQuery(t.container).find(t.picker_selector).on("apply.daterangepicker",function(e,a){var r="YYYY-MM-DD"+(t.time?" HH:mm:ss":"");jQuery(t.container).find(t.control_selector).val(a.startDate.format(r)),jQuery(t.container).find(t.control_end_selector).val(a.endDate.format(r))}),jQuery(t.container).find(t.picker_selector).data("daterangepicker").setStartDate(a),e()})},template:function(){return'<div crud-render_element>                    <input crud-render_control="" type="hidden" />                    <input crud-render_control_end="" type="hidden" />                     <div class="input-group-btn">                        <input crud-render_picker class="form-control text-right" autocomplete="off"/>                    </div>                </div>'}}),RenderBetweenDatePickerSearch=RenderBetweenDatePickerEdit.extend({render:function(e){var t=this,a=jQuery(t.container).find(t.control_selector);return a.attr("name",t.key).attr("value",t.value),a=jQuery(t.container).find(t.control_end_selector),a.attr("name",t.end_key).attr("value",t.end_value),a=jQuery(t.container).find(t.operator_selector),a.attr("name","s_"+t.key+"_operator"),a.attr("value",t.operator),e()},_template:function(){return'<div crud-render_element>                <input crud-render_control="" type="hidden" />                <input crud-render_control_end="" type="hidden" />                <input crud-render_control_operator="" type="hidden" />                 <div class="input-group-btn">                    <input crud-render_picker class="form-control text-right" autocomplete="off"/>                </div>            </div>'}}),RenderBetweenDatePickerView=RenderBetweenDateSelectView.extend({}),RenderBetweenDateFormatted=Render.extend({rStart:null,rEnd:null,year_end_selector:"[crud-render_year_end]",month_end_selector:"[crud-render_month_end]",day_end_selector:"[crud-render_day_end]",picker_selector:"[crud-render_picker]",picker_end_selector:"[crud-render_picker_end]",control_selector:"[crud-render_control]",control_end_selector:"[crud-render_control_end]",control_operator:"[crud-render_operator]",type:"between_date",classData:"between_date",classTemplate:"between_date",end_key:null,end_value:null,selectEndProps:{active:["day","month","year"],startYear:(new Date).getFullYear()-3,endYear:(new Date).getFullYear()+3},init:function(e,t){this._super(e,t),this.end_key||(this.end_key="end_"+this.key)},_validateEdit:function(){var e=this;if(!e.end_key)throw"end_key not definited!"},_setPickerDateControls:function(e){},_setDateControls:function(e){},setValue:function(e,t){var a=this,r=jQuery(a.container),n=r.find('input[name="'+a.key+'_picker"]');n.datepicker("setDate",e),n=r.find('input[name="'+a.end_key+'_picker"]'),n.datepicker("setDate",t)},getValue:function(){var e=this,t=jQuery(e.container).find(e.control_selector).val(),a=jQuery(e.container).find(e.control_end_selector).val();return[t,a]}}),RenderBetweenDateFormattedEdit=RenderBetweenDateFormatted.extend({render:function(e){var t=this;return t.rStart=Render.factory(t.key,{mode:"edit",type:"date_formatted",value:t.value,container:jQuery(t.container).find("[crud-render_start]")}),t.rEnd=Render.factory(t.end_key,{mode:"edit",type:"date_formatted",value:t.end_value,container:jQuery(t.container).find("[crud-render_end]")}),e()},finalize:function(e){var t=this;return t.rStart.draw(),t.rEnd.draw(),e()},template:function(){return'<div>                    <div class="col col-xs-6">                        <div crud-label_dal></div>                        <div crud-render_start></div>                    </div>                    <div class="col col-xs-6" >                        <div crud-label_al></div>                        <div crud-render_end></div>                    </div>                </div>'}}),RenderBetweenDateFormattedSearch=RenderBetweenDateFormattedEdit.extend({}),RenderBetweenDateFormattedView=RenderBetweenDateSelectView.extend({resources:["moment-with-locales.min.js"]}),TraitUpload={_setUploadAjaxForm:function(e){var t=this;e.jQe().find(".btok").addClass("disabled");var a=Route.factory(t.routeName,{});e.jQe().find('form[name="formupload"]').attr("action",Server.getUrl(a.getUrl())),e.jQe().find('form[name="formupload"]').ajaxForm({beforeSubmit:function(a,r,n){n.dataType="json",t._hideError(e),t.app.waitStart()},error:function(a,r,n){t.app.waitEnd(),t._showError(e,"Upload error "+a+" "+r+" "+n),e.jQe().find('[crud-button="ok"]').addClass("disabled")},success:function(a){if(t.app.waitEnd(),a.error){var r=null;try{var n=JSON.parse(a.msg);r="";for(u in n)r+="<div>"+n[u]+"</div>"}catch(i){r=a.msg}return t._showError(e,r),void e.jQe().find('[crud-button="ok"]').addClass("disabled")}var o=Server.getUrl("/imagecache/small/"+a.result.filename);e.jQe().find("[crud-icon]").attr("src",o);for(var u in a.result)e.jQe().find('form[name="formupload"]').find('input[name="'+u+'"]').attr("value",a.result[u]);e.jQe().find('[crud-button="ok"]').removeClass("disabled"),t.afterUpload(a)}}),e.jQe().find('input[name="file"]').autoUpload(function(){e.jQe().find('form[name="formupload"]').submit()})},_createDialogView:function(e){var t=this;t.vkey&&(t.app.removeView(t.vkey),e.jQe().find("[crud-view_container]").html(""));var a=[];for(var r in t.uploadFields)a.push(t.uploadFields[r]);for(var r in t.fields)a.push(t.fields[r]);var n=Conf.extend(window[t.uploadConfView],{container:e.jQe().find("[crud-view_container]"),actions:[],modelName:t.modelName,routeName:null,fields:a,data:{value:{modelName:t.modelName,type:t.metadata.relationName},metadata:{}},autorender:!1});t.vkey=t.app.addView(n),t._setUploadFieldsType(),t._setFieldsType(),t.app.renderView(t.vkey)},dialogTemplate:function(){return'<div class="modal-content">                    <div class="modal-header">                        <button crud-button="cancel" type="button" class="close" data-dismiss="modal"                            aria-hidden="true">&times;</button>                        <h4 crud-label="modal.title" class="modal-title"></h4>                    </div>                    <div class="modal-body">                        <div crud-error_container class="alert alert-danger hide">                        </div>'+this.dialogContentTemplate()+'</div>                    <div class="modal-footer">                        <button crud-button="cancel" type="button" class="btn btn-primary btcancel"                            data-dismiss="modal">Annulla</button>                        <button crud-button="ok" type="button" class="btn btn-primary btok"                            data-dismiss="modal">Ok</button>                    </div>                </div>'},_showError:function(e,t){e.jQe().find("[crud-error_container]").removeClass("hide").html(t)},_hideError:function(e){e.jQe().find("[crud-error_container]").addClass("hide").html("")},addUpload:function(e){var t=this,a=Component.parseHtml(t.dialogTemplate()),r=app.customDialog(a.html(),{ok:function(e){t.ok(e)},cancel:function(e){t.cancel(e)}});t._createDialogView(r),r.jQe().find(".modal-body").find("[crud-preview]").html(t.previewItemTemplate()),t._setUploadAjaxForm(r)}},RenderUploadImage=Render.extend({modelName:null,icons:{".jpg":"fa fa-picture-o"},icon_selector:"[crud-icon_img]",uploaded_json:{},buttonLabel:"upload",routeName:"viewimage",imageTemplate:"icon",routeUploadName:"upload",metadata:{path_key:null},resources:["jquery.form.js"],imageUrl:function(e){var t=this,a=Route.factory(t.routeName,{values:{filename:e,template:t.imageTemplate}});return t.metadata.path_key&&(a.params.path_key=t.metadata.path_key),a.getUrl()+(_.keys(a.params).length>0?"?"+jQuery.param(a.getParams()):"")},upload:function(){var e=this,t={path_key:e.metadata.path_key,type:e.uploadType,icon:"",filename:"default.png"},a=jQuery.getTemplate(e.dialogTemplate(),t),r=app.customDialog(a,{ok:function(t){e.ok(t)},cancel:function(t){e.cancel(t)}}),n=Route.factory(e.routeUploadName,{}),i=r.id;jQuery(i).find("form").attr("action",Server.getUrl(n.getUrl())),jQuery(i+" .btok").addClass("disabled"),jQuery(i+" form").ajaxForm({beforeSubmit:function(t,a,r){r.dataType="json",e.app.waitStart()},error:function(t,a,r){e.app.waitEnd(),e._showError("Upload error "+t+" "+a+" "+r),jQuery(i+" .btok").addClass("disabled")},success:function(t){return e.app.waitEnd(),t.error?(e._showError(t.msg),void jQuery(i+" .btok").addClass("disabled")):(jQuery(i+" [crud-preview]").attr("src",e.imageUrl(t.result.filename)).removeClass("hide"),e.uploaded_json=t.result,jQuery(i+' [crud-button="ok"]').removeClass("disabled"),void e.afterUpload(t))}}),jQuery(i+' input[name="file"]').autoUpload(function(){jQuery(i+" form").submit()})},ok:function(){var e=this;e.value=e.uploaded_json.filename,e._renderTemplateData(),jQuery(e.container).find(e.control_selector).attr("value",e.uploaded_json.filename),e.finalize(function(){})},cancel:function(){},_bindDeleteEvents:function(){var e=this;jQuery(e.container).find("[crud-button_delete]").unbind("click"),jQuery(e.container).find("[crud-button_delete]").click(function(){var t=jQuery(this).closest("[crud-"+e.uploadType+"_item]").index();e.deleteItem(t)})},_showError:function(e){var t=this;jQuery(t._getDialogId()+" .alert").removeClass("hide").html(e)},afterUpload:function(e){},_renderTemplateData:function(){var e=this;if(e.value){var t={link:e.imageUrl(e.value),filename:e.value,uploadType:e.uploadType};jQuery.renderTemplate(e.jQe(),e.jQe(),t)}},dialogTemplate:function(){return'<div class="modal-content">                <div class="modal-header">                    <button crud-button="cancel" type="button" class="close" data-dismiss="modal"                        aria-hidden="true">&times;</button>                    <h4 class="modal-title" crud-label="app.upload_image"></h4>                </div>                <div class="modal-body">'+this.dialogContentTemplate()+'</div>                <div class="modal-footer">                    <button crud-button="cancel" type="button" class="btn btn-primary btcancel"                        data-dismiss="modal">Annulla</button>                    <button crud-button="ok" type="button" class="btn btn-primary btok"                        data-dismiss="modal">Ok</button>                </div>            </div>'},dialogContentTemplate:function(){return'<div crud-field="data" crud-self>                    <div id="loader_foto"></div>                    <form enctype="multipart/form-data" method="POST"                          action="" encoding="multipart/form-data"                          name="ormupload">                        <input type="hidden" value="" name="path_key" crud-field="path_key" />                        <input type="hidden" value="" name="type" crud-field="type" />                        <input type="hidden" value="" name="filename" />                        <div class="alert alert-danger hide">                        </div>                        <div crud-custom_html>                        </div>                        <table crud-fields_container class="table">                            <tr>                                <td>                                    <div class="btn-group">                                        <input class="btn btn-default" type="file" name="file">                                    </div>                                </td>                                <td>                                    <div >                                        <img crud-preview src="" class="upload_foto hide">                                    </div>                                </td>                            </tr>                            <tr>                                 <td colspan="2">                                    <div><span crud-label="app.accepted-extensions"></span>:</div>                                    <div  crud-label="app.extensions-foto"></div>                                    <div>Max <span crud-label="app.upload-max-filesize"></span> </div>                                </td>                            </tr>                        </table>                    </form>            </div>'}}),RenderUploadImageEdit=RenderUploadImage.extend({getValue:function(){var e=this;return e.jQe(e.control_selector).val()},render:function(e){var t=this;t._renderTemplateData(),t.jQe().find(t.control_selector).val(t.value).attr("name",t.key),e()},finalize:function(e){var t=this;jQuery(t.container).find("[crud-button_upload]").html(t.buttonLabel),jQuery(t.container).find("[crud-button_upload]").click(function(){t.upload()}),e()},template:function(){return'<div>                    <input  crud-render_control type="hidden">                    <!--<a crud-remove="uploadType==\'foto\'" crud-href="link" crud-attrs="{title:filename}" crud-remove="!filename" target="_blank">-->                        <!--<i crud-class="icon"></i>-->                    <!--</a>-->                    <img class="upload_foto"  crud-field="link" src="" />                    <!--<span crud-filename></span>-->                    <button class="btn btn-default btn-xs" crud-button_upload type="button">Upload</button>                </div>'}}),RenderUploadImageView=RenderUploadImage.extend({getValue:function(){return this.value},render:function(e){var t=this;t.value&&t.jQe().find("[crud-render_element]").html('<img class="upload_foto" src="'+t.imageUrl(t.value)+'" />'),e()},template:function(){return'<div crud-render_element>                    <ul class="list-unstyled" crud-render_list >                        <!--  -- contenitore lista fotos -- -->                    </ul>                </div>'}}),BaseUploadAttachment=Render.extend({modelName:null,iconSize:"default",icons:{"default":{"default":"fa fa-2x fa-file-o",xls:"fa fa-2x fa-file-excel-o",zip:"fa fa-2x fa-file-archive-o",mp3:"fa fa-2x fa-audio-o",jpg:"fa fa-2x fa-image-o",pdf:"fa fa-2x fa-file-pdf-o",txt:"fa fa-2x fa-file-text-o",csv:"fa fa-2x fa-file-o"},big:{"default":"fa fa-3x fa-file-o",xls:"fa fa-3x fa-file-excel-o",zip:"fa fa-3x fa-file-archive-o",mp3:"fa fa-3x fa-audio-o",jpg:"fa fa-3x fa-image-o",pdf:"fa fa-3x fa-file-pdf-o",txt:"fa fa-3x fa-file-text-o",csv:"fa fa-3x fa-file-o"},small:{"default":"fa fa-file-o",xls:"fa fa-file-excel-o",zip:"fa fa-file-archive-o",mp3:"fa fa-audio-o",jpg:"fa fa-image-o",pdf:"fa fa-file-pdf-o",txt:"fa fa-file-text-o",csv:"fa fa-file-o"}},icon_selector:"[crud-icon_img]",uploaded_json:{},metadata:{path_key:null},buttonLabel:"upload",imagecacheTemplate:"icon",routeUploadName:"upload",routeDownloadName:"download",resources:["jquery.form.js"],downloadUrl:function(){var e=this,t=Route.factory(e.routeDownloadName,{values:{filename:e.value}});return e.metadata.path_key&&(t.params.path_key=e.metadata.path_key),t.getUrl()+(_.keys(t.params).length>0?"?"+jQuery.param(t.getParams()):"")},upload:function(){var e=this,t={path_key:e.metadata.path_key,type:e.uploadType,icon:"",filename:"default.png"},a=jQuery.getTemplate(e.dialogTemplate(),t),r=app.customDialog(a,{ok:function(t){e.ok(t)},cancel:function(t){e.cancel(t)}}),n=Route.factory(e.routeUploadName,{}),i=r.id;jQuery(i).find("form").attr("action",Server.getUrl(n.getUrl())),jQuery(i+" .btok").addClass("disabled"),jQuery(i+" form").ajaxForm({beforeSubmit:function(t,a,r){r.dataType="json",e.app.waitStart()},error:function(t,a,r){e.app.waitEnd(),e._showError("Upload error "+t+" "+a+" "+r),jQuery(i+" .btok").addClass("disabled")},success:function(t){return e.app.waitEnd(),t.error?(e._showError(t.msg),void jQuery(i+" .btok").addClass("disabled")):(jQuery(i+" [crud-icon]").addClass(e.icons[e.iconSize][t.result.ext]),e.uploaded_json=t.result,jQuery(i+" .btok").removeClass("disabled"),void e.afterUpload(t))}}),jQuery(i+' input[name="file"]').autoUpload(function(){jQuery(i+" form").submit()})},ok:function(){var e=this;e.value=e.uploaded_json.filename,e._renderTemplateData(),jQuery(e.container).find(e.control_selector).attr("value",e.uploaded_json.filename),e.finalize(function(){})},cancel:function(){},_bindDeleteEvents:function(){var e=this;jQuery(e.container).find("[crud-button_delete]").unbind("click"),jQuery(e.container).find("[crud-button_delete]").click(function(){var t=jQuery(this).closest("[crud-"+e.uploadType+"_item]").index();e.deleteItem(t)})},_showError:function(e){var t=this;jQuery(t._getDialogId()+" .alert").removeClass("hide").html(e)},afterUpload:function(e){},_getIcon:function(){var e=this,t=e.value.split(".").pop();return e.icons[e.iconSize][t]?e.icons[e.iconSize][t]:e.icons[e.iconSize]["default"]},_renderTemplateData:function(){var e=this;if(e.value){var t={link:e.downloadUrl(),filename:e.value,uploadType:e.uploadType,icon:e._getIcon()};jQuery.renderTemplate(e.container,e.container,t)}},dialogTemplate:function(){return'<div class="modal-content">                    <div class="modal-header">                        <button crud-button="cancel" type="button" class="close" data-dismiss="modal"                            aria-hidden="true">&times;</button>                        <h4 class="modal-title" crud-label="app.upload_attachment"></h4>                    </div>                    <div class="modal-body">'+this.dialogContentTemplate()+'</div>                    <div class="modal-footer">                        <button crud-button="cancel" type="button" class="btn btn-primary btcancel"                            data-dismiss="modal">Annulla</button>                        <button crud-button="ok" type="button" class="btn btn-primary btok"                            data-dismiss="modal">Ok</button>                    </div>                </div>'},dialogContentTemplate:function(){return'<div crud-field="data" crud-self>                    <div id="loader_foto"></div>                    <form enctype="multipart/form-data" method="POST"                          action="" encoding="multipart/form-data"                          name="ormupload">                        <input type="hidden" value="" name="path_key" crud-field="path_key" />                        <input type="hidden" value="" name="type" crud-field="type" />                        <input type="hidden" value="" name="filename" />                                                            <div class="alert alert-danger hide">                        </div>                        <div crud-custom_html>                                    </div>                        <table crud-fields_container class="table">                            <tr>                                <td>                                    <div crud-file-label><span crud-label="app.accepted-extensions"></span>:</div>                                    <div  crud-label="app.extensions-attachment"></div>                                    <div>Max <span crud-label="app.upload-max-filesize"></span> </div>                                </td>                                <td>                                    <div class="btn-group">                                        <input class="btn btn-default" type="file" name="file">                                    </div>                                </td>                                <td>                                    <div >                                        <!--<div crud-preview crud-template="#default_foto_item_preview_tpl" crud-field="data"></div>-->                                        <!--<img src="" class="preview hide">-->                                    </div>                                </td>                            </tr>                        </table>                    </form>            </div>';
}}),RenderUploadAttachmentEdit=BaseUploadAttachment.extend({getValue:function(){var e=this;return e.jQe(e.control_selector).val()},render:function(e){var t=this;t._renderTemplateData(),t.jQe().find(t.control_selector).val(t.value).attr("name",t.key),e()},finalize:function(e){var t=this;jQuery(t.container).find("[crud-button_upload]").html(t.buttonLabel),jQuery(t.container).find("[crud-button_upload]").click(function(){t.upload()}),e()},template:function(){return'<div>                    <input  crud-render_control type="hidden">                    <a crud-href="link" crud-attrs="{title:filename}" crud-remove="!filename" target="_blank">                        <i crud-class="icon"></i>                    </a>                    <button class="btn btn-default btn-xs" crud-button_upload type="button">Upload</button>                </div>'}}),RenderUploadAttachmentView=BaseUploadAttachment.extend({getValue:function(){return this.value},render:function(e){var t=this;if(t.value){var a={link:t.downloadUrl(),filename:t.value,icon:t._getIcon()};jQuery.renderTemplate(t.container,t.container,a)}e()},template:function(){return'<div crud-render_element>                    <a crud-href="link" crud-attrs="{title:filename}" crud-remove="!filename" target="_blank">                        <i crud-class="icon"></i>                    </a>                </div>'}}),BaseAutocomplete=Render.extend({routeName:"autocomplete",fields:[],labelFields:[],autocomplete_view_selector:"[crud-render_autocomplete_view]",autocomplete_input_selector:"[crud-render_autocomplete_input]",resources:["typeahead/bootstrap3-typeahead.min.js","typeahead/typeahead.bundle.js","typeahead/typeaheadjs.css"],metadata:{modelData:null,autocompleteModel:null,method:null,separator:null,n_items:null},init:function(e,t){this._super(e,t),this.labelFields&&0!=this.labelFields.length||this.fields&&(this.labelFields=this.fields)},_getLabelValue:function(){var e=this;if(!e.metadata.modelData)return e.app.translate("app.search");var t=e.metadata.modelData.label?e.metadata.modelData.label:"",a=e.metadata.separator?e.metadata.separator:" ";e.labelFields.length>0&&(t="");for(var r in e.labelFields)e.metadata.modelData[e.labelFields[r]]&&(t+=e.metadata.modelData[e.labelFields[r]],r<e.labelFields.length-1&&(t+=a));return t},_getInputViewName:function(){var e=this,t=e.key;return t.indexOf("[]")>=0?(t=t.substr(0,t.length-2),t+"_view[]"):t+"_view"},_getFieldValue:function(){var e=this;return e.metadata.modelData&&0!==e.metadata.modelData.length&&e.fields&&0!==e.fields.length?e.metadata.modelData[e.fields[0]]:""},_createUrl:function(){var e=this,t=Route.factory(e.routeName,{values:{modelName:e.metadata.autocompleteModel}}),a=e.url?e.url:t.getUrl();if(a+="?",e.metadata.fields)for(var r in e.metadata.fields)a+="field[]="+e.metadata.fields[r]+"&";return a+=e.metadata.separator?"&separator="+e.metadata.separator:"",a+=e.metadata.n_items?"&n_items="+e.metadata.n_items:"",a+=e.metadata.method?"&method="+e.metadata.method:""},_renderSelectedValue:function(){var e=this,t=jQuery(e.container).find("[crud-render_element]");t.on("typeahead:selected",function(t,a){var r=jQuery(e.container).find('input[name="'+e.key+'"]'),n=e._getInputViewName(),i=jQuery(e.container).find('[crud-render_autocomplete_view="'+n+'"]');a.id?r.val(a.id):r.val(""),e.metadata.modelData=a,i.text(e._getLabelValue()),e.ev_selected(a)})},getAutocompleteRow:function(e){var t=this,a=e.label?e.label:"undef";if(t.labelFields.length>0){a="";for(var r in t.labelFields){var n=t.labelFields[r];a+=e[n]+" "}}return e.label=a,e},ev_selected:function(e){},getValue:function(){var e=this;return jQuery(e.container).find(e.control_selector).val()}});RenderAutocompleteEdit=BaseAutocomplete.extend({render:function(e){var t=this,a=jQuery(t.container).find(t.control_selector);a.attr("name",t.key).attr("value",t.value);var a=jQuery(t.container).find(t.autocomplete_input_selector),r=t._getInputViewName();a.attr("name",r).val(t._getFieldValue()).attr("value",t._getFieldValue());var a=jQuery(t.container).find(t.autocomplete_view_selector);return a.attr("crud-render_autocomplete_view",r).html(t._getLabelValue()),e()},finalize:function(e){var t=this,a=jQuery(t.container).find(t.autocomplete_input_selector),r=t._createUrl(),n=new Bloodhound({datumTokenizer:function(e){return Bloodhound.tokenizers.whitespace(e.label)},queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:r+"&term=%QUERY",wildcard:"%QUERY",filter:function(e){return jQuery.map(e.result,function(e){return t.getAutocompleteRow(e)})}}});return n.initialize(),a.typeahead(null,{displayKey:"label",source:n.ttAdapter()}),t._renderSelectedValue(),e()},template:function(){return'<div class="input-group">                    <span style="height:19px" class="input-group-addon" id="basic-addon1" crud-render_autocomplete_view crud-lang="autocomplete-nonselezionato"></span>                    <input crud-render_control type="hidden" name="" value="">                    <div crud-render_element class="autosuggest" crud-minLength="1" crud-queryURL="php/view/demo.autosuggest.php?limit=10&search=">                        <input crud-render_autocomplete_input type="text" name="src" placeholder="" class="form-control typeahead" />                    </div>                </div>'}});var RenderHasmanyUploadImage=Render.extend({uploadConfView:"ConfEdit",limit:null,modelName:null,uploadModelName:null,routeName:"uploadfile",vkey:null,labelField:"filename",uploadFields:["ext","random","id","status","original_name","filename","mimetype","modelName","type"],fields:["nome","descrizione"],fields_config:{nome:{type:"input"},descrizione:{type:"textarea"}},mainformFields:["nome","descrizione","original_name","filename","ext","random","id","status","mimetype"],icon_selector:"[crud-icon_img]",_showItemUploadedPreview:function(e,t){var a=t.filename?t.filename:t.full_filename,r=Server.getUrl("/imagecache/small/"+a);jQuery(e).find("[crud-icon]").attr("src",r)},_bindActions:function(){var e=this;jQuery(e.container).find("[crud-button_delete]").unbind("click"),jQuery(e.container).find("[crud-button_delete]").click(function(){var t=jQuery(this).closest("[crud-upload_item]").index();e.deleteItem(t)}),jQuery(e.container).find("[crud-button_edit]").unbind("click"),jQuery(e.container).find("[crud-button_edit]").click(function(){return void alert("da implementae")})},_checkLimit:function(){var e=this;if(!e.limit)return e.jQe("[crud-render_limit]").addClass("hide"),void e.jQe("[crud-button_add]").removeClass("hide");var t=0;jQuery.each(e.jQe("[crud-upload_item]"),function(){jQuery(this).hasClass("hide")||t++}),t>=e.limit?(e.jQe("[crud-render_limit]").removeClass("hide"),e.jQe("[crud-button_add]").addClass("hide")):(e.jQe("[crud-render_limit]").addClass("hide"),e.jQe("[crud-button_add]").removeClass("hide"))},renderNewItem:function(e){var t=this;t.app.log.debug("upload new item",t.container,'[crud-render_list="'+t.key+'"]',e);var a=t._createItem(e,"new");t.jQe('[crud-render_list="'+t.key+'"]').append(a),t._bindActions(),t._checkLimit()},deleteItem:function(e){var t=this,a=jQuery(t.container).find("[crud-render_list]"),r=a.find('input[name="'+t.key+'-status[]"]:eq('+e+")").val();t.app.log.debug(t.uploadType+".deleteItem  status "+r),"new"==r?(a.find("[crud-upload_item]:eq("+e+")").remove(),t._checkLimit()):app.confirmDialog("Rimuovo l'immagine ?",{ok:function(){a.find('input[name="'+t.key+'-status[]"]:eq('+e+")").attr("value","deleted"),a.find("[crud-upload_item]:eq("+e+")").addClass("hide"),t._checkLimit()}})},ok:function(e){var t=this,a=e.jQe().find("form").serializeAssoc();a.updated_at=new Date,t.renderNewItem(a)},cancel:function(){},_setUploadFieldsType:function(){var e=this,t=app.getView(e.vkey);for(var a in e.uploadFields)t.fields_config[e.uploadFields[a]]={type:"hidden"}},_setFieldsType:function(){var e=this,t=app.getView(e.vkey);for(var a in e.fields){var r=e.fields[a],n=e.fields_config[r]?e.fields_config[r]:{type:"input"};t.fields_config[r]=n}},getValue:function(){var e=this,t=[];return jQuery.each(jQuery(e.container+" ul li"),function(){var e=jQuery(this).find("input").serializeArray(),a={};for(var r in e)a[e[r].name]=e[r].value;t.push(a)}),t},afterUpload:function(e){},dialogContentTemplate:function(){return'<div id="loader_foto"></div>                <form enctype="multipart/form-data" method="POST"                    action="" encoding="multipart/form-data"                    name="formupload">                    <div crud-custom_html>                                </div>                    <table class="table">                        <tr>                            <td>                                <div >                                    <span crud-label="app.accepted-extensions"></span>:</div>                                    <div crud-label="app.extensions-foto"></div>                                    <div >Max <span crud-label="app.upload-max-filesize" ></span>                                 </div>                            </td>                            <td>                                <div class="btn-group">                                    <input class="btn btn-default" type="file" name="file">                                </div>                            </td>                            <td>                                <div >                                    <div crud-preview crud-field="data"></div>                                </div>                            </td>                            <td>                                </td>                        </tr>                    </table>                    <div crud-view_container>                                    </div>                </form>'}});RenderHasmanyUploadImageEdit=RenderHasmanyUploadImage.extend({traits:["TraitUpload"],resources:["jquery.form.js","jquery-sortable.js"],render:function(e){var t=this,a="";t.jQe().find("[crud-render_list]").attr("crud-render_list",t.key);for(var r in t.value)a+=t._createItem(t.value[r],"updated");t.jQe().find("[crud-render_limit]").addClass("hide"),t.jQe().find('[crud-render_list="'+t.key+'"]').html(a),t.jQe().find("[crud-pk]").attr("crud-pk",t.key);var n=t.key+"_exists";return jQuery("<input>").attr({type:"hidden",name:n,value:1}).appendTo(t.jQe()),e()},finalize:function(e){var t=this;return t._bindActions(),t._checkLimit(),0==jQuery(t.container).length?void t.app.log.warn("Upload "+t.uploadType+" container not found ",t.container):(jQuery(t.container).find("[crud-button_add]").click(function(){t.addUpload()}),jQuery(t.container).find(".sort_class").sortable({handle:".button-move"}),e())},_createItem:function(e,t){var a=this;e.status=t,e.type=a.metadata.relationName,e.random_id=e.id?e.id:(new Date).getTime(),e.label=e[a.labelField]?e[a.labelField]:"";var r=Component.parseHtml(a.itemTemplate());jQuery(r).find("[crud-preview]").html(a.previewItemTemplate()),0==r.find("[crud-model_fields]").length&&a.app.log.error("[crud-model_fields] selector not found");for(var n in a.uploadFields){var i=a.uploadFields[n];_.indexOf(a.mainformFields,i)<0||r.find("[crud-model_fields]").append(jQuery("<input>").attr({type:"hidden",name:a.key+"-"+i+"[]",value:e[i]}))}for(var n in a.fields){var i=a.fields[n];_.indexOf(a.mainformFields,i)<0||r.find("[crud-model_fields]").append(jQuery("<input>").attr({type:"hidden",name:a.key+"-"+i+"[]",value:e[i]}))}a.app.log.debug("TraitUpload._createItem",e),jQuery.renderTemplate(jQuery(r),jQuery(r),e),a._showItemUploadedPreview(r,e),r.find("[crud-pk]").attr("crud-pk",e.id);var o=r.html();return r.remove(),o},itemTemplate:function(){return'<li class="list-unstyled" crud-upload_item>                    <div class="col col-sm-12 thumbnail">                        <div crud-model_fields></div>                        <div class="clearfix">                            <small class="pull-left" crud-field="label" crud-trim="12" crud-attrs="{title:label}"></small>                            <button class="btn-danger btn-xs pull-right" type="button" crud-button_delete crud-pk="" title="Cancella Foto"><i class="fa fa-times-circle"></i></button>                                </div>                        <div crud-preview crud-field="data"></div>                    </div>                </li>'},previewItemTemplate:function(){return"<img crud-icon class=\"button-move\" src=\"\" crud-attrs=\"{src:(typeof urls !== 'undefined')?Server.getUrl(urls+'small'):Server.getUrl('/imagecache/small/'+filename)}\">"},template:function(){return'<div class="" crud-render_element >                   <div class="col col-sm-12">                        <div class="panel panel-info">                            <div class="panel-heading" crud-upload_title crud-label="modelMetadata.singular">                                <br/>                                <span><small crud-foto-msg></small></span>                            </div>                            <div class="panel-body">                                <ul class="list-group sort_class list-inline" crud-render_list >                                <!--  -- contenitore lista fotos -- -->                                </ul>                                <div>                                    <div crud-render_limit crud-lang="general-max_limit_reached"></div>                                                                    </div>                            </div>                            <div class="panel-footer">                                <div>                                    <button crud-button_add crud-pk="" type="button" class="btn btn-primary">                                        <span crud-label="app.add"></span> <span crud-label="model.foto"></span>                                    </button>                                </div>                            </div>                        </div>                   </div>               </div>'}}),RenderHasmanyUploadImageView=RenderHasmanyUploadImage.extend({render:function(e){var t=this;if(t.value&&t.value.length>0){var a=t.value;if(t.limit){a=[];for(var r=0;r<t.limit;r++)r<t.value.length&&a.push(t.value[r])}for(var n in a){var i=Component.parseHtml(t.itemTemplate());t.jQe().find("[crud-render_list]").append(jQuery.getTemplate(i,a[n]))}}else t.jQe().find("[crud-button_upload]").addClass("disabled");return e()},template:function(){return'<div crud-render_element>                    <ul class="list-unstyled" crud-render_list >                        <!--  -- contenitore lista fotos -- -->                    </ul>                </div>'},itemTemplate:function(){return'<li>                    <img class="img-circle img-list" src="" crud-attrs="{src:Server.getUrl(urls+\'icon\')}" />                </li>'}});var RenderHasmanyUploadAttachment=Render.extend({uploadConfView:"ConfEdit",limit:null,modelName:null,uploadModelName:null,routeName:"uploadfile",iconSize:"default",icons:{"default":{"default":"fa fa-2x fa-file-o",xls:"fa fa-2x fa-file-excel-o",zip:"fa fa-2x fa-file-archive-o",mp3:"fa fa-2x fa-audio-o",jpg:"fa fa-2x fa-image-o",pdf:"fa fa-2x fa-file-pdf-o",txt:"fa fa-2x fa-file-text-o"},big:{"default":"fa fa-3x fa-file-o",xls:"fa fa-3x fa-file-excel-o",zip:"fa fa-3x fa-file-archive-o",mp3:"fa fa-3x fa-audio-o",jpg:"fa fa-3x fa-image-o",pdf:"fa fa-3x fa-file-pdf-o",txt:"fa fa-3x fa-file-text-o"},small:{"default":"fa fa-file-o",xls:"fa fa-file-excel-o",zip:"fa fa-file-archive-o",mp3:"fa fa-audio-o",jpg:"fa fa-image-o",pdf:"fa fa-file-pdf-o",txt:"fa fa-file-text-o"}},vkey:null,labelField:"filename",uploadFields:["ext","random","id","status","original_name","filename","mimetype","modelName","type"],fields:["nome","descrizione"],fields_config:{nome:{type:"input"},descrizione:{type:"textarea"}},mainformFields:["nome","descrizione","original_name","filename","ext","random","id","status","mimetype"],icon_selector:"[crud-icon]",_showItemUploadedPreview:function(e,t){var a=this,r=a.icons.big[t.ext]?a.icons.big[t.ext]:a.icons.big["default"];e.find(a.icon_selector).addClass(r)},_bindActions:function(){var e=this;jQuery(e.container).find("[crud-button_delete]").unbind("click"),jQuery(e.container).find("[crud-button_delete]").click(function(){var t=jQuery(this).closest("[crud-upload_item]").index();e.deleteItem(t)}),jQuery(e.container).find("[crud-button_edit]").unbind("click"),jQuery(e.container).find("[crud-button_edit]").click(function(){return void alert("da implementae")})},_checkLimit:function(){var e=this;if(!e.limit)return e.jQe("[crud-render_limit]").addClass("hide"),void e.jQe("[crud-button_add]").removeClass("hide");var t=0;jQuery.each(e.jQe("[crud-upload_item]"),function(){jQuery(this).hasClass("hide")||t++}),t>=e.limit?(e.jQe("[crud-render_limit]").removeClass("hide"),e.jQe("[crud-button_add]").addClass("hide")):(e.jQe("[crud-render_limit]").addClass("hide"),e.jQe("[crud-button_add]").removeClass("hide"))},renderNewItem:function(e){var t=this;t.app.log.debug("upload new item",t.container,'[crud-render_list="'+t.key+'"]',e);var a=t._createItem(e,"new");t.jQe('[crud-render_list="'+t.key+'"]').append(a),t._bindActions(),t._checkLimit()},deleteItem:function(e){var t=this,a=jQuery(t.container).find("[crud-render_list]"),r=a.find('input[name="'+t.key+'-status[]"]:eq('+e+")").val();t.app.log.debug(t.uploadType+".deleteItem  status "+r),"new"==r?(a.find("[crud-upload_item]:eq("+e+")").remove(),t._checkLimit()):app.confirmDialog("Rimuovo Documento?",{ok:function(){a.find('input[name="'+t.key+'-status[]"]:eq('+e+")").attr("value","deleted"),a.find("[crud-upload_item]:eq("+e+")").addClass("hide"),t._checkLimit()}})},ok:function(e){var t=this,a=e.jQe().find("form").serializeAssoc();a.updated_at=new Date,t.renderNewItem(a)},cancel:function(){},_setUploadFieldsType:function(){var e=this,t=app.getView(e.vkey);for(var a in e.uploadFields)t.fields_config[e.uploadFields[a]]={type:"hidden"}},_setFieldsType:function(){var e=this,t=app.getView(e.vkey);for(var a in e.fields){var r=e.fields[a],n=e.fields_config[r]?e.fields_config[r]:{type:"input"};t.fields_config[r]=n}},getValue:function(){var e=this,t=[];return jQuery.each(jQuery(e.container+" ul li"),function(){var e=jQuery(this).find("input").serializeArray(),a={};for(var r in e)a[e[r].name]=e[r].value;t.push(a)}),t},afterUpload:function(e){},dialogContentTemplate:function(){return'<div id="loader_foto"></div>                <form enctype="multipart/form-data" method="POST"                    action="" encoding="multipart/form-data"                    name="formupload">                    <div crud-custom_html>                                </div>                    <table class="table">                        <tr>                            <td>                                <div >                                    <span crud-label="app.accepted-extensions"></span>:</div>                                    <div crud-label="app.extensions-attachment"></div>                                    <div >Max <span crud-label="app.upload-max-filesize" ></span>                                 </div>                            </td>                            <td>                                <div class="btn-group">                                    <input class="btn btn-default" type="file" name="file">                                </div>                            </td>                            <td>                                <div >                                    <div crud-preview crud-field="data"></div>                                </div>                            </td>                            <td>                                </td>                        </tr>                    </table>                    <div crud-view_container>                                    </div>                </form>'}});RenderHasmanyUploadAttachmentEdit=RenderHasmanyUploadAttachment.extend({traits:["TraitUpload"],resources:["jquery.form.js","jquery-sortable.js"],render:function(e){var t=this,a="";t.jQe().find("[crud-render_list]").attr("crud-render_list",t.key);for(var r in t.value)a+=t._createItem(t.value[r],"updated");t.jQe().find("[crud-render_limit]").addClass("hide"),t.jQe().find('[crud-render_list="'+t.key+'"]').html(a),t.jQe().find("[crud-pk]").attr("crud-pk",t.key);var n=t.key+"_exists";return jQuery("<input>").attr({type:"hidden",name:n,value:1}).appendTo(t.jQe()),e()},finalize:function(e){var t=this;return t._bindActions(),t._checkLimit(),0==jQuery(t.container).length?void t.app.log.warn("Upload "+t.uploadType+" container not found ",t.container):(jQuery(t.container).find("[crud-button_add]").click(function(){t.addUpload()}),jQuery(t.container).find(".sort_class").sortable({handle:".button-move"}),e())},_createItem:function(e,t){var a=this;e.status=t,e.type=a.metadata.relationName,e.random_id=e.id?e.id:(new Date).getTime(),e.label=e[a.labelField]?e[a.labelField]:"";var r=Component.parseHtml(a.itemTemplate());jQuery(r).find("[crud-preview]").html(a.previewItemTemplate()),0==r.find("[crud-model_fields]").length&&a.app.log.error("[crud-model_fields] selector not found");for(var n in a.uploadFields){var i=a.uploadFields[n];_.indexOf(a.mainformFields,i)<0||r.find("[crud-model_fields]").append(jQuery("<input>").attr({type:"hidden",name:a.key+"-"+i+"[]",value:e[i]}))}for(var n in a.fields){var i=a.fields[n];_.indexOf(a.mainformFields,i)<0||r.find("[crud-model_fields]").append(jQuery("<input>").attr({type:"hidden",name:a.key+"-"+i+"[]",value:e[i]}))}a.app.log.debug("TraitUpload._createItem",e),jQuery.renderTemplate(jQuery(r),jQuery(r),e),a._showItemUploadedPreview(r,e),r.find("[crud-pk]").attr("crud-pk",e.id);var o=r.html();return r.remove(),o},previewItemTemplate:function(){return'<span class="button-move">                    <i crud-icon></i>                </span>'},itemTemplate:function(){return'<li class="list-unstyled" crud-upload_item>                    <div class="col col-sm-12 thumbnail">                        <div crud-model_fields></div>                        <div class="clearfix">                            <small class="pull-left" crud-field="label" crud-trim="12" crud-attrs="{title:label}"></small>                            <button class="btn-danger btn-xs pull-right" type="button" crud-button_delete crud-pk="" title="Cancella Foto"><i class="fa fa-times-circle"></i></button>                                </div>                        <div crud-preview crud-field="data"></div>                    </div>                </li>'},template:function(){return'<div class="" crud-render_element >                   <div class="col col-sm-12">                        <div class="panel panel-info">                            <div class="panel-heading" crud-upload_title>                                <br/>                                <span><small crud-foto-msg></small></span>                            </div>                            <div class="panel-body">                                <ul class="list-group sort_class list-inline" crud-render_list >                                <!--  -- contenitore lista fotos -- -->                                </ul>                                <div>                                    <div crud-render_limit crud-lang="general-max_limit_reached"></div>                                                                    </div>                            </div>                            <div class="panel-footer">                                <div>                                    <button crud-button_add crud-pk="" type="button" class="btn btn-primary">                                        <span crud-label="app.add"></span> <span crud-label="model.attachment"></span>                                    </button>                                </div>                            </div>                        </div>                   </div>               </div>'}});var RenderHasmanyUploadAttachmentView=RenderHasmanyUploadAttachment.extend({template:function(){return'<div crud-render_element>                    <ul class="list-unstyled" crud-render_list >                        <!--  -- contenitore lista fotos -- -->                    </ul>                </div>'},itemTemplate:function(){return'<li>                    <a class="small" target="_blank" href="#"                            crud-href="\'/downloadfile/\'+id" crud-totranslate="true" crud-attrs="{\'title\':full_filename}" crud-append="true">                                <i crud-class="icon" />                    </a>                </li>'},render:function(e){var t=this;if(t.value&&t.value.length>0){var a=t.value;if(t.limit){a=[];for(var r=0;r<t.limit;r++)r<t.value.length&&a.push(t.value[r])}for(var n in a){a[n].icon=t.icons[t.iconSize][a[n].ext],a[n].icon||(a[n].icon=t.icons[t.iconSize]["default"]);var i=Component.parseHtml(t.itemTemplate());t.jQe().find("[crud-render_list]").append(jQuery.getTemplate(i,a[n]))}}else t.jQe().find("[crud-button_upload]").addClass("disabled");return e()}}),BaseHasmany=Render.extend({_views:[],jsonData:null,limit:null,separator:null,fields:[],metadata:{modelName:null},getValue:function(){var e=this;if(!e.jsonData)return[];var t=Object.keys(e.jsonData.result);t.push("status");for(var a=[],r='input[name*="'+Utility.snakeCase(e.key)+'-status"]',n=jQuery(e.container).find(r).length,i=0;i<n;i++){var o={};for(var u in t){var l=t[u],d='input[name*="'+Utility.snakeCase(e.key)+"-"+l+'"]';o[l]=jQuery(jQuery(e.container).find(d).get(i)).val()}a.push(o)}return a},_bindDeleteEvents:function(){var e=this;jQuery(e.container).find("[crud-button_delete]").unbind("click"),jQuery(e.container).find("[crud-button_delete]").click(function(){var t=jQuery(this).attr("crud-view_index");e.deleteHasManyItem(t)})},renderNewItem:function(e){var t=this,a="updated",r=[];if(e)e.status=a;else{r=Object.keys(t.jsonData.result),e={};for(var n in t.jsonData.result)e[n]=t.jsonData.result[n];e.status="new"}var i=t.modelConf?t.modelConf:app.getConf(t.metadata.modelName,"edit");i||(i=t.app.getDefaultConf("edit")),i.actions=[],jQuery.inArray("status",i.fields)<0&&i.fields.push("status"),jQuery.inArray("id",i.fields)<0&&i.fields.push("id"),i.fields_config.status={type:"hidden"},i.prefixKey=t.key+"-",i.modelName=t.metadata.modelName,i.routeName=null;var o=Component.parseHtml(t.itemTemplate()),u=t.key+"_"+Math.floor(1e5*Math.random());o.children(0).attr("crud-hasmany_item_structure",u),o.find("[crud-hasmany_item]").attr("crud-hasmany_item",u),t.jQe().find('[crud-render_list="'+t.key+'"]').append(o.html()),i.container='[crud-hasmany_item="'+u+'"]',i.parentContainer='[crud-hasmany_item_structure="'+u+'"]',o.remove(),i.data={value:e,translations:t.jsonData.translations,metadata:t.jsonData.metadata,resultParams:t.jsonData.resultParams};var l=new ViewHasmanyEdit(i);l.hasManyIndex=t._views.length,t._views.push(l),jQuery(i.container).attr("crud-view_index",l.hasManyIndex),jQuery(i.parentContainer).find("[crud-button_delete]").attr("crud-view_index",l.hasManyIndex),l.draw(),t._checkLimit()},deleteHasManyItem:function(e){var t=this,a=t._views[e],r=a.getRenderValue("status");"new"==r?t.jQe(a.parentContainer).remove():(a.getRender("status").setValue("deleted"),t.jQe(a.parentContainer).addClass("hide")),t._checkLimit()},getJsonData:function(e){var t=this,a=Route.factory("insert_hasmany",{values:{modelName:t.metadata.modelName}});Server.route(a,function(t){e(t)})},_checkLimit:function(){var e=this,t=0;for(var a in e._views)0!=e.jQe('[crud-view_index="'+a+'"]').length&&"deleted"!=e._views[a].getRenderValue("status")&&t++;t>=e.limit?(e.limitMessage&&e.jQe("[crud-render_limit]").html(e.app.translate(e.limitMessage)),e.jQe("[crud-render_limit]").removeClass("hide"),e.jQe("[crud-button_add]").addClass("hide")):(e.jQe("[crud-render_limit]").addClass("hide"),e.jQe("[crud-button_add]").removeClass("hide"))}}),RenderHasmanyEdit=BaseHasmany.extend({resources:["jquery-sortable.js"],render:function(e){var t=this;t.jQe("[crud-render_list]").attr("crud-render_list",t.key);var a=t.key+"_exists";return jQuery("<input>").attr({type:"hidden",name:a,value:1}).appendTo(t.jQe()),e()},finalize:function(e){var t=this;t.app.log.debug("finalize ",t.key," modelName "+t.metadata.modelName,jQuery(t.container).find('[crud-hasmany_container="'+t.metadata.key+'"]').length);var a=function(){for(var a in t.value){var r=t.value[a];t.renderNewItem(r)}return t._bindDeleteEvents(),jQuery(t.container).find("[crud-button_add]").click(function(){t.renderNewItem(),t._bindDeleteEvents()}),jQuery(t.container).find(".sort_class").sortable({handle:".button-move"}),e()};t.jsonData?a():(t.app.log.debug("JSONDATA",t.jsonData),t.getJsonData(function(e){t.jsonData=e,a()}))},template:function(){return'<div class="" crud-render_element >                   <div class="col col-sm-12">                    <div class="panel panel-warning">                        <div class="panel-heading" crud-hasmany_title>                        </div>                        <div class="panel-body">                            <p crud-hasmany_title_msg></p>                            <ul class="list-unstyled sort_class hasmany-list" crud-render_list >                            <!--  -- contenitore hasmany -- -->                            </ul>                                                   </div>                        <div class="panel-footer">                            <div >                                <div crud-render_limit class="hide">                                    <!-- Limite massimo raggiunto -->                                                </div>                                <button crud-button_add crud-pk="" type="button" class="btn btn-primary">                                    <span crud-label="app.add"></span>&nbsp;                                    <span crud-label="modelMetadata.singular"></span>&nbsp;                                </button>                            </div>                        </div>                    </div>                    </div>                </div>'},itemTemplate:function(){return'<li class="col col-lg-6 col-md-6 col-sm-12 col-xs-12" crud-hasmany_item_structure>                    <div class="clearfix" >                        <div class="clearfix" >                            <span class="pull-left button-move">                                <i class="fa fa-arrows"></i>                                    </span>                            <span class="pull-right btn btn-xs btn-danger" crud-button_delete>                                <i class="fa fa-close"></i>                                    </span>                        </div>                        <div class="col col-sm-12" crud-hasmany_item>                         </div>                            </div>                    <hr />                </li>'}}),RenderHasmanyView=BaseHasmany.extend({getValue:function(){var e=this;return e.value},render:function(e){var t=this;if(t.value&&t.value.length>0){for(var a=[],r=t.limit&&t.limit<t.value.length?t.limit:t.value.length,n=Component.parseHtml(t.itemTemplate()),i=0;i<r;i++){a.push(t.value[i]);var o="",u=t.separator?t.separator:" ";for(var l in t.fields){var d=t.fields[l];o+=t.value[i][d],l<t.fields.length-1&&(o+=u)}a[i].label=o}var s={items:a};t.jQe().find('[crud-field="items"]').html(n.html()),jQuery.renderTemplate(t.jQe(),t.jQe(),s)}else t.jQe().find("[crud-button_upload]").addClass("disabled");return e()},template:function(){return'<div crud-render_element>                <div class="list-unstyled" crud-render_list >                    <!--  -- contenitore lista hasmany data dal template  default_hasmany_view_items_tpl-- -->                    <ul class="list-unstyled" crud-field="items" crud-self>                    </ul>                </div>            </div>'},itemTemplate:function(){return'<li>                    <span crud-field="label" ></span>                </li>'}}),BaseHasmanyThrough=Render.extend({selected:[],modelName:"none",last_searched_result:null,hasmany_container:"[crud-hasmany_container]",selected_container:"[crud-selected_container]",
title_selector:"[crud-render_title]",removeActionOptions:null,morph:null,labelFields:["label"],hiddenFields:["id","status"],labelFieldsConfig:{},addNew:!1,searchField:null,searchDescription:null,searchMethod:null,metadata:{autocompleteModel:null},init:function(e,t){this._super(e,t),this.selected=[],this.last_searched_result=null,this._views=[]},_populateItem:function(e,t){var a=this,r=a.addActionOptions?a.addActionOptions:{icon:"fa fa-plus",cssClass:"btn btn-xs btn-primary"};r.execute=function(){a.addItem(this.view.data.value)};var n=Conf.extend(ConfView,{actions:["addItem"],routeName:null,modelName:a.key,container:t,fields:[],fields_config:{},prefixKey:a.key+"-",custom_actions:{addItem:RecordAction.extend(r)},data:{value:e,translations:{},metadata:{}},autorender:!0,template:a.viewTemplate()});for(var i in a.labelFields){var o=a.labelFields[i];n.fields.push(o);var u=a.labelFieldsConfig[o]?a.labelFieldsConfig[o]:{type:"text",templateName:"simple"};a.app.log.debug("labelField",o,u),n.fields_config[o]=u}a.app.addView(n)},_populate:function(e){var t=this,a=jQuery(t.container).find('[crud-hasmany_container="'+t.key+'"]');jQuery(a).find("[crud-add]").unbind("click"),jQuery(a).html(jQuery("#default_spinner_tpl").html());var r=(t.morph,t.label_field,Route.factory("autocomplete",{values:{modelName:t.metadata.autocompleteModel}}));r.params.term=e,t.searchField&&(r.params.field=t.searchField),t.searchDescription&&(r.params.description=t.searchDescription),t.searchMethod&&(r.params.method=t.searchMethod),t.app.waitStart("...",a),Server.route(r,function(e){if(t.app.waitEnd(a),e.error)return void t.app.errorDialog(e.msg);delete t.last_searched_result,t.last_searched_result=e.result,a.html(" ");for(var r in e.result){var n=Component.parseHtml(t.itemTemplate());n.find("[crud-item]").attr("crud-item",r),a.append(n.html());var i=a.find('[crud-item="'+r+'"]');t._populateItem(e.result[r],i)}})}}),RenderHasmanyThroughEdit=BaseHasmanyThrough.extend({resources:["jquery-sortable.js"],_views:[],getValue:function(){var e=this,t=[];for(var a in e._views){var r=e._views[a];t.push(r.getViewData())}return t},itemExist:function(e){var t=this;for(var a in t._views){var r=t._views[a];if(e.id.toString()===r.data.value.id.toString())return!0}return!1},addItem:function(e){var t=this;if(!t.itemExist(e)){e.status="updated";var a="vcontainer_"+Component.newID(),r=t.jQe('[crud-selected_container="'+t.metadata.autocompleteModel+'"]'),n=jQuery(t.addedItemTemplate()).appendTo(r),i=n.find("[crud-hasmany_through_item]").length?n.find("[crud-hasmany_through_item]"):n;i.attr("crud-hasmany_through_item",a);var o=t.removeActionOptions?t.removeActionOptions:{icon:"fa fa-minus",cssClass:"btn btn-xs btn-danger"};o.execute=function(){t.deleteItem(this.view.keyId),n.addClass("hide")};var u=Conf.extend(ConfInsert,{actions:["removeItem"],routeName:null,modelName:t.key,viewClass:"ViewHasmanyEdit",container:r.find('[crud-hasmany_through_item="'+a+'"]'),fields:[],fields_config:{},prefixKey:t.key+"-",custom_actions:{removeItem:RecordAction.extend(o)},data:{value:e,translations:{},metadata:{}},autorender:!0,template:t.viewTemplate()});for(var l in t.hiddenFields){var d=t.hiddenFields[l];u.fields.push(d),u.fields_config[d]={type:"hidden"}}for(var l in t.labelFields){var d=t.labelFields[l];u.fields.push(d);var s=t.labelFieldsConfig[d]?t.labelFieldsConfig[d]:{type:"text",templateName:"simple"};t.app.log.debug("labelField",d,s),u.fields_config[d]=s}var c=t.app.addView(u);t._views.push(t.app.getView(c))}},deleteItem:function(e){var t=this,a=-1;for(var r in t._views)if(t._views[r].keyId==e){a=r;break}return a<0?void t.log.warn(this.className+".deleteItem vkey "+e+" inesistente"):(t._views.splice(a,1),void t.app.removeView(e))},render:function(e){var t=this;t.jQe().find(t.hasmany_container).attr("crud-hasmany_container",t.key),t.jQe().find(t.selected_container).attr("crud-selected_container",t.metadata.autocompleteModel),t.jQe().find(t.title_selector).html(t.app.translate("model-"+t.metadata.autocompleteModel));var a=t.key+"_exists";return jQuery("<input>").attr({type:"hidden",name:a,value:1}).appendTo(t.jQe()),e()},finalize:function(e){var t=this;t.selected=[],t.app.log.debug("hasmany_through",t.value,t.config);var a=null,r=null;for(var n in t.value){var i=t.value[n],o=i.id;t.morph&&(a=i[t.morph.id],r=i[t.morph.type],o=r+"_"+a),t.addItem(i)}return t._populate(""),jQuery(t.container).find("[crud-search]").change(function(){t._populate(jQuery(this).val())}),t.addNew?jQuery(t.container).find("[crud-button_add]").click(function(){alert("da implementare")}):jQuery(t.container).find("[crud-button_add]").addClass("hide"),jQuery(t.container).find(".sort_class").sortable({handle:".button-move"}),e()},template:function(){return'<div class="" crud-render_element >                  <div class="col col-sm-12" >                        <div class="panel panel-info">                           <div class="panel-heading" crud-render_title>                                       </div>                           <div class="panel-body padding-3">                                           <div class="col col-md-4 col-sm-12 padding-6 panel panel-default panel-body" >                                   <h5>Elementi selezionati</h5>                                   <ul class="list-unstyled sort_class " crud-selected_container>                                   </ul>                                           </div>                                  <div class="col col-md-8 col-sm-12 padding-15" crud-template="searched">                                                                                                </div>                           </div>                        </div>                    </div>                </div>'},searchedTemplate:function(){return'<div class="input-group margin-bottom-10">                    <span class="input-group-addon " style="cursor:pointer">                        <i class="fa fa-search"></i>                        <!--                        <button class="btn btn-default btn-sm" type=button crud-lang="general-search">Go</button>-->                    </span>                    <input class="form-control "  crud-search type="text" value="" crud-placeholder="Inserire parole da ricercare">                    <span crud-button_add class="input-group-addon ">                        <i  class="fa fa-plus"></i>                    </span>                </div>                                <div class= style="position:relative; overflow:hidden;">                    <ul class="list-unstyled list-hover list-inline" crud-hasmany_container crud-slimscroll-visible="false" style="overflow: auto; width: auto; min-height: 60px;">                                        </ul>                </div>'},itemTemplate:function(){return'<li crud-item class="col col-md-6 col-sm-12 col-xs-12">                   <div class="fullwidth">                    <span style="pointer:hand" class="btn btn-xs btn-primary" crud-add crud-id crud-label crud-morph_type crud-morph_id crud-attrs="{\'crud-id\':id,\'crud-label\':label,\'crud-morph_type\':morph_type,\'crud-morph_id\':morph_id}">                        <i class="fa fa-plus"></i>                    </span>                   <span crud-field="label"></span>                   </div>               </li>'},viewTemplate:function(){return'<div>                    <div crud-view_action></div>                    <div crud-hidden_fields></div>                    <div class="clearfix" >                        <div class="" crud-view_elements></div>                                           </div>                </div>'},addedItemTemplate:function(){return'<li class="padding-bottom-6 border-bottom-1" crud-hasmany_through_item></li>'}}),RenderHasmanyThroughView=BaseHasmanyThrough.extend({getValue:function(){return this.value},render:function(e){var t=this;if(t.app.log.info("RenderHasmany view ",t.value),!t.value||0==t.value.length)return e();for(var a=Component.parseHtml(t.itemTemplate()),r=t.separator?t.separator:" ",n=0;n<t.value.length;n++){var i="";for(var o in t.fields){var u=t.fields[o];i+=t.value[n][u],o<t.fields.length-1&&(i+=r)}t.value[n].__label__=i}var l={items:t.value};t.jQe().find('[crud-field="items"]').html(a),jQuery.renderTemplate(t.jQe(),t.jQe(),l),e()},template:function(){return'<div crud-render_element>                    <ul class="list-unstyled" crud-render_list crud-field="items" crud-self>                        <!--  -- contenitore lista hasmany data dal template  default_hasmany_view_items_tpl-- -->                    </ul>                </div>'},itemTemplate:function(){return'<li >                    <span crud-field="__label__"></span>                </li>'}}),BaseMap=Render.extend({_lat:0,_lng:0,_hasDbValues:!1,address:null,lat_input_selector:"[crud-lat_field]",lng_input_selector:"[crud-lng_field]",lat_field_name:"lat",lng_field_name:"lng",idViewMap:null,metadata:{apiKey:null,raggioArea:5e3,showArea:!1},getIndirizzo:function(){var e=this;return e.address?e.address:""},_showDialog:function(){var e=this,t=app.customDialog(e.dialogTemplate(),{ok:function(t){e.ok()},cancel:function(e){}});e.activateMap(t,function(){e.app.waitEnd(),t.jQe().find("[crud-lnk_address]").unbind("click"),t.jQe().find("[crud-lnk_address]").click(function(){var a=t.jQe().find('input[name="indirizzo"]').val();return a&&0!=a.length?void Render.mymap.updateMarkerAddress(0,a,function(a){0==a.error?(t.jQe().find('input[name="lat"]').attr("value",a.pos.lat()).val(a.pos.lat()),t.jQe().find('input[name="lng"]').attr("value",a.pos.lng()).val(a.pos.lng()),e._lat=a.pos.lat(),e._lng=a.pos.lng(),Render.mymap.setCenter(e._lat,e._lng)):e.app.errorDialog(a.msg)}):void e.app.errorDialog("Inserire un indirizzo valido")});var a=e._lat,r=e._lng;if(e.app.log.info("_showDialog "+a+":"+r+" markers "+Render.mymap.markers.length),0==Render.mymap.markers.length){var n=new GMapMarker;e.getIndirizzo()&&(n.address=e.getIndirizzo()),n.lat=a,n.lng=r,n.draggable=!0,e.app.log.debug("marker",n),Render.mymap.addMarker(n),Render.mymap.showQueued(function(){Render.mymap.markerToCenter(0);var a=Render.mymap.markers[0];t.jQe().find('input[name="'+e.lat_field_name+'"]').attr("value",a.lat).val(a.lat),t.jQe().find('input[name="'+e.lng_field_name+'"]').attr("value",a.lng).val(a.lng)})}else Render.mymap.updateMarker(0,{lat:a,lng:r});if(t.jQe().find('input[name="indirizzo"]').attr("value",e.getIndirizzo()).val(e.getIndirizzo()),t.jQe().find('input[name="lat"]').attr("value",a),t.jQe().find('input[name="lng"]').attr("value",r),e.metadata.showArea){t.jQe().find("[crud-area_container]").removeClass("hide");var i=t.jQe().find("[crud-input_raggio]");$(i).val(e.metadata.raggioArea),Render.mymap.showArea({raggio:parseInt($(i).val())}),$(i).bind("change",function(){e.metadata.raggioArea=parseInt($(i).val()),Render.mymap.showArea({raggio:parseInt($(i).val())})})}setTimeout(function(){Render.mymap.markers[0].address?t.jQe().find("[crud-lnk_address]").click():Render.mymap.setCenter(a,r)},1e3)})},activateMap:function(e,t,a){var r=this,n=a?a:{},i={elementId:"gmap",zoom:8,lat:r._lat,lng:r._lng,language:"it"};_.extend(i,n),Render.mymap?(setTimeout(function(){google.maps.event.trigger(Render.mymap.gmap,"resize")},500),t()):(Render.mymap=new GMap("Render.mymap"),Render.mymap.apiKey=r.metadata.apiKey,Render.mymap.elementId=i.elementId,Render.mymap.zoom=i.zoom,Render.mymap.lat=i.lat,Render.mymap.lng=i.lng,Render.mymap.language=i.language,Render.mymap.markerDragend=function(t,a){r.app.log.debug("pos",t.lat(),t.lng()),e&&(e.jQe().find('input[name="lat"]').attr("value",t.lat()).val(t.lat()),e.jQe().find('input[name="lng"]').attr("value",t.lng()).val(t.lng()),r._lat=t.lat(),r._lng=t.lng())},Render.mymap.app=r.app,Render.mymap.afterLoadScript=function(){},Render.mymap.afterInitialize=function(){setTimeout(function(){google.maps.event.trigger(Render.mymap.gmap,"resize")},500),t()},Render.mymap.loadScript())},getValue:function(){var e=this;return{lng:e._lng,lat:e._lat}},dialogTemplate:function(){return'<div class="modal-content">                    <div class="modal-header">                        <button type="button" class="close" data-dismiss="modal"                                aria-hidden="true">&times;</button>                        <h4 class="modal-title">Seleziona coordinate</h4>                    </div>                    <div class="modal-body">                        <div class="row">                            <div class="col col-xs-6">                                <div class="input-group">                                    <span class="input-group-addon" id="basic-addon1">Indirizzo:</span>                                    <input type="text" class="form-control" name="indirizzo" aria-describedby="basic-addon1">                                    <span class="input-group-addon" id="basic-addon2"><a crud-lnk_address href="javascript:void(0)"  ><i class="fa fa-search"></i> Cerca indirizzo</a></span>                                            </div>                            </div>                            <div class="col col-xs-3">                                <div class="input-group">                                    <span class="input-group-addon" id="basic-addon1">Lat:</span>                                    <input type="text" class="form-control" name="lat" aria-describedby="basic-addon1">                                </div>                            </div>                            <div class="col col-xs-3">                                <div class="input-group">                                    <span class="input-group-addon" id="basic-addon1">Lng:</span>                                    <input type="text" class="form-control" name="lng" aria-describedby="basic-addon1">                                                        </div>                            </div>                                        <!-- <span>Lat:</span> <input  type="text" name="lat"> , <span>Lng:</span> <input type="text" name="lng">  -->                                                </div>                        <div crud-area_container class="row hide">                            <div class="col col-xs-12" >                                <div class="input-group">                                    <span class="input-group-addon" id="basic-addon1">Cerchio di raggio in metri?</span>                                    <input class="form-control" crud-input_raggio type="text" value="1000">                                </div>                            </div>                                                    <!-- <span>Lat:</span> <input  type="text" name="lat"> , <span>Lng:</span> <input type="text" name="lng">  -->                        </div>                        <div id="gmap" style="width:100%;height:400px"></div>                    </div>                    <div class="modal-footer">                        <button crud-button="cancel" type="button" class="btn btn-primary"                                data-dismiss="modal">Annulla</button>                        <button crud-button="ok" type="button" class="btn btn-primary"                                data-dismiss="modal">Ok</button>                        </div>               </div>'}}),RenderMapEdit=BaseMap.extend({ok:function(){var e=this;e.setValue(Render.mymap.markers[0].lat,Render.mymap.markers[0].lng)},setValue:function(e,t){var a=this;a._lat=e,a._lng=t,a.jQe().find(a.lat_input_selector).val(e),a.jQe().find(a.lng_input_selector).val(t);var r={};a.lat_field?r[a.lat_field]=a._lat:r.lat=a._lat,a.lng_field?r[a.lng_field]=a._lng:r.lng=a._lng,a.change(r)},render:function(e){var t=this;t.jQe().find(t.lat_input_selector).attr("name",t.lat_field_name),t.jQe().find(t.lng_input_selector).attr("name",t.lng_field_name),t.setValue(t.value.lat,t.value.lng),e()},finalize:function(e){var t=this;jQuery(t.container).find("[crud-button_map]").click(function(){t.app.waitStart(),t._showDialog()}),e()},template:function(){return'<div crud-control_container>                    <button class="btn btn-default" type="button" crud-button_map crud-label="app.modifymap"></button>                    <div class="clearfix">                                               <span class="pull-left" >                            <span crud-label="app.gpslat"></span>: <input  class="form-control" crud-lat_field></input>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                        </span>                        <span class="pull-left">                            <span crud-label="app.gpslng"></span>: <input class="form-control" class="badge" crud-lng_field></input>                        </span>                    </div>                </div>'}}),RenderMapSearch=RenderMapEdit.extend({render:function(e){var t=this;t.jQe().find(t.lat_input_selector).attr("name","s_"+t.lat_field_name+"[]"),t.jQe().find(t.lng_input_selector).attr("name","s_"+t.lng_field_name+"[]"),t.setValue(t.value.lat,t.value.lng);var a=t.jQe().find(t.operator_selector);a.attr("name","s_"+t.key+"_operator"),a.attr("value",t.operator),e()},template:function(){return'<div crud-control_container>                    <button class="btn btn-default" type="button" crud-button_map crud-label="app.modifymap"></button>                    <div class="clearfix">                        <input type="hidden" name="" crud-render_operator>                        <span class="pull-left" >                            <span crud-label="app.gpslat"></span>: <input  class="form-control" crud-lat_field></input>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                        </span>                        <span class="pull-left">                            <span crud-label="app.gpslng"></span>: <input class="form-control" class="badge" crud-lng_field></input>                        </span>                    </div>                                   </div>'}}),RenderMapView=BaseMap.extend({render:function(e){var t=this;t.idViewMap||(t.idViewMap="map_"+Date.now(),t.jQe().find("[crud-map_container]").attr("id",t.idViewMap)),t._lat=t.value.lat,t._lng=t.value.lng;var a={elementId:t.idViewMap};t.zoom&&(a.zoom=t.zoom),t.activateMap(null,function(){if(0==Render.mymap.markers.length){var a=new GMapMarker;t.getIndirizzo()&&(a.address=t.getIndirizzo()),a.txt="Lat : "+t._lat+" Lng:"+t._lng,a.lat=t._lat,a.lng=t._lng,a.draggable=!0,t.app.log.debug("marker",a),Render.mymap.addMarker(a),Render.mymap.showQueued(function(){Render.mymap.markerToCenter(0);Render.mymap.markers[0]})}else Render.mymap.updateMarker(0,{lat:lat,lng:lng});return e()},a)},template:function(){return'<div crud-map_container style="width:100%;height:400px"></div>'}}),RenderBelongsto=Render.extend({separator:null,fields:[],nullLabel:"",getValue:function(){var e=this;return e.value}}),RenderBelongstoView=RenderBelongsto.extend({render:function(e){var t=this;if(!t.value)return void t.jQe("[crud-render_element]").html(t.nullLabel);if(t.itemTemplate()){var a=Component.parseHtml(t.itemTemplate()),r=jQuery.getTemplate(a,t.value);return void t.jQe("[crud-render_element]").html(r)}var n=t.separator?t.separator:" ",i="";for(var o in t.fields){var u=t.fields[o];i+=t.value[u],o<t.fields.length-1&&(i+=n)}return t.jQe("[crud-render_element]").html(i),e()},template:function(){return"<div crud-render_element></div>"},itemTemplate:function(){return null}}),RenderCaptcha=Render.extend({captcha_img_selector:"[crud-captcha_img]",getValue:function(){var e=this;return jQuery(e.container).find(e.control_selector).val()},reload:function(){var e=this,t=Route.factory("captcha");Server.route(t,function(t){jQuery(e.container).find("[crud-captcha_img]").html(t)})}}),RenderCaptchaEdit=RenderCaptcha.extend({render:function(e){var t=this,a=t.jQe().find("[crud-render_control]");a.attr("name",t.key),a.attr("value",t.value);var r=t.jQe().find("img").prop("src");return r+="&rand="+Math.floor(1e4*Math.random()+1),t.jQe().find(t.captcha_img_selector).prop("src",r),e()},finalize:function(e){var t=this;return jQuery(t.container).find("[crud-captcha_img]").addClass("captchajs"),jQuery(t.container).find("[crud-button_reload]").click(function(){t.reload()}),t.reload(),e()},template:function(){return'<div class="row">                    <div class="col-sm-4" crud-captcha_img  >                                    </div>                    <div class="col-sm-4">                            <input crud-render_control="" class="form-control" type="text" name="" value="">                    </div>                    <div class="col-sm-4">                        <button class="btn btn-sm btn-default" type="button" crud-button_reload>Reload</button>                    </div>                </div>'}}),BaseInputHelped=BaseInput.extend({customValue:!0,metadata:{domainValues:{}},_setData:function(){var e=this,t=jQuery(e.container).find("[crud-option_values]"),a=[];for(var r in e.metadata.domainValues)a.push({value:r,label:e.metadata.domainValues[r]});jQuery.renderTemplate(t,t,a)}}),RenderInputHelpedEdit=BaseInputHelped.extend({setValue:function(e){var t=this,a=t.jQe(t.control_selector);if(t.customValue)a.attr("value",e);else{var r=_.keys(t.metadata.domainValues).map(String);_.indexOf(r,""+e)>=0?a.attr("value",e):t.app.log.warn(e," valore non compreso nel dominio")}},render:function(e){var t=this;t._setData();var a=jQuery(t.container).find("[crud-render_control]");return a.attr("name",t.key),t.customValue||a.attr("readonly","true"),t.setValue(t.value),e()},finalize:function(e){var t=this;return jQuery(t.container).find("[crud-option_values]").find("button").click(function(){var e=jQuery(t.container).find("[crud-render_control]");e.attr("value",jQuery(this).attr("crud-value")).val(jQuery(this).attr("crud-value")),t.change(jQuery(this).attr("crud-value"))}),e()},template:function(){return'<div crud-render_element>                    <input  crud-render_control class="form-control" type="text" name="" value="">                    <div crud-option_values>                        <div class="btn-group btn-group-xs" role="group" aria-label="..." crud-field="data" crud-self>                            <button type="button" class="btn btn-default" crud-html="label" crud-attrs="{\'crud-value\':value}"></button>                        </div>                    </div>                </div>'}}),RenderInputHelpedSearch=RenderInputHelpedEdit.extend({render:function(e){var t=this;t._super(function(){var a=t.jQe(t.control_selector);return a.attr("name","s_"+t.key+"[]"),a=t.jQe(t.operator_selector),a.attr("name","s_"+t.key+"_operator"),a.attr("value",t.operator),e()})},template:function(){return'<div crud-render_element>                    <input  crud-render_operator class="form-control" type="hidden" name="" value="">                    <input  crud-render_control class="form-control" type="text" name="" value="">                    <div crud-option_values>                        <div class="btn-group btn-group-xs" role="group" aria-label="..." crud-field="data" crud-self>                            <button type="button" class="btn btn-default" crud-html="label" crud-attrs="{\'crud-value\':value}"></button>                        </div>                    </div>                </div>'}}),Protocol=Class.extend({value:null,metadata:{},resultParams:{},validationRules:{},jsonToData:function(e){throw"override jsonToData function "},getData:function(){var e=Object.getOwnPropertyNames(this),t={};for(var a in e)t[e[a]]=this[e[a]];return t}});Protocol.factory=function(e){var t="Protocol"+Utility.pascalCase(e);try{return new window[t]}catch(a){log.error("failed to create "+t,a)}};var ProtocolRecord=Protocol.extend({jsonToData:function(e){this.value=e.result,this.metadata=e.metadata?e.metadata:{},this.resultParams=e.resultParams?e.resultParams:{},this.validationRules=e.validationRules?e.validationRules:{},this.backParams=e.backParams;for(var t in e.metadata)e.metadata[t].options&&(this.metadata[t].domainValues=e.metadata[t].options),e.metadata[t].options_order&&(this.metadata[t].domainValuesOrder=e.metadata[t].options_order)}}),ProtocolList=Protocol.extend({pagination:{},has_errors:!1,backParams:{},summary:{},jsonToData:function(e){this.value=e.result.data,this.metadata=e.metadata,this.pagination=_.omit(e.result,["data","has_errors"]),this.resultParams=e.resultParams,this.summary=e.summary,this.validationRules=e.validationRules,this.backParams=e.backParams,this.has_errors=1==e.result.has_errors,this.list_header=e.data_header;for(var t in e.metadata)e.metadata[t].options&&(this.metadata[t].domainValues=e.metadata[t].options),e.metadata[t].options_order&&(this.metadata[t].domainValuesOrder=e.metadata[t].options_order)}}),ProtocolDummyRecord=Protocol.extend({jsonToData:function(){this.value={},this.metadata={},this.resultParams={},this.validationRules={},this.backParams={}}}),ProtocolDummyList=Protocol.extend({pagination:{},has_errors:!1,backParams:{},summary:{},translations:{},jsonToData:function(){this.value=[],this.metadata={},this.pagination={},this.resultParams={},this.summary={},this.validationRules={},this.backParams={},this.has_errors=!1,this.list_header=""}}),Route=Class.extend({className:"Route",method:null,url:null,resultType:null,protocol:null,extraParams:{},values:{},params:{},init:function(e){var t=this;if(t.params={},t.values={},e)for(var a in e)t[a]=e[a]},setValues:function(e){var t=this,a=t.getKeys();for(var r in a){var n=a[r];t.values[n]=e[n]}},getUrl:function(e){var t=this,a=t.url,r=e?e:t.values;for(var n in r){var i="{"+n+"}",o=new RegExp(i,"g");a=a.replace(o,r[n])}return a},getParams:function(){var e=this;return jQuery.extend(e.params,e.extraParams)},getKeys:function(){var e=this,t=/\{\w+\}+/g,a=[],r=!1;do if(r=t.exec(e.url)){var n=r[0].substr(1);n=n.substr(0,n.length-1),a.push(n)}while(r);return a}});Route.factory=function(e,t){var a="Route"+Utility.pascalCase(e);if(!window[a])throw"Impossibile trovare la definizione della route "+a;var r=t?t:{};return r.className=a,new window[a](r)};var RouteList=Route.extend({method:"get",url:"/api/json/{modelName}",resultType:"list",protocol:"list"}),RouteListConstraint=RouteList.extend({url:"/api/json/{modelName}/{constraintKey}/{constraintValue}"}),RouteEdit=Route.extend({method:"get",url:"/api/json/{modelName}/{pk}/edit",resultType:"record",protocol:"record"}),RouteEditConstraint=RouteEdit.extend({url:"/api/json/{modelName}/{pk}/edit/{constraintKey}/{constraintValue}"}),RouteSearch=Route.extend({method:"get",url:"/api/json/{modelName}/search",resultType:"record",protocol:"record"}),RouteSearchConstraint=RouteSearch.extend({url:"/api/json/{modelName}/search/{constraintKey}/{constraintValue}"}),RouteInsert=Route.extend({method:"get",url:"/api/json/{modelName}/create",resultType:"record",protocol:"record"}),RouteInsertConstraint=RouteInsert.extend({url:"/api/json/{modelName}/create/{constraintKey}/{constraintValue}"}),RouteInsertHasmany=Route.extend({method:"get",url:"/api/json/{modelName}/create_has_many",resultType:"record",protocol:"record"}),RouteInsertHasmanyConstraint=RouteInsertHasmany.extend({url:"/api/json/{modelName}/create_has_many/{constraintKey}/{constraintValue}"}),RouteSave=Route.extend({method:"post",url:"/api/json/{modelName}/create",resultType:"record",protocol:"record",extraParams:{_method:"POST"}}),RouteSaveConstraint=RouteSave.extend({url:"/api/json/{modelName}/create/{constraintKey}/{constraintValue}"}),RouteUpdate=Route.extend({method:"post",url:"/api/json/{modelName}/{pk}",resultType:"record",protocol:"record",extraParams:{_method:"PUT"}}),RouteUpdateConstraint=RouteUpdate.extend({url:"/api/json/{modelName}/{pk}/{constraintKey}/{constraintValue}"}),RouteCreate=Route.extend({method:"post",url:"/api/json/{modelName}/create",resultType:"record",protocol:"record"}),RouteCreateConstraint=RouteCreate.extend({url:"/api/json/{modelName}/create/{constraintKey}/{constraintValue}"}),RouteView=Route.extend({method:"get",url:"/api/json/{modelName}/{pk}",resultType:"record",protocol:"record"}),RouteViewConstraint=RouteView.extend({url:"/api/json/{modelName}/{pk}/{constraintKey}/{constraintValue}"});RouteDelete=Route.extend({method:"post",url:"/api/json/{modelName}/{pk}",resultType:"record",protocol:"record",extraParams:{_method:"DELETE"}}),RouteMultiDelete=Route.extend({method:"post",url:"/api/json/{modelName}/deleteall",resultType:"record",protocol:"record"}),RouteSet=Route.extend({method:"post",url:"/api/json/set/{modelName}/{field}/{value}",resultType:"record",protocol:"record"}),RouteAutocomplete=RouteList.extend({method:"get",url:"/api/json/autocomplete/{modelName}",resultType:"record",protocol:"record"}),RouteCalendar=RouteList.extend({}),RouteCaptcha=Route.extend({method:"get",url:"/captchajs_img",resultType:"record",protocol:"record"}),RouteUploadfile=Route.extend({method:"post",url:"/uploadfile",resultType:"record",protocol:"record"}),RouteUpload=Route.extend({method:"post",url:"/upload",resultType:"record",protocol:"record"}),RouteViewimage=Route.extend({method:"get",url:"/viewimage/{filename}/upload/{template}",resultType:"record",protocol:"record"}),RouteDownload=Route.extend({method:"get",url:"/download/{filename}",resultType:"record",protocol:"record"}),RoutePageEdit=Route.extend({method:"get",url:"/edit/{modelName}/{pk}"}),RoutePageEditConstraint=Route.extend({method:"get",url:"/edit/{modelName}/{pk}/{constraintKey}/{constraintValue}"}),RoutePageInsert=Route.extend({method:"get",url:"/insert/{modelName}"}),RoutePageInsertConstraint=Route.extend({method:"get",url:"/insert/{modelName}/{constraintKey}/{constraintValue}"}),RoutePageView=Route.extend({method:"get",url:"/view/{modelName}/{pk}"}),RoutePageViewConstraint=Route.extend({method:"get",url:"/view/{modelName}/{pk}/{constraintKey}/{constraintValue}"}),RoutePageList=Route.extend({method:"get",url:"/list/{modelName}/{pk}"}),RoutePageListConstraint=Route.extend({method:"get",url:"/list/{modelName}/{pk}/{constraintKey}/{constraintValue}"});var Paginator=Component.extend({data:{},viewKey:null,init:function(e,t){var a=this;a.viewKey=e,a.data=t},_render:function(){var e=this;return container?void jQuery(container).html(jQuery.getTemplate(e.getTemplate(),e.data)):jQuery.getTemplate(e.getTemplate(),e.data)},_finalize:function(){var e=this;jQuery(container).find("a[crud-action]").click(function(){EventManager.trigger(jQuery(this).attr("crud-action"),{viewKey:e.viewKey})}),jQuery(container).find("select[crud-action]").change(function(){EventManager.trigger(jQuery(this).attr("crud-action"),{viewKey:e.viewKey,perPage:jQuery(this).val()})})},template:function(){return'<ul class="pagination pagination-sm hidden-md hidden-sm hidden-xs">                    <li><a crud-action="ActionFirstPage" href="javascript:void(0)">&laquo;</a></li>                    <li><a crud-action="ActionPrevPage" href="javascript:void(0)">&lt;</a></li>                    <li>                    <span style="padding:2px" >                        <span crud-label="app.pagination_total" >Tot</span>                        <b><span crud-field="total"></span></b>,                    &nbsp;&nbsp;                        <select crud-field="per_page" crud-source="pagination_steps" self style="height:24px" class="pagination-input" crud-action="actionPerPage">                                    </select>                        <span crud-label="app.pagination_per_page" >Per page</span>                    </span>                    </li>                    <li><a class="disabled" href="javascript:void(0)" crud-page_info=""> <span crud-field="current_page"></span> / <span crud-field="last_page"></span> </a></li>                    <li><a crud-action="ActionNextPage" href="javascript:void(0)">&gt;</a></li>                    <li><a crud-action="ActionLastPage" href="javascript:void(0)">&raquo;</a></li>                </ul>                <ul class="pagination pagination-sm hidden-lg hidden-xl">                    <li><a crud-action="actionFirstPage" href="javascript:void(0)">&laquo;</a></li>                    <li><a crud-action="actionPrevPage" href="javascript:void(0)">&lt;</a></li>                    <li><a class="disabled" href="javascript:void(0)" crud-page_info="">  <span crud-field="current_page"></span> / <span crud-field="last_page"></span> (<span crud-field="total"></span>)</a></li>                    <li><a crud-action="actionNextPage" href="javascript:void(0)">&gt;</a></li>                    <li><a crud-action="actionLastPage" href="javascript:void(0)">&raquo;</a></li>                </ul>';
}}),View=Component.extend({actions:[],fields:[],dummyModel:"dummy",modelName:null,renderObjs:[],data:{},type:null,defaultRenderType:null,defaultRenderMode:null,connectedObjs:{},defaultItemTemplateName:"no",keyId:null,app:null,json:null,resources:[],route:null,routeName:null,custom_actions:{},init:function(e){var t=this;this.renderObjs={},this.connectedObjs={},this.fields=JSON.parse(JSON.stringify(this.fields)),this.data=JSON.parse(JSON.stringify(this.data)),this.route=null,this._super(e),Utility.hasAttr(jQuery(t.container),"crud-inline")&&(t.template=jQuery(t.container)[0].outerHTML)},draw:function(e){var t=this,a=e?e:function(){};t.labelsContext=t.modelName,t.beforeLoadData(function(){t.loadData(function(){t.afterLoadData(function(){t._loadExternalResources(function(){t.beforeRender(function(){t._prepareContainer(function(){t._executeTraitsTemplate(),t.render(function(){t.afterRender(function(){t.beforeFinalize(function(){t.finalize(function(){t.afterFinalize(function(){return a()})})})})})})})})})})})},"delete":function(){var e=this;EventManager.off(e.keyId+"ActionFired")},setRoute:function(e){this.route=e},getRoute:function(){var e=this;if(null==e.routeName)return null;var t=function(t){var a=t.getKeys();t.values={};for(var r in a)t.values[a[r]]=e[a[r]]};return e.route||(e.route=Route.factory(e.routeName)),t(e.route),e.route},loadData:function(e){var t=this;if(t.modelName==t.dummyModel)return e();if(null===t.routeName)return e();var a=t.getRoute();t.app.waitStart("...",t.container),Server.route(a,function(r){if(t.json=r,t.app.waitEnd(t.container),r.error)return app.errorDialog(r.msg),e();var n=Protocol.factory(a.protocol);n.jsonToData(r);var i=Object.getOwnPropertyNames(n);for(var o in i)t.data[i[o]]=n[i[o]];return jQuery.langDefs=jQuery.extend(!0,r.translations,jQuery.langDefs),e()})},setId:function(e){var t=this;t.keyId=e,jQuery(t.container).attr("vkey",e)},setData:function(e){this.data=e},getFormData:function(){var e=this;return 0==e.jQe("[crud-form]").length&&e.app.log.error("Impossibile trovare la form con attributo [crud-form]"),Utility.getFormData(e.jQe("[crud-form]"))},getItemTemplate:function(e){var t=this,a=t._getRenderConfig(e),r=a.templateName?a.templateName:t.defaultItemTemplateName,n=a.labels?a.labels:{};return Template.factory(r,{labels:n,labelsContext:[t.modelName,e].join(".")})},_getRenderMode:function(e){var t=this,a=t.defaultRenderMode;return t.fields_config[e]&&t.fields_config[e].mode&&(a=t.fields_config[e].mode),a},_getRenderType:function(e){var t=this;if(t.fields_config[e]&&t.fields_config[e].type)return t.fields_config[e].type;var a=t._getRenderMode(e);return RendersDefaultConf[a]&&RendersDefaultConf[a][e]&&RendersDefaultConf[a][e].type?RendersDefaultConf[a][e].type:t.defaultRenderType},_getDefaultRenderConfig:function(e){var t=this,a={mode:t._getRenderMode(e),modelName:t.modelName};return t.defaultRenderType&&(a.type=t.defaultRenderType),t.operator&&t.operator[e]&&(a.operator=t.operator[e]),a},_getRenderConfig:function(e){var t=this,a=t._getDefaultRenderConfig(e),r=t._getRenderMode(e);return RendersDefaultConf[r]&&RendersDefaultConf[r][e]&&(a=_.extend(a,RendersDefaultConf[r][e])),t.fields_config[e]&&(a=_.extend(a,t.fields_config[e])),a},_attachEvents:function(){},_attachEvent:function(e,t){var a=this;e.triggerEvent=function(e,r,n){var i={viewKey:a.keyId,pk:t,params:r};EventManager.trigger(e,i,n)}},fireEvent:function(e){var t=this;t.app.log.warn("View.fireEvent "+e.eventName+"  view "+e.type+" not overladed")},fireToConnected:function(e){throw" fireToConnected not implemented"},_getRenderData:function(e){throw" _getRenderData not implemented"},_setKeys:function(){throw" _setKeys not implemented"},beforeLoadData:function(e){return e()},afterLoadData:function(e){return e()}});View.factory=function(e,t){var a=t?t:{},r=null;if(!window[e])throw"Impossibile trovare la definizione "+e;try{var n={},i={};for(var o in a)_.isFunction(a[o])?n[o]=a[o]:i[o]=a[o];var u=window[e].extend(n);r=new u(i),r.className=e}catch(l){throw app.log.error(e,a,l),l}return r};var CollectionView=View.extend({actions:[],_recordActions:[],_globalActions:[],_paginatorActions:[],_orderActions:[],fields_config:{},detail_fields:{},actionsLayout:"left",type:"list",defaultItemTemplate:"no",defaultRenderMode:Render.VIEW,pagination:!0,orderClass:{asc:["sorting_asc","fa","fa-angle-down"],desc:["sorting_desc","fa","fa-angle-up"]},data:{value:[],metadata:{},pagination:{},resultParams:{},summary:{},validationRules:{},backParams:{},has_errors:!1,list_header:""},init:function(e){this._recordActions=[],this._globalActions=[],this._paginatorActions=[],this._super(e)},getRender:function(e,t){var a=this;return a.renderObjs[e]&&a.renderObjs[e][t]?a.renderObjs[e][t]:null},_setKeys:function(){var e=this;e.keys=e.fields,e.keys&&0!==e.keys.length||e.data.value.length>0&&(e.keys=Object.keys(e.data.value[0]))},_renderHeaderValues:function(e){var t=this,a=t.order_fields?Object.keys(t.order_fields):[];jQuery.each(e.children("th"),function(e,r){if("left"==t.actionsLayout&&0===e);else if("right"==t.actionsLayout&&e==t.visibleKeys.length);else{var n="right"==t.actionsLayout?e:e-1,i=[t.modelName,t.visibleKeys[n],"label"].join(".");jQuery.inArray(t.visibleKeys[n],a)>=0?jQuery(this).attr("crud-order_field",t.visibleKeys[n]):jQuery(r).find("[crud-element]").attr("crud-label",i).html(t.visibleKeys[n]),jQuery(r).addClass("field-"+t.visibleKeys[n])}})},_renderHeaderActions:function(e){var t=this,a="right"!=t.actionsLayout?0:t.visibleKeys.length,r=Component.parseHtml(t.checkAllTemplate());jQuery(e.children()[a]).html(r),jQuery(e.children()[a]).find('[crud-button="checkAll"]').change(function(){var e=jQuery(this).prop("checked");jQuery(t.container).find('input[name="check_row"]').prop("checked",e)})},_renderHeader:function(){var e=this,t=e.jQe("[crud-view_row_headers]"),a=Component.parseHtml(e.headerTemplate()),r=Component.parseHtml(e.orderTemplate()),n=e.order_fields?Object.keys(e.order_fields):[];"left"==e.actionsLayout&&t.append(a.html());for(var i in e.visibleKeys)jQuery.inArray(e.visibleKeys[i],n)>=0?t.append(r.html()):t.append(a.html());"right"==e.actionsLayout&&t.append(a.html()),e._renderHeaderValues(t),e._renderHeaderActions(t)},_renderFooter:function(){var e=this;if(!e.data.summary||0==Object.keys(e.data.summary).length)return void e.jQe("tfoot").remove();for(var t=e.jQe("[crud-view_row_footer]"),a=t.find("td"),r=0;r<e.visibleKeys.length;r++)a.clone().appendTo(t);var n="#"+e.prefixTemplateClass+"_view_summary_field_tpl";jQuery.each(t.children("td"),function(t,a){if("left"==e.actionsLayout&&0===t);else if("right"==e.actionsLayout&&t==e.visibleKeys.length);else{var r="right"==e.actionsLayout?t:t-1,i=e.visibleKeys[r];if(e.data.summary[i]&&e.summary_fields)for(var o in e.summary_fields[i]){var u=e.summary_fields[i][o],l=parseFloat(e.data.summary[i][o]);isNaN(u.decimal)||(l=l.toFixed(u.decimal));var d=jQuery.getTemplate(n,{operation:e.app.translate("general-summary_"+o),value:l+(u.symbol?" "+u.symbol:"")});jQuery(a).append(d)}}})},_attachEvents:function(e){var t=this;for(var a in t.renderObjs[e]){var r=t.renderObjs[e][a],n=t.data.value[e].id;t._attachEvent(r,n)}},_attachDetailEvents:function(){var e=this;jQuery(e.container).find("[crud-detail_button]").unbind("click"),jQuery(e.container).find("[crud-detail_button]").click(function(){var t=jQuery(this).attr("crud-key"),a=parseInt(jQuery(this).attr("crud-rowdata_index")),r=parseInt(jQuery(this).attr("crud-isopen")),n=jQuery(this).closest("tr"),i=t+"_"+a;if(r){var o=jQuery(n).closest("tbody").find('[crud-detail_row="'+i+'"]');return o.remove(),void jQuery(this).attr("crud-isopen",0)}jQuery(this).attr("crud-isopen",1);var u=e.data.value[a],l={detail_row_key:i,colspan:e.visibleKeys.length+1},d=jQuery.getTemplate("#default_view_detail_field_tpl",l);n.after(d);var o=jQuery(n).closest("tbody").find('[crud-detail_row="'+i+'"]');jQuery(o).find("[crud-detail_title]").html(e.app.translate(e.modelName+"-"+t));var s=o.find("[crud-detail_container]"),c=e.detail_fields[t].func;c(s,u)})},fireToConnected:function(e){},getChecked:function(){var e=this,t=[];return jQuery.each(jQuery(e.container).find('input[name="check_row"]:checked'),function(){t.push(jQuery(this).attr("crud-pk"))}),t},_renderInfoHeader:function(){var e=this;e.jQe("[crud-list_header]").html(e.data.list_header)},render:function(e){var t=this;if(t.visibleKeys.length&&delete t.visibleKeys,t.visibleKeys=[],t._renderInfoHeader(),0===t.data.value.length)t._renderZeroResult();else{t._setKeys(),t._setVisibleKeys(),t._renderHeader(),t._renderFooter(),t._createGrid(),t._setActions(),t._executeTraitsTemplate();for(var a in t.data.value)t._renderRow(a)}return e()},_renderRow:function(e){var t=this,a=t.jQe("[crud-view_row_elements]").get(e);for(var r in t.visibleKeys){var n=t.visibleKeys[r],i=r,o=null;"right"!=t.actionsLayout&&i++,o=jQuery(jQuery(a).find("[crud-cell]").get(i)),o.addClass("field-"+n);var u=t.getItemTemplate(n);o.html(u.html()),t.detail_fields[n]&&(o.html(jQuery.getTemplate("#default_view_list_detail_tpl")),o.find("[crud-rowdata_index]").attr("crud-rowdata_index",e),o.find("[crud-key]").attr("crud-key",n),o=o.find("[crud-detail_container]"));var l=t._createRender(e,n,Template.getRenderContainer(o));l.draw()}var d="right"!=t.actionsLayout?0:t.visibleKeys.length;jQuery(jQuery(a).find("[crud-cell]").get(d)).attr("crud-col_actions","")},finalize:function(e){var t=this;for(var a in t.data.value)t._attachEvents(a);t._attachDetailEvents(),t._renderPagination(),t._renderSingleActions(),t._renderGlobalActions(),t._renderOrderActions();var r="right"!=t.actionsLayout?0:t.visibleKeys.length;return t._hasNeedSelectionAction()||t._hasRecordActions()?t._hasNeedSelectionAction()||(t.jQe('[crud-button="checkAll"]').remove(),t.jQe().find('input[name="check_row"]').remove()):(t.jQe("table").find("tr").find("td:eq("+r+")").remove(),t.jQe("table").find("tr").find("th:eq("+r+")").remove()),e()},_setActions:function(){var e=this;e._recordActions=[],e._globalActions=[],e._paginatorActions=[],e._orderActions=[];var t=e.data.value.length;for(var a in e.actions){var r=null,n=e.actions[a];if(r=e.custom_actions[n]?e.custom_actions[n]:window[n],!r)throw e.app.log.debug("custom_actions",e.custom_actions),"definizione azione ("+n+" non trovata! ";if(["collection","record"].indexOf(r.prototype.type)==-1)throw"tipo azione con definito! "+actionTpl.type;if("collection"==r.prototype.type){var i=e._createAction(null,n);i.objectId="g"+e._globalActions.length,e._globalActions.push(i)}else if("record"==r.prototype.type)continue}for(var o=0;o<t;o++){e._recordActions.push([]);for(var a in e.actions){var r=null,n=e.actions[a];if(r=e.custom_actions[n]?e.custom_actions[n]:window[n],!r)throw"definizione azione ("+n+" non trovata! ";if(["collection","record"].indexOf(r.prototype.type)==-1)throw"tipo azione con definito! "+actionTpl.type;if("collection"!=r.prototype.type&&"record"==r.prototype.type){var i=e._createAction(o,n);i.objectId="r"+o+"_"+e._recordActions[o].length,e._recordActions[o].push(i)}}}if(e.pagination){var u=["ActionPrevPage","ActionNextPage","ActionFirstPage","ActionLastPage","ActionPerPage"];for(var a in u){var i=e._createAction(null,u[a]);i.objectId="p"+e._paginatorActions.length,e._paginatorActions.push(i)}}e.jQe('[crud-action="ActionOrder"]').each(function(){var t=e._createAction(null,"ActionOrder"),a=jQuery(this).attr("crud-order_field");t.objectId="o"+e._orderActions.length,t.orderField=e.order_fields[a]?e.order_fields[a]:a,e.data.metadata.order_field==t.orderField&&(t.orderDirection=e.data.metadata.order_direction),t.text=t.orderField,t.container=jQuery(this),e._orderActions.push(t)})},_setVisibleKeys:function(){var e=this;for(var t in e.keys)e.fields_config[e.keys[t]]&&"hidden"==e.fields_config[e.keys[t]].type||e.visibleKeys.push(e.keys[t])},_renderZeroResult:function(){var e=this,t=e.jQe("[crud-view_row_elements]");t.html("<td>"+e.app.translate("app.norecordfound")+"</td>")},_getPaginationData:function(){var e=this,t={current_page:1,last_page:1,per_page:e.data.value.length,pagination_steps:{},total:e.data.value.length,from:1,to:e.data.value.length};return t.pagination_steps[e.data.value.length]=e.data.value.length,t=jQuery.extend(t,e.data.pagination)},_renderPagination:function(){var e=this;if(!e.pagination)return void e.jQe("[crud-view_pagination]").remove();var t=e._getPaginationData(),a=Component.parseHtml(e.paginatorTemplate());e.jQe().find("[crud-view_pagination]").html(jQuery.getTemplate(a,t));var r=e.jQe().find("[crud-view_pagination]");for(var n in e._paginatorActions){var i=e._paginatorActions[n],o="[crud-"+Utility.snakeCase(i.actionName)+"]";i.pagination=t,i.container=r.find(o),i.draw()}},_createRender:function(e,t,a){var r=this,n={},i=r._getRenderConfig(t);i.container=a;var o=Render.factory(t,_.extend(i,n));r.renderObjs[e]||(r.renderObjs[e]={}),r.renderObjs[e][t]=o,t in r.data.value[e]&&(o.value=r.data.value[e][t]),o.modelData=r.data.value[e];var u=o.metadata?o.metadata:{};r.data.metadata&&r.data.metadata[t]&&(u=_.extend(u,r.data.metadata[t])),i.metadata&&(u=_.extend(u,i.metadata));var l=o.metadata?o.metadata:{};for(var d in u)l[d]=u[d];return o.setMetadata(l),o},_createGrid:function(){var e=this,t=e.data.value.length,a=e.visibleKeys.length,r=Component.parseHtml(e.cellTemplate());r.children(0).attr("crud-cell","");for(var n=e.jQe().find("[crud-view_row_elements]"),i=0;i<a+1;i++)n.append(r.html());if(0==e.jQe().find("[crud-view_elements]").length)throw"Impossibile trovare il marcatore crud-view_elements";for(var i=1;i<t;i++)n.clone().prependTo(e.jQe().find("[crud-view_elements]"))},_createAction:function(e,t){var a=this,r=null;try{return r=a.custom_actions[t]?new a.custom_actions[t]:new window[t],null===e?r.modelData=a.data.value:r.modelData=a.data.value[e],r.actionName=t,r.view=a,r}catch(n){a.app.log.error("Impossibile creare azione "+t+" "+n)}},_renderSingleActions:function(){var e=this;for(var t in e._recordActions){var a=jQuery(e.jQe().find("[crud-view_row_elements]").get(t));a.find("[crud-col_actions]").html(Component.parseHtml(e.recordActionTemplate()).html());var r=jQuery(a.find("[crud-record_actions]"));for(var n in e._recordActions[t]){r.append(e._recordActions[t][n].html());var i=jQuery(r.find("[crud-render_action]").get(n));i.attr("crud-inline",1),e._recordActions[t][n].container=i,e._recordActions[t][n].draw()}var o=Component.parseHtml(e.checkTemplate());$(o).find("[crud-pk]").attr("crud-pk",e.data.value[t].id),jQuery(jQuery(a)).find("[crud-col_actions]").prepend(o)}},_renderGlobalActions:function(){var e=this;e.jQe("[crud-view_collection_actions]").each(function(){var t=jQuery(this);for(var a in e._globalActions){e._globalActions[a].orig_html||(e._globalActions[a].orig_html=e._globalActions[a].html());var r=e._globalActions[a].orig_html;t.append(r);var n=jQuery(t.find("[crud-render_action]").get(a));n.attr("crud-inline",1),e._globalActions[a].container=n,e._globalActions[a].draw()}})},_renderOrderActions:function(){var e=this;for(var t in e._orderActions)e._orderActions[t].draw()},_hasNeedSelectionAction:function(){var e=this;for(var t in e._globalActions)if(e._globalActions[t].needSelection)return!0;return!1},_hasRecordActions:function(){var e=this;if(0==e.actions.length)return!1;for(var t in e.actions){var a=e.actions[t];if(e.custom_actions[a]&&"record"==e.custom_actions[a].prototype.type)return!0;if(window[a]&&"record"==window[a].prototype.type)return!0}return!1},numRecordActions:function(){var e=this,t=0;if(0==e.actions.length)return t;for(var a in e.actions){var r=e.actions[a],n=e.custom_actions[r]?e.custom_actions[r]:window[r];n&&("record"!=n.prototype.type||n.prototype.multiAction||t++)}return t},numMultiRecordActions:function(){var e=this,t=0;if(0==e.actions.length)return t;for(var a in e.actions){var r=e.actions[a],n=e.custom_actions[r]?e.custom_actions[r]:window[r];n&&"record"==n.prototype.type&&n.prototype.multiAction&&t++}return t}}),RecordView=View.extend({_pkName:"id",_pkValue:null,_actions:[],actions:[],type:"record",defaultItemTemplateName:"left",fields_config:{},data:{value:{},metadata:{},validationRules:{},backParams:{}},getViewData:function(){var e=this,t={};for(var a in e.renderObjs[0])t[a]=e.renderObjs[0][a].getValue();return t},getRenderValue:function(e){var t=this;return t.getRender(e)?t.getRender(e).getValue():null},getRender:function(e){var t=this;return t.renderObjs[0][e]?t.renderObjs[0][e]:null},resetForm:function(){var e=this;for(var t in e.renderObjs[0]){var a=e.renderObjs[0][t];a.clear()}},render:function(e){var t=this;t._setKeys(),t._setActions();for(var a in t.keys)t._renderElement(t.keys[a]);e()},finalize:function(e){var t=this;t._renderActions(),t._attachEvents();for(var a in t.keys)t._connectFields(t.keys[a]);e()},_setActions:function(){var e=this;e._actions=[];for(var t in e.actions){var a=null,r=e.actions[t];if(a=e.custom_actions[r]?e.custom_actions[r]:window[r],!a)throw"definizione azione ("+r+" non trovata! ";if(["collection","record"].indexOf(a.prototype.type)==-1)throw"tipo azione con definito! "+a.prototype.type;var n=e._createAction(r);e._actions.push(n)}},_createAction:function(e){var t=this,a=null;try{a=t.custom_actions[e]?new t.custom_actions[e]:new window[e]}catch(r){t.app.log.error("Impossibile creare azione "+e+" "+r)}return a.modelData=t.data.value,a.actionName=e,a.view=t,a},_setKeys:function(){var e=this;if(e.app.log.debug("ViedEdit._setKeys",e.fields),e.groups){e.keys=[];for(var t in e.groups)e.keys=e.keys.concat(e.groups[t].fields)}else e.keys=e.fields;0===e.keys.length&&e.data.value&&(e.keys=Object.keys(e.data.value))},_renderHidden:function(e){var t=this,a=jQuery.createDynamicContainer(),r=t._createRender(a,e);r.draw(),t.jQe().find("[crud-hidden_fields]").append(a.html()),a.remove();var n=t.jQe().find("[crud-hidden_fields]").children().length,i=jQuery(t.jQe().find("[crud-hidden_fields]").children()[n-1]);r.container=i},_renderObjectElement:function(e){var t=this,a=t.getItemTemplate(e),r=t._getGroup(e),n=null,i=null;if(null===r?(t.jQe("[crud-view_elements]").append(a.html()),i=t.jQe("[crud-view_elements]").children().length,n=jQuery(t.jQe("[crud-view_elements]").children().get(i-1))):(t.jQe().find("[crud-view_elements]").find('[crud-group="'+r+'"]').append(a.html()),i=t.jQe().find("[crud-view_elements]").find('[crud-group="'+r+'"]').children().length,n=jQuery(t.jQe().find("[crud-view_elements]").find('[crud-group="'+r+'"]').children().get(i-1))),1!=n.length)throw"View con "+r+" itemContainer vuoto o non univoco :"+n.length;n.attr("crud-render_container",e);var o=t._createRender(Template.getRenderContainer(n),e);o.draw()},_getGroup:function(e){var t=this;for(var a in t.groups)if(jQuery.inArray(e,t.groups[a].fields)>=0)return a;return null},_renderElement:function(e){var t=this,a=t.fields_config[e]?t.fields_config[e].type:"input";return"hidden"==a?void t._renderHidden(e):void t._renderObjectElement(e)},_createRender:function(e,t){var a=this,r={},n=a._getRenderConfig(t);n.container=e,n.container.addClass("field-"+t);var i=Render.factory(a._getFieldName(t),_.extend(n,r));i||a.app.log.error("ViewRecord._createRender failed",t),a.renderObjs[0]||(a.renderObjs[0]={}),a.renderObjs[0][t]=i,t in a.data.value&&(i.value=a.data.value[t]),i.modelData=a.data.value;var o=a.data.metadata&&a.data.metadata[t]?a.data.metadata[t]:{};n.metadata&&(o=_.extend(o,n.metadata));var u=i.metadata?i.metadata:{};for(var l in o)u[l]=o[l];return i.setMetadata(u),i},_renderActions:function(){var e=this;if(0==e.actions.length||e.isHasMany)return void e.jQe().find("[crud-view_action]").remove();var t=e.jQe("[crud-view_action]");t.html("");for(var a in e._actions){t.append(e._actions[a].html());var r=jQuery(t.find("[crud-render_action]").get(a));r.attr("crud-inline",1),e._actions[a].container=r,e._actions[a].draw()}},_getFieldName:function(e){return e},_attachEvents:function(){var e=this;for(var t in e.renderObjs[0]){var a=e.renderObjs[0][t],r=e.data.value.id;e._attachEvent(a,r)}},_connectFields:function(e){var t=this;if(t.renderObjs[0][e]&&t.renderObjs[0][e].dependencies){var a=t.renderObjs[0][e].dependencies;for(var r in a.sources){var n=a.sources[r];t.connectedObjs[n]||(t.connectedObjs[n]=[]),t.connectedObjs[n].push(e),t.renderObjs[0][n]._emitEvent("change",t.data.value[n])}}},fireToConnected:function(e){var t=this;for(var a in t.connectedObjs){var r=a;if(t.isHasMany&&(r=t._getFieldName(r)),r==e.key)for(var n in t.connectedObjs[a]){var i=t.connectedObjs[a][n];t.app.log.debug("ViewRecord.fireToConnected evt",e,"rObject",t.renderObjs[0][i]);var o=t.renderObjs[0][i].dependencies.func;if(!_.isFunction(o))throw"func is not function in object "+i;var u=jQuery(t.container).find(t.renderObjs[0][i].container);o.apply(t,[e,u])}}}}),ViewList=CollectionView.extend({visibleKeys:[],keys:[],routeName:"list",defaultRenderType:"text",fields_config:{},init:function(e){this._super(e)},template:function(){return'<div class="panel panel-default panel-body model-list">                    <div crud-list_header></div>                    <div crud-hidden_fields></div>                    <div class="clearfix">                        <div class="col col-md-5 col-xs-12 hidden-xs list-actions" crud-view_collection_actions></div>                        <div class="col col-md-7 col-xs-12 list-pagination" crud-view_pagination></div>                    </div>                    <hr/>                    <div class="table-responsive">                        <table class="table table-striped table-condensed table-hover table-bordered table-vertical-middle nomargin">                            <thead>                                <tr crud-view_row_headers>                                </tr>                            </thead>                            <tbody crud-view_elements>                                <tr crud-view_row_elements>                                </tr>                            </tbody>                            <tfoot>                                <tr crud-view_row_footer><td></td></tr>                            </tfoot>                        </table>                    </div>                    <hr/>                    <div class="clearfix">                        <div class="col col-md-5 col-xs-12 list-actions" crud-view_collection_actions></div>                        <div class="col col-md-7 col-xs-12 list-pagination" crud-view_pagination></div>                    </div>                </div>'},recordActionTemplate:function(){return'<div crud-record_actions class="btn-group" role="group"></div>'},headerTemplate:function(){return"<th>                    <span crud-element></span>                </th>"},orderTemplate:function(){return'<th class="sorting" crud-action="ActionOrder" crud-order_field=""></th>'},cellTemplate:function(){return"<td ></td>"},checkAllTemplate:function(){return'<input type="checkbox" crud-button="checkAll" title="Seleziona tutti">'},checkTemplate:function(){return'<span class="pull-left" ><input crud-pk="" type="checkbox" name="check_row">&nbsp;</span>'},paginatorTemplate:function(){return'<ul class="list-inline hidden-md hidden-sm hidden-xs">                    <li crud-action_first_page><a crud-first_page href="javascript:void(0)">&laquo;</a></li>                    <li crud-action_prev_page><a crud-prev_page href="javascript:void(0)">&lt;</a></li>                    <li>                    <span style="padding:2px" >                        <span crud-keytranslate="general-pagination_total" >Tot</span>                        <b><span crud-field="total"></span></b>,                    &nbsp;&nbsp;                        <span crud-action_per_page></span>                        <!--<select crud-action_per_page crud-field="per_page" crud-source="pagination_steps" self style="height:24px" class="pagination-input" crud-action="actionPerPage">-->            <!---->                        <!--</select>-->                        <span crud-keytranslate="general-pagination_per_page" >Per pagina</span>                    </span>                    </li>                    <li><a class="disabled" href="javascript:void(0)" crud-page_info=""> <span crud-field="current_page"></span> / <span crud-field="last_page"></span> </a></li>                    <li crud-action_next_page ><a crud-next_page href="javascript:void(0)">&gt;</a></li>                    <li crud-action_last_page><a crud-last_page href="javascript:void(0)">&raquo;</a></li>                            </ul>                <ul class="pagination pagination-sm hidden-lg hidden-xl">                    <li crud-action_first_page><a crud-action="ActionFirstPage" href="javascript:void(0)">&laquo;</a></li>                    <li crud-action_prev_page><a crud-action="ActionPrevPage" href="javascript:void(0)">&lt;</a></li>                    <li><a class="disabled" href="javascript:void(0)" crud-page_info="">  <span crud-field="current_page"></span> / <span crud-field="last_page"></span> (<span crud-field="total"></span>)</a></li>                    <li crud-action_next_page><a crud-action="ActionNextPage" href="javascript:void(0)">&gt;</a></li>                    <li crud-action_last_page><a crud-action="ActionLastPage" href="javascript:void(0)">&raquo;</a></li>                            </ul>'}}),ViewEdit=RecordView.extend({visibleKeys:[],keys:[],defaultRenderMode:Render.EDIT,type:"edit",routeName:"edit",init:function(e){this.resources=["jquery.form.js","jquery.validate/jquery.validate.js"],this._super(e),this.visibleKeys=[],this.keys=[],this.renderObjs[0]={},this.defaultRenderType="input"},valid:function(){var e=this;try{return e.jQe("[crud-form]").valid()}catch(t){e.app.log.error("error find [crud-form] "+t)}return!1},_setValidationRules:function(){var e=this,t=jQuery(e.container).find("form");if(0!=t.length){var a={};for(var r in e.data.validationRules){e.app.log.info("Validation rule key "+r);var n={},i=e.data.validationRules[r],o=i?i.split("|"):[];for(var u in o){var l=o[u];try{var d=l.split(":").length>0?l.split(":")[0]:l;if(d="V"+d,window[d]){if("Vsometimes"==d){var s=_.clone(o);s.splice(0,1);var c=new window[d](t);n=jQuery.extend(n,c.get(r,s));break}var c=new window[d](t);n=jQuery.extend(n,c.get(r,l))}else e.app.log.warn(d+" non implementata")}catch(p){e.app.log.error(p)}}a[r]=n}t.validate({rules:a})}},template:function(){return'<div class="well" crud-edit-main>                    <div crud-alert class="alert alert-success hide"></div>                    <form crud-form class="model-edit">                        <div crud-hidden_fields></div>                        <div crud-view_elements>                        </div>                        <div crud-view_action >                            <div crud-field="data" crud-self>                            </div>                        </div>                    </form>                </div>'}}),ViewHasmanyEdit=ViewEdit.extend({visibleKeys:[],keys:[],hasManyIndex:null,routeName:"edit",prefixKey:"",init:function(e){this.resources=["jquery.form.js","jquery.validate/jquery.validate.js"],this._super(e),this.visibleKeys=[],this.keys=[],this.type="edit",this.renderObjs[0]={},this.defaultRenderType="input"},_getFieldName:function(e){var t=this,a=t.prefixKey+e;return a+=null===t.hasManyIndex?"[]":"["+t.hasManyIndex+"]"},valid:function(){return jQuery(this.container).find("form").valid()},_setValidationRules:function(){var e=this,t=jQuery(e.container).find("form");if(0!=t.length){var a={};for(var r in e.data.validationRules){e.app.log.info("Validation rule key "+r);var n={},i=e.data.validationRules[r],o=i?i.split("|"):[];for(var u in o){var l=o[u];try{var d=l.split(":").length>0?l.split(":")[0]:l;if(d="V"+d,window[d]){if("Vsometimes"==d){var s=_.clone(o);s.splice(0,1);var c=new window[d](t);n=jQuery.extend(n,c.get(r,s));break}var c=new window[d](t);n=jQuery.extend(n,c.get(r,l))}else e.app.log.warn(d+" non implementata")}catch(p){e.app.log.error(p)}}a[r]=n}t.validate({rules:a})}},template:function(){return'<div class="well" crud-edit-main>                <div crud-alert class="alert alert-success hide"></div>                                <div crud-hidden_fields></div>                <div crud-view_elements>                                    </div>                <div crud-view_action >                    <div crud-field="data" crud-self>                        </div>                </div>                            </div>'}}),ViewInsert=ViewEdit.extend({type:"insert",routeName:"insert"}),ViewSearch=RecordView.extend({routeName:"search",type:"search",defaultRenderMode:Render.SEARCH,init:function(e){this._super(e),this.defaultRenderType="input",this.renderObjs[0]={}},getParams:function(){var e=this,t=jQuery(e.container).find("[crud-form]");if(0===t.length)throw"impossibile trovare il form con attributo [crud-form] in "+e.container;return t.serializeAssoc()},finalize:function(e){var t=this;t._super(function(){return 0===t.keys.length&&jQuery(t.container).remove(),e()})},template:function(){return'<div class="well search-well">                    <form crud-form class="model-search">                        <div crud-hidden_fields></div>                        <div class="search-row" crud-view_elements>                        </div>                        <div class="clearfix"></div>                        <hr class=""/>                        <div crud-view_action>                            <div crud-field="data" crud-self>                            </div>                        </div>                    </form>                </div>'}}),ViewView=RecordView.extend({routeName:"view",defaultRenderType:"text",defaultRenderMode:Render.VIEW,type:"view",template:function(){return'<div class="well model-view">                    <div crud-hidden_fields></div>                    <div crud-view_elements>                    </div>                    <div crud-view_action >                        <div crud-field="data" crud-self>                                                   </div>                    </div>                </div>'}}),ViewCalendar=ViewList.extend({calendarContainer:null,routeName:"calendar",resources:["fullcalendar-3.8.0/fullcalendar.css","fullcalendar-3.8.0/lib/moment.min.js","fullcalendar-3.8.0/fullcalendar.js"],render:function(e){return e()},finalize:function(e){var t=this;return t.jQe().find("[crud-calendar]").fullCalendar(t.calendar_options),t.calendarContainer=t.jQe().find("[crud-calendar]"),t.loadEvents(),e()},loadEvents:function(){var e=this;e.jQe().find("[crud-calendar]").fullCalendar("removeEvents");var t=[];for(var a in e.data.value){var r=e.data.value[a],n="green",i="white",o="notitle";if(e.backgroundColor){var u={},l=e.backgroundColor.toString().match(/function\s*\w*\s*\((.*?)\)/)[1].split(/\s*,\s*/);for(var d in l)u[l[d]]=r[l[d]];n=e.backgroundColor.apply(e,_.values(u))}if(e.textColor){var u={},l=e.textColor.toString().match(/function\s*\w*\s*\((.*?)\)/)[1].split(/\s*,\s*/);for(var d in l)u[l[d]]=r[l[d]];i=e.textColor.apply(e,_.values(u))}if(_.isFunction(e.title)){var u={},l=e.title.toString().match(/function\s*\w*\s*\((.*?)\)/)[1].split(/\s*,\s*/);for(var d in l)u[l[d]]=r[l[d]];o=e.title.apply(e,_.values(u))}else o=r[e.title];if(r[e.data_inizio]){var s={id:r[e.id]?model.data[e.id]:r.id,title:o,start:r[e.data_inizio],end:r[e.data_fine]?r[e.data_fine]:null,backgroundColor:n,textColor:i,jsondata:r};t.push(s)}else e.app.log.warn("data evento non valida. Scartato:",r)}e.app.log.info("aggiunti eventi ",t),e.jQe().find("[crud-calendar]").fullCalendar("addEventSource",t)},dayClick:function(e,t,a){},eventClick:function(e,t,a){},template:function(){return'<div class="well model-calendar">                    <div crud-hidden_fields></div>                    <div crud-view_elements>                        <div crud-calendar>                        </div>                    </div>                    <div crud-view_action class="hide">                        <div crud-field="data" crud-self>                                                   </div>                    </div>                </div>';
}}),CustomCollectionView=CollectionView.extend({render:function(e){for(var t=this,a=(t.jQe("[crud-view_elements]"),t.jQe("[crud-view_row_elements]")),r=1;r<t.data.value.length;r++){var n=a.clone();a.after(n)}var i=t._getPaginationData();t.jQe("[crud-pagination]").each(function(){jQuery(this).html(Component.parseHtml(t.paginatorTemplate(),i))}),t._setActions(),e()},finalize:function(e){var t=this;return 0==t.data.value.length?e():(jQuery.each(t.jQe("[crud-view_row_elements]"),function(e){var a=e;jQuery.each(jQuery(this).find("[crud-render]"),function(e){var r=jQuery(this).attr("crud-render"),n=t._createRender(a,r,jQuery(this));n.draw()}),jQuery.each(jQuery(this).find("[crud-field]"),function(e){var r=jQuery(this).attr("crud-field"),n=t.data.value[a][r];(n instanceof Array||n instanceof Object)&&(n=JSON.stringify(n)),["INPUT","SELECT","TEXTAREA"].indexOf(jQuery(this).prop("tagName"))>=0?jQuery(this).val(n):jQuery(this).html(n)})}),t._renderRecordActions(),t._renderGlobalActions(),t._renderPaginationActions(),t._renderOrderActions(),void e())},_renderRecordActions:function(){var e=this;jQuery.each(e.jQe("[crud-view_row_elements]"),function(t){jQuery(this);for(var a in e._recordActions[t]){var r=e._recordActions[t][a];r.draw()}})},_renderGlobalActions:function(){var e=this;for(var t in e._globalActions){var a=e._globalActions[t];a.draw()}},_renderPaginationActions:function(){var e=this,t=e.jQe().not("[crud-view_row_elements]");for(var a in e._paginatorActions){var r=e._paginatorActions[a];r.container=jQuery(t).find('[crud-action="'+r.actionName+'"]'),r.pagination=e.data.pagination,r.draw()}},_setActions:function(){var e=this;e._recordActions=[],e._globalActions=[],e._paginatorActions=[];var t=["ActionPrevPage","ActionNextPage","ActionFirstPage","ActionLastPage","ActionPerPage"];if(e.jQe("[crud-view_row_elements]").each(function(){var t=e._recordActions.length;e._recordActions.push([]),jQuery(this).find("[crud-action]").each(function(){var a=null,r=jQuery(this).attr("crud-action");if(a=e.custom_actions[r]?e.custom_actions[r]:window[r],!a)throw"definizione azione ("+r+" non trovata! ";if(["collection","record"].indexOf(a.prototype.type)==-1)throw"tipo azione con definito! "+a.prototype.type;if("record"==a.prototype.type){var n=e._createAction(t,r);n.objectId="r"+t+"_"+e._recordActions[t].length,n.container=jQuery(this),e._recordActions[t].push(n)}})}),e.jQe("[crud-action]").each(function(){var a=jQuery(this).attr("crud-action");if(0==jQuery(this).parents("[crud-view_row_elements]").length&&t.indexOf(a)<0){var r=null;if(r=e.custom_actions[a]?e.custom_actions[a]:window[a],!r)throw e.app.log.debug("custom_actions",e.custom_actions),"definizione azione ("+a+" non trovata! ";if(["collection","record"].indexOf(r.prototype.type)==-1)throw"tipo azione con definito! "+actionTpl.type;if("collection"==r.prototype.type){var n=e._createAction(null,a);if("ActionOrder"==a){var i=jQuery(this).attr("crud-order_field");n.objectId="o"+e._orderActions.length,n.orderField=i,e.data.metadata.order_field==n.orderField&&(n.orderDirection=e.data.metadata.order_direction),n.text=n.orderField,n.container=jQuery(this),e._orderActions.push(n)}else n.objectId="g"+e._globalActions.length,n.container=jQuery(this),e._globalActions.push(n)}else"record"==r.prototype.type&&e.app.log.debug("attenzione trovata RecordAction "+a+" fuori dal contesto [crud-view_row_elements]")}}),e.pagination)for(var a in t){var r=e._createAction(null,t[a]);r.objectId="p"+e._paginatorActions.length,e._paginatorActions.push(r)}}}),CustomRecordView=RecordView.extend({render:function(e){var t=this;t.app.log.debug("CustomRecordView"),t._setActions(),e()},finalize:function(e){var t=this;return jQuery.each(t.jQe("[crud-render]"),function(e){var a=jQuery(this).attr("crud-render"),r=t._createRender(jQuery(this),a);r.draw()}),jQuery.each(t.jQe("[crud-field]"),function(e){var a=jQuery(this).attr("crud-field"),r=t.data.value[a];(r instanceof Array||r instanceof Object)&&(r=JSON.stringify(r)),["INPUT","SELECT","TEXTAREA"].indexOf(jQuery(this).prop("tagName"))>=0?(jQuery(this).val(r),jQuery(this).attr("name",a)):jQuery(this).html(r)}),t._renderActions(),e()},_setActions:function(){var e=this;e._actions=[],e.jQe("[crud-action]").each(function(){var t=null,a=jQuery(this).attr("crud-action");if(e.app.log.debug("_setActions found "+a),t=e.custom_actions[a]?e.custom_actions[a]:window[a],!t)throw"definizione azione ("+a+" non trovata! ";if(["collection","record"].indexOf(t.prototype.type)==-1)throw"tipo azione con definito! "+t.prototype.type;var r=e._createAction(a);r.container=jQuery(this),e._actions.push(r)})},_renderActions:function(){var e=this;for(var t in e._actions){var a=e._actions[t];a.draw()}}}),ViewListCustom=CustomCollectionView.extend({visibleKeys:[],keys:[],routeName:"list",paginatorTemplate:function(){return'<ul class="list-inline hidden-md hidden-sm hidden-xs">                    <li ><a class="btn btn-xs btn-default" crud-action="ActionFirstPage" crud-inline>&laquo;</a></li>                    <li><a class="btn btn-xs btn-default" crud-action="ActionPrevPage" crud-inline>&lt;</a></li>                    <li>                    <span style="padding:2px" >                        <span crud-label="app.pagination_total" >Tot</span>                        <b><span crud-field="total"></span></b>,                    &nbsp;&nbsp;                        <span crud-action="ActionPerPage"></span>                        <!--<select crud-action_per_page crud-field="per_page" crud-source="pagination_steps" self style="height:24px" class="pagination-input" crud-action="actionPerPage">-->            <!---->                        <!--</select>-->                        <span crud-label="app.pagination_per_page" >Per pagina</span>                    </span>                    </li>                    <li><a class="disabled" href="javascript:void(0)" crud-page_info=""> <span crud-field="current_page"></span> / <span crud-field="last_page"></span> </a></li>                    <li><a class="btn btn-xs btn-default" crud-action="ActionNextPage" crud-inline>&gt;</a></li>                    <li><a class="btn btn-xs btn-default" crud-action="ActionLastPage" crud-inline>&raquo;</a></li>                            </ul>                <ul class="pagination pagination-sm hidden-lg hidden-xl">                    <li><a crud-action="ActionFirstPage" href="javascript:void(0)">&laquo;</a></li>                    <li><a crud-action="ActionPrevPage" href="javascript:void(0)">&lt;</a></li>                    <li><a class="disabled" href="javascript:void(0)" crud-page_info="">  <span crud-field="current_page"></span> / <span crud-field="last_page"></span> (<span crud-field="total"></span>)</a></li>                    <li><a crud-action="ActionNextPage" href="javascript:void(0)">&gt;</a></li>                    <li><a crud-action="ActionLastPage" href="javascript:void(0)">&raquo;</a></li>                            </ul>'}}),ViewEditCustom=CustomRecordView.extend({resources:["jquery.form.js","jquery.validate/jquery.validate.js"],visibleKeys:[],keys:[],hasManyIndex:null,routeName:"edit",valid:function(){var e=this;try{return e.jQe("[crud-form]").valid()}catch(t){e.app.log.error("error find [crud-form] "+t)}return!1}}),ViewInsertCustom=ViewEditCustom.extend({routeName:"insert",type:"insert"}),ViewSearchCustom=CustomRecordView.extend({resources:["jquery.form.js","jquery.validate/jquery.validate.js"],visibleKeys:[],keys:[],routeName:"search",getParams:function(){var e=this,t=jQuery(e.container).find("[crud-form]");if(0===t.length)throw"impossibile trovare il form search in "+e.container;return t.serializeAssoc()}}),ViewViewCustom=CustomRecordView.extend({visibleKeys:[],keys:[],type:"view",routeName:"view",defaultRenderType:"text",defaultRenderMode:Render.VIEW}),RendersDefaultConf={view:{}};Conf.extend=function(e,t){var a=jQuery.extend(!0,{},e),r=jQuery.extend(!0,{},t);for(var n in r)if("fields_config"===n){a.fields_config=a.fields_config?a.fields_config:{};for(var i in r.fields_config)a.fields_config[i]=r.fields_config[i]}else a[n]=r[n];return a};var CollectionConf={routeName:null,viewClass:null,actions:[],custom_actions:{},fields:[],fields_config:{},pagination:!0,detail_fields:{}},RecordConf={routeName:null,viewClass:null,actions:[],custom_actions:{},fields:[],fields_config:{},dependencies:{},fields_template:"left"},ConfList=Conf.extend(CollectionConf,{routeName:"list",viewClass:"ViewList",actions:["ActionDelete","ActionMultiDelete","ActionEdit","ActionView","ActionInsert"],detail_fields:{},fields_config:{id:{type:"hidden"},created_at:{type:"hidden"},updated_at:{type:"hidden"},deleted_at:{type:"hidden"},created_by:{type:"hidden"},updated_by:{type:"hidden"},descrizione:{type:"hidden"},activated:{type:"swap",mode:"edit"},verified:{type:"swap",mode:"edit"},fotos:{type:"hasmany_upload_image",limit:1},attachments:{type:"hasmany_upload_attachment",limit:1},data:{type:"date_picker"}}});ConfList.extend=function(e){return Conf.extend(ConfList,e)};var ConfEdit=Conf.extend(RecordConf,{routeName:"edit",viewClass:"ViewEdit",actions:["ActionSave","ActionBack"],custom_actions:{},fields:[],fields_config:{id:{type:"hidden"},created_at:{type:"hidden"},updated_at:{type:"hidden"},deleted_at:{type:"hidden"},created_by:{type:"hidden"},updated_by:{type:"hidden"},activated:{type:"radio"},descrizione:{type:"texthtml"},body:{type:"texthtml"},note:{type:"texthtml"},fotos:{type:"hasmany_upload_image",templateName:"no"},attachments:{type:"hasmany_upload_attachment",templateName:"no"},data:{type:"date_picker"},status:{type:"hidden"},token:{type:"hidden"},captcha:{type:"captcha"}},dependencies:{}});ConfEdit.extend=function(e){return Conf.extend(ConfEdit,e)};var ConfInsert=Conf.extend(ConfEdit,{routeName:"insert",viewClass:"ViewInsert"});ConfInsert.extend=function(e){return Conf.extend(ConfInsert,e)};var ConfSearch=Conf.extend(RecordConf,{routeName:"search",viewClass:"ViewSearch",actions:["ActionSearch","ActionReset"]});ConfSearch.extend=function(e){return Conf.extend(ConfSearch,e)};var ConfView=Conf.extend(RecordConf,{routeName:"view",viewClass:"ViewView",fields_config:{attivo:{type:"swap"},fotos:{type:"hasmany_upload_image"},attachments:{type:"hasmany_upload_attachment"},id:{type:"hidden"},created_at:{type:"hidden"},updated_at:{type:"hidden"},deleted_at:{type:"hidden"},created_by:{type:"hidden"},updated_by:{type:"hidden"}}});ConfView.extend=function(e){return Conf.extend(ConfView,e)};var ConfCalendar=Conf.extend(CollectionConf,{routeName:"calendar",viewClass:"ViewCalendar",data_inizio:"data",data_fine:null,title:null,calendar_options:{}});ConfCalendar.extend=function(e){return Conf.extend(ConfCalendar,e)};var Action=Component.extend({className:"Action",htmlEvent:"click",type:null,controlType:"button",text:"",icon:"",cssClass:"",target:"",href:"",params:[],enabled:!0,visible:!0,title:"",app:null,width:0,extraAttributes:{},_htmlProperties:["text","icon","cssClass","target","href","params","title","enabled","visible","onclick","onchange"],execute:function(){throw"func must be overloaded!"},_prepareContainer:function(e){var t=this;return Utility.hasAttr(t.jQe(),"crud-inline")?(t.jQe().attr("crud-render_action",""),e()):void t._super(e)},render:function(e){var t=this,a=t._getData();jQuery.renderTemplate(t.jQe(),t.jQe(),a),a.enabled||t.jQe("[crud-render_action]").prop("disabled","disabled"),e()},finalize:function(e){var t=this;0==t.jQe("[crud-render_action]").length&&t.app.log.warn("crud-render_action not found!",t.jQe().html()),t.jQe("[crud-render_action]").attr("crud-render_action",t.actionName);for(var a in t.extraAttributes)t.jQe("[crud-render_action]").attr(a,t.extraAttributes[a]);"button"==t.controlType&&t.jQe("[crud-render_action]")[t.htmlEvent](function(e){e.preventDefault(),t.execute()}),e()},_getData:function(){var e=this,t={};for(var a in e._htmlProperties){var r=e._htmlProperties[a];if(_.isFunction(e[r]))t[r]=e[r]();else{var n=e[r];["text","title"].indexOf(r)>=0&&(n=e.app.translate(n)),t[r]=n}}return"link"==e.controlType&&(t[e.htmlEvent]=null,t.href=e.execute()),t},callback:function(e){},template:function(){return this[this.controlType+"Template"]()},buttonTemplate:function(){return""},linkTemplate:function(){return""}});Action.clone=function(e){var t=new Action;for(var a in e)t[a]=e[a];return t};var CollectionAction=Action.extend({className:"CollectionAction",type:"collection",buttonTemplate:function(){return'<button crud-render_action type="button" crud-visible=visible crud-attrs="{\'title\':title,\'crud-params\':params,\'target\':target}" crud-class="cssClass" crud-addclass="enabled?\'\':\'disabled\'">                    <i crud-remove="!icon" crud-class="icon"></i>                    <span crud-field="text"></span>                </button>'},linkTemplate:function(){return'<a crud-href="href" crud-visible="visible" crud-class="cssClass"  crud-attrs="{\'title\':title,\'crud-params\':params,\'target\':target}" target="_blank" crud-addclass="enabled?\'\':\'disabled\'">                    <i crud-remove="!icon" crud-class="icon"></i>                    <span crud-field="text"></span>                </a>'}}),RecordAction=Action.extend({className:"RecordAction",type:"record",cssClass:"btn btn-default btn-xs btn-group",buttonTemplate:function(){return'<button crud-render_action type="button" crud-visible=visible crud-class="cssClass"  crud-attrs="{\'title\':title,\'crud-params\':params,\'target\':target}" crud-addclass="enabled?\'\':\'disabled\'">                    <i crud-remove="!icon" crud-class="icon"></i>                    <span crud-field="text"></span>                </button>'},linkTemplate:function(){return'<a crud-href="href" crud-visible="visible" crud-class="cssClass"  crud-attrs="{\'title\':title,\'crud-params\':params,\'target\':target}" target="_blank" crud-addclass="enabled?\'\':\'disabled\'">                    <i crud-remove="!icon" crud-class="icon"></i>                    <span crud-field="text"></span>                </a>'}}),ActionEdit=RecordAction.extend({className:"ActionEdit",title:"Modifica",icon:"fa fa-edit",multiText:"Modifica",routeName:"page_edit",execute:function(){var e=this,t=e.routeName;e.view.constraintKey&&e.view.constraintValue&&(t+="_constraint");var a=Route.factory(t,{});a.setValues(e.view),a.values.pk=e.modelData.id,document.location.href=a.getUrl()}}),ActionInsert=CollectionAction.extend({className:"ActionInsert",title:"Inserisci",icon:"fa fa-plus text-success",cssClass:"btn btn-default btn-xs text-success",text:"Nuovo",multiText:"Nuovo",routeName:"page_insert",execute:function(){var e=this;if(null!==e.routeName){var t=e.routeName;e.view.constraintKey&&e.view.constraintValue&&(t+="_constraint");var a=Route.factory(t,{});a.setValues(e.view),document.location.href=a.getUrl()}}}),ActionSave=RecordAction.extend({className:"ActionSave",title:"Salva",text:"Salva",multiText:"Salva",execute:function(){var e=this;if(null!==e.routeName){if(!e.view.valid())return void e.app.log.debug("actionSave form Data view is not valid!");var t=null,a=null;a=e.view.pk?"update":"save",e.view.constraintKey&&e.view.constraintValue&&(a+="_constraint"),t=Route.factory(a),t.setValues(e.view),t.params=e.view.getFormData(),e.app.waitStart(),Server.route(t,function(t){e.app.waitEnd(),e.callback(t)})}},callback:function(e){return e.error?void app.errorDialog(e.msg):void app.renderView(this.view.keyId)}}),ActionBack=RecordAction.extend({className:"ActionBack",title:"Indietro",text:"Torna indietro",execute:function(){window.history.back()}}),ActionView=RecordAction.extend({className:"ActionView",title:"Visualizza",icon:"fa fa-list-alt",multiText:"Visualizza",routeName:"page_view",execute:function(){var e=this,t=e.routeName;e.view.constraintKey&&e.view.constraintValue&&(t+="_constraint");var a=Route.factory(t,{});a.setValues(e.view),a.values.pk=e.modelData.id,document.location.href=a.getUrl()}}),ActionDelete=RecordAction.extend({className:"ActionDelete",title:"Cancella",icon:"fa fa-remove text-danger",multiText:"Cancella",execute:function(){var e=this;e.view;e.app.confirmDialog(app.translate("app.conferma-delete"),{ok:function(){var t=Route.factory("delete");t.setValues(e.view),t.values={modelName:e.view.modelName,pk:e.modelData.id},e.app.waitStart(),Server.route(t,function(t){e.app.waitEnd(),e.callback(t)})}})},callback:function(e){return e.error?void app.errorDialog(e.msg):void app.renderView(this.view.keyId)}}),ActionMultiDelete=CollectionAction.extend({className:"ActionMultiDelete",title:"Cancella selezionati",icon:"fa fa-trash text-danger",cssClass:"btn btn-default btn-xs text-danger",text:"Selezionati",needSelection:!0,multiText:"Cancella Selezionati",execute:function(){var e=this,t=e.view.getChecked(),a=t.length;0!==a&&app.confirmDialog(app.translate("app.conferma-multidelete",!1,[a]),{ok:function(){var a=Route.factory("multi_delete");a.values={modelName:e.view.modelName},e.app.waitStart(),a.params={ids:t},Server.route(a,function(t){e.app.waitEnd(),e.callback(t)})}})},callback:function(e){return e.error?void app.errorDialog(e.msg):void app.renderView(this.view.keyId)}}),ActionSearch=CollectionAction.extend({className:"ActionSearch",title:"app.search",icon:"fa fa-search",cssClass:"btn btn-xs btn-default text-info",text:"app.search",execute:function(){var e=this,t=e.view,a=t.getParams();a.page=1,window.location.href=window.location.origin+Server.getUrl(window.location.pathname+"?"+jQuery.param(a))}}),ActionReset=CollectionAction.extend({className:"ActionReset",title:"Annulla filtri ricerca",cssClass:"btn btn-xs btn-default",text:"Annulla filtri",execute:function(){this.view.resetForm(),this.callback()}}),ActionNextPage=CollectionAction.extend({className:"ActionNextPage",icon:"fa fa-angle-right",cssClass:"btn btn-default btn-xs",execute:function(){var e={current_page:1,last_page:1};e=jQuery.extend(e,this.view.data.pagination);var t=this.view.getRoute();e.current_page<e.last_page&&(t.params.page=e.current_page+1,this.view.setRoute(t),app.renderView(this.view.keyId),this.callback())}}),ActionPrevPage=CollectionAction.extend({className:"ActionPrevPage",icon:"fa fa-angle-left",cssClass:"btn btn-default btn-xs",execute:function(){var e={current_page:1};e=jQuery.extend(e,this.view.data.pagination);var t=this.view.getRoute();e.current_page>1&&(t.params.page=e.current_page-1,this.view.setRoute(t),app.renderView(this.view.keyId),this.callback())}}),ActionFirstPage=CollectionAction.extend({className:"ActionFirstPage",icon:"fa fa fa-angle-double-left",cssClass:"btn btn-default btn-xs",execute:function(){var e={current_page:1};e=jQuery.extend(e,this.view.data.pagination);var t=this.view.getRoute();e.current_page>1&&(t.params.page=1,this.view.setRoute(t),app.renderView(this.view.keyId),this.callback())}}),ActionLastPage=CollectionAction.extend({className:"ActionLastPage",icon:"fa fa fa-angle-double-right",cssClass:"btn btn-default btn-xs",execute:function(){var e={current_page:1,last_page:1};e=jQuery.extend(e,this.view.data.pagination);var t=this.view.getRoute();e.current_page<e.last_page&&(t.params.page=e.last_page,this.view.setRoute(t),app.renderView(this.view.keyId),this.callback())}}),ActionPerPage=CollectionAction.extend({className:"ActionPerPage",icon:"fa fa fa-angle-double-right",htmlEvent:"change",cssClass:"btn btn-default btn-xs",init:function(e){this._super(e),this._htmlProperties.push("pagination")},execute:function(){var e=this,t=this.view.getRoute();t.params.page=1,t.params.paginateNumber=jQuery(e.container).find("select").val(),this.view.setRoute(t),app.renderView(this.view.keyId),this.callback()},_getData:function(){var e=this._super(),t={pagination_steps:[]};return t=jQuery.extend(t,e.pagination),t.pagination_order=_.sortBy(_.keys(t.pagination_steps),function(e){return parseInt(e)}),e.pagination=t,e},template:function(){var e="\"{'title':title,'crud-params':params}\"";return'<select crud-render_action crud-field="pagination.per_page" crud-source="pagination.pagination_steps"                        crud-sourceorder="pagination.pagination_order"                        crud-attrs='+e+' class="pagination-input">                </select>'}});ActionOrder=CollectionAction.extend({orderDirection:null,orderField:null,href:"#",orderClass:{asc:["sorting_asc","fa","fa-angle-down"],desc:["sorting_desc","fa","fa-angle-up"]},render:function(e){var t=this;t.orderDirection&&(t.icon=t.orderClass[t.orderDirection.toLowerCase()]?t.orderClass[t.orderDirection.toLowerCase()].join(" "):""),t._super(function(){e()})},execute:function(){var e=this;e.orderDirection?e.orderDirection="ASC"==e.orderDirection?"DESC":"ASC":e.orderDirection="ASC";var t=e.view.getRoute();if(null==t){var a=1;"DESC"==e.orderDirection&&(a=-1),e.data.value=e.data.value.sort(function(e,t){return e[order_field]<t[order_field]?a:e[order_field]>t[order_field]?-a:0}),e.view.metadata.order_field=e.orderField,e.view.metadata.order_direction=e.orderDirection}else t.params.order_field=e.orderField,t.params.order_direction=e.orderDirection;e.app.renderView(e.view.keyId)},buttonTemplate:function(){}});var MultiAction=Component.extend({uid:"",multiAction:!0,actionSelected:null,container:null,htmlEvent:"onclick",type:null,controlType:"button",text:"",icon:"",cssClass:"",target:"",href:"",params:[],enabled:!0,visible:!0,title:"",app:null,actions:[],custom_actions:[],_actionsClass:[],_htmlProperties:["text","icon","cssClass","target","href","params","title","enabled","visible","onclick","onchange"],init:function(e){if(this._actionsClass=[],e)for(var t in e)this[t]=e[t];this.uid=Component.newID()},execute:function(){var e=this;e._actionsClass[e.actionSelected].execute()},render:function(e){var t=this,a=t._getData();t.jQe("[crud-actions_container]").html(Component.parseHtml(t.itemTemplate()).html()),jQuery.renderTemplate(t.container,t.container,a),e()},finalize:function(e){var t=this;jQuery.each(t.jQe("[crud-single_action]"),function(e){jQuery(this).attr("onclick","EventManager.trigger('"+t.uid+"',"+e+")")}),EventManager.on(t.uid,function(e){t.actionSelected=e.params,t.execute()}),e()},_getData:function(){var e=this,t={actions:[]};for(var a in e._htmlProperties){var r=e._htmlProperties[a];_.isFunction(e[r])?t[r]=e[r]():t[r]=e[r]}"link"==e.controlType&&(t[e.htmlEvent]=null,t.href=e.execute());for(var a in e.actions){var n=null;n=e.custom_actions[e.actions[a]]?new e.custom_actions[e.actions[a]]:new window[e.actions[a]],n.view=e.view,n.modelData=e.modelData,e._actionsClass.push(n),n.draw(),t.actions.push({text:e.app.translate(n.multiText?n.multiText:n.text)})}return t},callback:function(e){},template:function(){return this["_"+this.controlType+"Template"]()}}),MultiCollectionAction=MultiAction.extend({type:"collection",needSelection:!1,itemTemplate:function(){var e=this;return"link"==e.controlType?void 0:'<li>                    <a href="javascript:;" crud-single_action crud-field="text" crud-attrs="{\'crud-single_action\':counter}">Action</a>                </li>'},template:function(){},finalize:function(e){var t=this;t._super(function(){for(var a in t._actionsClass)if(t._actionsClass[a].needSelection){t.needSelection=!0;break}e()})}}),MultiRecordAction=MultiAction.extend({type:"record",cssClass:"btn btn-default btn-xs btn-group",itemTemplate:function(){var e=this;return"link"==e.controlType,void 0},template:function(){return'<div class="btn-group btn-group-xs">                      <button type="button" class="btn btn-default" crud-field="text">Action</button>                      <button type="button" class="btn btn-default dropdown-toggle" crud-toggle="dropdown" aria-haspopup="true" aria-expanded="false">                        <span class="caret"></span>                        <span class="sr-only">Toggle Dropdown</span>                      </button>                      <ul crud-actions_container class="dropdown-menu" crud-field="actions" crud-self>                        <!-- single action render --->                      </ul>                </div>'}});MultiAction.factory=function(e,t){var a="MultiAction"+Utility.pascalCase(e);if(!window[a])throw"Impossibile trovare la definizione dell'action  "+a;var r=t?t:{};return r.className=a,new window[a](r)};var MultiActionStandard=MultiRecordAction.extend({text:"Operazioni",actions:["ActionDelete","ActionEdit","ActionView"]}),ValidationRules=Class.extend({form:null,init:function(e){this.form=e},get:function(e){return log.warn("metodo da implementare"),{}}}),Vrequired=ValidationRules.extend({get:function(e,t){return{required:!0}}}),Vbetween=ValidationRules.extend({get:function(e,t){var a=t.split(":"),r=a[1].split(",");return{minlength:r[0],maxlength:r[1]}}}),Vemail=ValidationRules.extend({get:function(e,t){return{email:!0}}}),Vconfirmed=ValidationRules.extend({get:function(e,t){return{equalTo:'input[name="'+e+'_confirmation"]'}}}),Vsometimes=ValidationRules.extend({get:function(e,t){var a=this,r={key:e,other_rules:t,form:a.form};return{sometimes:r}}});jQuery.validator&&jQuery.validator.addMethod("sometimes",function(e,t,a){if(jQuery(t).rules("remove","sometimes"),!jQuery(t).val())return!0;for(var r in a.other_rules){var n=a.other_rules[r],i=n.split(":").length>0?n.split(":")[0]:n;if(i="V"+i,window[i]){var o=new window[i](a.form);jQuery(t).rules("add",o.get(a.key,n))}}var u=a.form.validate(),l=u.element(jQuery(t)),d=u.errorList.length?u.errorList[0].message:"undefined error";for(var o in jQuery(t).rules())jQuery(t).rules("remove",o);return jQuery(t).rules("add",{sometimes:a}),jQuery(t).rules("add",{messages:{sometimes:d}}),l},"mesaggio dinamico");var Dashboard=Component.extend({container:null,template:null,className:"Dashboard",modelName:"",viewKeys:[],labelContext:null,init:function(e){var t=this;t._super(e),t.labelsContext=t.modelName,Utility.hasAttr(jQuery(t.container),"crud-inline")&&(t.template=jQuery(t.container)[0].outerHTML)},setId:function(e){var t=this;t.keyId=e,t.jQe().attr("dkey",e)},finalize:function(e){var t=this;t.app.parse(t.jQe()),e()},_createBaseConf:function(e){var t=this,a=t.app.getConf(t.modelName,e);return a||(a=t.app.getDefaultConf(e)),a.modelName=t.modelName,a.constraintKey=t.constraintKey,a.constraintValue=t.constraintValue,a.container=t.jQe("[crud-view_"+e+"]"),a.autorender=!1,t.constraintKey&&t.constraintValue&&(a.routeName=a.routeName+"_constraint"),a}}),DashboardTab=Dashboard.extend({reloadList:!1,searchKey:null,listKey:null,editKey:null,insertKey:null,viewKey:null,finalize:function(e){var t=this;t.searchKey&&app.removeView(t.searchKey);var a=t._createBaseConf("search");t.searchKey=t.app.addView(a),t.editKey&&app.removeView(t.editKey),a=t._createBaseConf("edit"),t.editKey=t.app.addView(a),t.insertKey&&app.removeView(t.insertKey),a=t._createBaseConf("insert"),t.insertKey=t.app.addView(a),t.viewKey&&app.removeView(t.viewKey),a=t._createBaseConf("view"),t.viewKey=t.app.addView(a),t.listKey&&app.removeView(t.listKey),a=t._createBaseConf("list"),t.listKey=t.app.addView(a);var r=app.getView(t.listKey);r.custom_actions.ActionEdit=ActionEdit.extend({execute:function(){var e=this;t.showEdit(e.modelData.id)}}),r.actions.indexOf("ActionView")>=0&&(r.custom_actions.ActionView=ActionView.extend({execute:function(){var e=this;t.showDialog(e.modelData.id)}})),r.actions.indexOf("ActionInsert")>=0&&(r.custom_actions.ActionInsert=ActionInsert.extend({execute:function(){t.showInsert()}}));var n=ActionBack.extend({execute:function(){t.showList()}}),i=ActionSave.extend({execute:function(){var e=this;t.reloadList=!0,e._super()}});app.getView(t.editKey)&&(app.getView(t.editKey).dashboardInstance=t,app.getView(t.editKey).custom_actions.ActionBack=n,app.getView(t.editKey).custom_actions.ActionSave=i),app.getView(t.insertKey)&&(app.getView(t.insertKey).dashboardInstance=t,app.getView(t.insertKey).custom_actions.ActionBack=n,app.getView(t.insertKey).custom_actions.ActionSave=i),app.getView(t.searchKey)&&(app.getView(t.searchKey).dashboardInstance=t,app.getView(t.searchKey).custom_actions.ActionSearch=ActionSearch.extend({execute:function(){var e=this,t=app.getView(e.view.dashboardInstance.listKey),a=app.getView(e.view.dashboardInstance.searchKey),r=t.getRoute(),n=a.getFormData();r.params=jQuery.extend(n,r.extraParams),t.setRoute(r),app.renderView(e.view.dashboardInstance.listKey)}})),t.app.renderView(t.searchKey,function(){t.app.renderView(t.listKey,function(){return e()})})},showEdit:function(e){var t=this;t.jQe("[crud-collapse_list]").collapse("hide"),t.jQe("[crud-collapse_edit]").collapse("show"),t.jQe("[crud-view_insert]").addClass("hide"),t.jQe("[crud-view_edit]").removeClass("hide"),t.jQe("[crud-edit_title]").html("modifica "+t.app.translate("model."+t.modelName));var a=app.getView(t.editKey);a.pk=e,app.renderView(a.keyId)},showDialog:function(e){var t=this;jQuery(t.container).find("[crud-view_dialog]").modal("show");var a=app.getView(t.viewKey);a.pk=e,app.renderView(a.keyId)},showList:function(){var e=this;jQuery(e.container).find("[crud-collapse_list]").collapse("show"),jQuery(e.container).find("[crud-collapse_edit]").collapse("hide"),e.reloadList&&(e.reloadList=!1,app.renderView(e.listKey))},showInsert:function(){var e=this;jQuery(e.container).find("[crud-collapse_list]").collapse("hide"),jQuery(e.container).find("[crud-collapse_edit]").collapse("show"),jQuery(e.container).find("[crud-view_insert]").removeClass("hide"),jQuery(e.container).find("[crud-view_edit]").addClass("hide"),jQuery("[crud-edit_title]").html("inserimento "+e.app.translate("model."+e.model));var t=app.getView(e.insertKey);app.renderView(t.keyId)},template:function(){return'<div class="tab-content">                    <header>                        <div class="panel panel-default">                            <div class="panel-heading">                                  <span class="title elipsis">                                        <strong crud-label="modelMetadata.singular"></strong>                                  </span>                            </div>                        </div>                    </header>                    <div class="collapse in" crud-collapse_list>                        <div class="padding-15">                            <div crud-view_search>                            </div>                            <div crud-view_list>                            </div>                        </div>                    </div>                                    <div class="collapse" crud-collapse_edit>                        <div class="padding-15">                            <div crud-view_edit></div>                            <div crud-view_insert></div>                        </div>                    </div>                                    <div crud-view_dialog class="modal fade">                        <div class="modal-dialog">                            <div class="modal-content">                                <div class="modal-header">                                    <button type="button" class="close" data-dismiss="modal"                                            aria-hidden="true">&times;</button>                                    <h4 class="modal-title" crud-label="modelMetadata.singular" ></h4>                                </div>                                 <div class="modal-body">                                    <div crud-view_view></div>                                </div>                                <div class="modal-footer">                                    <button crud-button="cancel" type="button" class="btn btn-primary "                                          data-dismiss="modal">Annulla                                    </button>                                    <button crud-button="ok" type="button" class="btn btn-primary"                                            data-dismiss="modal">Ok                                    </button>                                </div>                            </div>                            <!-- /.modal-content -->                        </div>                        <!-- /.modal-dialog -->                    </div>                </div>';
}}),DashboardEdit=Dashboard.extend({className:"DashboardEdit",editKey:null,finalize:function(e){var t=this,a=t._createBaseConf("edit");a.pk=t.pk,t.editKey=t.app.addView(a),t.app.renderView(t.editKey,function(){e()})},template:function(){return'<div>                    <div class="panel panel-default">                        <div class="panel-heading">                              <span class="title elipsis">                                 <strong crud-label="modelMetadata.singular"></strong>                              </span>                        </div>                    </div>                    <div crud-view_edit >                                                    </div>                </div>'}}),DashboardList=Dashboard.extend({searchKey:null,listKey:null,finalize:function(e){var t=this,a=t._createBaseConf("list");t.listKey=t.app.addView(a);var r=t.jQe("[crud-view_search]").length>0;if(r){var n=t._createBaseConf("search");t.searchKey=t.app.addView(n),t.app.getView(t.searchKey).custom_actions.ActionSearch=ActionSearch.extend({execute:function(){var e=app.getView(t.listKey),a=app.getView(t.searchKey),r=e.getRoute();r.params=a.getFormData(),e.setRoute(r),app.renderView(t.listKey)}}),t.app.renderView(t.searchKey,function(){t.app.renderView(t.listKey,function(){return e()})})}else t.app.renderView(t.listKey,function(){return e()})},template:function(){return'<div id="tabContent">                    <div class="collapse in" crud-collapse_list>                        <header id="page-header">                            <div class="panel panel-default">                                <div class="panel-heading">                                      <span class="title elipsis">                                         <strong crud-label="modelMetadata.singular"></strong>                                      </span>                                </div>                            </div>                        </header>                                        <div class="padding-15">                            <div crud-view_search></div>                            <div crud-view_list></div>                        </div>                    </div>                </div>'}}),DashboardInsert=Dashboard.extend({insertKey:null,finalize:function(e){var t=this,a=t._createBaseConf("insert");t.insertKey=t.app.addView(a),t.app.renderView(t.insertKey,function(){e()})},template:function(){return'<div>                    <div class="panel panel-default">                        <div class="panel-heading">                              <span class="title elipsis">                                 <strong crud-label="modelMetadata.singular"></strong>                              </span>                        </div>                    </div>                    <div crud-view_insert>                    </div>                </div>'}}),DashboardSearch=Dashboard.extend({template:function(){return'<div crud-view_search class="viewSearch"></div>'}}),DashboardView=Dashboard.extend({className:"DashboardView",viewKey:null,finalize:function(e){var t=this,a=t._createBaseConf("view");a.pk=t.pk,t.viewKey=t.app.addView(a),t.app.renderView(t.viewKey,function(){e()})},template:function(){return'<div>                    <div class="panel panel-default">                        <div class="panel-heading">                              <span class="title elipsis">                                 <strong crud-label="modelMetadata.singular"></strong>                              </span>                        </div>                    </div>                    <div crud-view_view >                                                    </div>                </div>'}}),Dashboard2Columns=Dashboard.extend({reloadList:!1,searchKey:null,listKey:null,editKey:null,insertKey:null,viewKey:null,finalize:function(e){var t=this,a=t._createBaseConf("search");t.searchKey=t.app.addView(a),a=t._createBaseConf("edit"),t.editKey=t.app.addView(a),a=t._createBaseConf("insert"),t.insertKey=t.app.addView(a),a=t._createBaseConf("view"),t.viewKey=t.app.addView(a),a=t._createBaseConf("list"),t.listKey=t.app.addView(a);var r=app.getView(t.listKey);r.dashboardInstance=t,r.actions.indexOf("ActionEdit")>=0&&(r.custom_actions.ActionEdit?r.custom_actions.ActionEdit=r.custom_actions.ActionEdit.extend({execute:function(){this._super()}}):r.custom_actions.ActionEdit=ActionEdit.extend({execute:function(){var e=this;e.view.dashboardInstance.showEdit(e.modelData.id)}})),r.actions.indexOf("ActionView")>=0&&(r.custom_actions.ActionView?r.custom_actions.ActionView=r.custom_actions.ActionView.extend({execute:function(){this._super()}}):r.custom_actions.ActionView=ActionView.extend({execute:function(){var e=this;e.view.dashboardInstance.showVista(e.modelData.id)}})),r.actions.indexOf("ActionInsert")>=0&&(r.custom_actions.ActionInsert?r.custom_actions.ActionInsert=r.custom_actions.ActionInsert.extend({execute:function(){this._super()}}):r.custom_actions.ActionInsert=ActionInsert.extend({execute:function(){var e=this;e.view.dashboardInstance.showInsert()}}));var n=ActionSave.extend({execute:function(){var e=this;e.view.dashboardInstance.reloadList=!0,this._super()},callback:function(){var e=this;e.view.dashboardInstance.showList()}});return app.getView(t.editKey)&&(app.getView(t.editKey).dashboardInstance=t,app.getView(t.editKey).custom_actions.ActionSave=n,app.getView(t.insertKey).actions=_.without(app.getView(t.insertKey).actions,"actionBack")),app.getView(t.insertKey)&&(app.getView(t.insertKey).dashboardInstance=t,app.getView(t.insertKey).custom_actions.ActionSave=n,app.getView(t.insertKey).actions=_.without(app.getView(t.insertKey).actions,"actionBack")),app.getView(t.searchKey)&&(app.getView(t.searchKey).dashboardInstance=t,app.getView(t.searchKey).custom_actions.ActionSearch=ActionSearch.extend({execute:function(){var e=this,t=app.getView(e.view.dashboardInstance.listKey),a=app.getView(e.view.dashboardInstance.searchKey),r=t.getRoute(),n=a.getFormData();r.params=jQuery.extend(n,r.extraParams),t.setRoute(r),app.renderView(e.view.dashboardInstance.listKey)}})),t.app.renderView(t.searchKey,function(){t.app.renderView(t.listKey,function(){return t.showInsert(),e()})}),e()},showVista:function(e){var t=this;jQuery(t.container).find('[crud-view_container="view"]').removeClass("hide"),jQuery(t.container).find('[crud-view_container="edit"]').addClass("hide"),jQuery(t.container).find('[crud-view_container="insert"]').addClass("hide"),jQuery("[crud-view_title]").html("Vista "+t.app.translate("model."+t.modelName));var a=app.getView(t.viewKey);a.pk=e,app.renderView(a.keyId)},showList:function(){var e=this;e.reloadList&&(e.reloadList=!1,app.renderView(e.listKey))},showInsert:function(){var e=this;jQuery(e.container).find('[crud-view_container="insert"]').removeClass("hide"),jQuery(e.container).find('[crud-view_container="edit"]').addClass("hide"),jQuery(e.container).find('[crud-view_container="view"]').addClass("hide"),jQuery("[crud-insert_title]").html("inserimento "+e.app.translate("model."+e.modelName));var t=app.getView(e.insertKey);app.renderView(t.keyId)},showEdit:function(e){var t=this;jQuery(t.container).find('[crud-view_container="edit"]').removeClass("hide"),jQuery(t.container).find('[crud-view_container="insert"]').addClass("hide"),jQuery(t.container).find('[crud-view_container="view"]').addClass("hide"),jQuery("[crud-edit_title]").html("modifica "+t.app.translate("model."+t.modelName));var a=app.getView(t.editKey);a.pk=e,app.renderView(a.keyId)},template:function(){return'<div class="tab-content">                    <header >                        <div class="panel panel-default">                            <div class="panel-heading">                                  <span class="title elipsis">                                        <strong crud-label="modelMetada.singular"></strong>                                  </span>                            </div>                        </div>                    </header>                    <div>                        <div class="col col-xs-6">                            <div crud-view_search ></div>                            <div crud-view_list></div>                        </div>                        <div class="col col-xs-6">                            <div crud-view_container="edit">                                <h4 crud-edit_title></h4>                                <div crud-view_edit>                                                                           </div>                            </div>                            <div crud-view_container="insert">                                <h4 crud-insert_title></h4>                                <div crud-view_insert ></div>                            </div>                            <div crud-view_container="view">                                <h4 crud-view_title></h4>                                <div crud-view_view></div>                            </div>                        </div>                    </div>                </div>'}});